function WacCurve(n,t,i,r,u,f){this.ID=n;this.type=t;this.x1=i;this.y1=r;this.x2=u;this.y2=f}function WacIntWrapper(n,t){this.value=n;this.contextId=t}function WacKeyFrame(n,t,i,r,u,f,e,o){this.type=n;this.curveID=t;this.startTime=i==null||i.value==undefined?new WacIntWrapper(i,null):i;this.endTime=r==null||r.value==undefined?new WacIntWrapper(r,null):r;this.startValue=u==null||u.value==undefined?new WacIntWrapper(u,null):u;this.endValue=f==null||f.value==undefined?new WacIntWrapper(f,null):f;this.relativeTo=e;this.operationType=o}function WacAnimation_ContextVariableManager(){}function WacAnim(n,t){this.ID=n;this.keyFrames=t}function WacAnimationEngine(){this.AnimationQueue=new Array(0);this.sharedTimer=null;this.sharedCancelTimer=null;this.resetInterval=5e3;this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.currentAnimationIndex=-1;this.temporaryIDGenerator=0}function WacAnimation_State(){this.Index=0;this.Data=new Array(0);this.AnimateRight=!1}function WacAnimation_Object(n,t,i,r,u,f){this.Initialize(n,t,i,r,u,f)}function WacAnimationUnit(n,t,i,r,u,f){this.Initialize(n,t,i,r,u,f)}function WacAnimationTelemetry(){this.perfData=new Array(0);this.logData=new Array(0);this.animationStats=[];this.animationStatsIndex=0;this.perfDataIndex=0;this.logDataIndex=0;this.animationIndex=0;this.startTime=null;this.duration=null;this.numUnits=0;this.elementIds={};this.avgSessionFps=-1;this.countSessionFps=0;this.minSessionFps=-1;this.maxSessionFps=-1}function GetCurrentAttributeCssValue(n,t,i,r){IsNullOrUndef(r)&&(r=n.style.position=="relative");var u=0;switch(t){case 1:u=i?parseInt(r?n.style.marginRight.replace("px",""):n.style.right.replace("px","")):parseInt(r?n.style.marginLeft.replace("px",""):n.style.left.replace("px",""));break;case 2:u=parseInt(r?n.style.marginTop.replace("px",""):n.style.top.replace("px",""));break;case 3:u=parseInt(n.style.height.replace("px",""));break;case 4:u=parseInt(n.style.width.replace("px",""));break;case 5:u=GetCssOpacity(n);break;case 6:u=parseInt(n.scrollTop);break;case 7:u=parseInt(n.scrollLeft);break;case 8:u=GetCssRotation(n)}return u}function Bezier1(n){return n*n*n}function Bezier2(n){return 3*n*n*(1-n)}function Bezier3(n){return 3*n*(1-n)*(1-n)}function Bezier4(n){return(1-n)*(1-n)*(1-n)}function CalculateBezier(n,t,i,r,u){return 0*Bezier4(u)+t*Bezier3(u)+r*Bezier2(u)+1*Bezier1(u)}function IsArrayCheck(n){return typeof n=="object"&&n instanceof Array}function IsNullOrUndef(n){return n==null||n==undefined}function SetCssOpacity(n,t){document.body.style.opacity!=null?n.style.opacity=t:n.style.filter=t==1?"":"alpha(opacity="+String(t*100)+")"}function GetCssOpacity(n){var t,i;return document.body.style.opacity!=null?(t=n.style.opacity,t!=null&&t!=""?parseFloat(t):1):(i=n.style.filter,i!=null&&i!=""?parseInt(i.replace("alpha(opacity=","").replace(")",""))/100:1)}function SetCssRotation(n,t){var i="rotate("+t+"deg)";document.body.style.msTransform!=null?n.style.msTransform=i:document.body.style.webkitTransform!=null?n.style.webkitTransform=i:document.body.style.mozTransform!=null?n.style.mozTransform=i:document.body.style.oTransform!=null?n.style.oTransform=i:document.body.style.transform!=null&&(n.style.transform=i)}function GetCssRotation(n){var t;return(document.body.style.msTransform!=null?t=n.style.msTransform:document.body.style.webkitTransform!=null?t=n.style.webkitTransform:document.body.style.mozTransform!=null?t=n.style.mozTransform:document.body.style.oTransform!=null?t=n.style.oTransform:document.body.style.transform!=null&&(t=n.style.transform),!t)?0:(t=t.replace("rotate(",""),t=t.replace("deg)",""),parseFloat(t))}Type.registerNamespace("_Ewa");_Ewa.bbT=function(){};_Ewa.DS=function(){};_Ewa.bbU=function(){};_Ewa.bbV=function(){};_Ewa.bbU.registerClass("_Ewa.bbU");_Ewa.bbV.registerClass("_Ewa.bbV");Type.registerNamespace("Common.App.AccessibilitySettings");Common.App.AccessibilitySettings.c=function(){};Common.App.AccessibilitySettings.c.registerInterface("Common.App.AccessibilitySettings.c");Common.App.AccessibilitySettings.f=function(){};Common.App.AccessibilitySettings.f.registerInterface("Common.App.AccessibilitySettings.f");Common.App.AccessibilitySettings.a=function(){};Common.App.AccessibilitySettings.a.c=function(){Common.App.a.a().a(new Common.App.AccessibilitySettings.a,0,!1)};Common.App.AccessibilitySettings.a.b=function(){return Common.App.AccessibilitySettings.a.a||(Common.App.AccessibilitySettings.a.a=Common.a.a?Common.a.a.a("AccessibilitySettingsDialogIsEnabled")&&Common.a.a.d("Microsoft.Office.SharedOnline.AccessibilitySettingsDialogIsEnabled",!1):!1),Common.App.AccessibilitySettings.a.a};Common.App.AccessibilitySettings.a.prototype={d:null,a:function(){return"Common.App.AccessibilitySettings"},c:function(n){var t,i;this.d=n;Common.App.AccessibilitySettings.a.b()&&(t=this,this.d.c(Common.App.AccessibilitySettings.d,null).c(Common.App.AccessibilitySettings.f,null).b(function(){return new Common.App.AccessibilitySettings.d(Common.a.c(),t.d.a(Common.App.AccessibilitySettings.c,null))}).a(),i=this,this.d.c(Common.App.AccessibilitySettings.e,null).c(Common.App.AccessibilitySettings.c,null).b(function(){return new Common.App.AccessibilitySettings.e}).a())},b:function(){Common.App.AccessibilitySettings.a.b()&&(this.d.a(Common.App.AccessibilitySettings.f,null).a(),this.d.a(Common.App.AccessibilitySettings.c,null).b())}};Common.App.AccessibilitySettings.e=function(){};Common.App.AccessibilitySettings.e.prototype={d:null,a:function(){return!!this.d},c:function(n){return n===this.d?n:(this.d=n,Common.F.b("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(n),this.e()&&Common.App.AccessibilitySettings.b.c("saveHoverableRibbonTooltipIsEnabled",n),n)},b:function(){var t=new($$sc.D.$$(Boolean)),n,i;return this.d?t.b(this.d):this.e()?(n=Common.App.AccessibilitySettings.b.b("getHoverableRibbonTooltipIsEnabled"),i=this,n.CWo(function(){i.d=n.a();Common.F.b("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(n.a());t.b(n.a())},8)):t.b(!1),t.a},e:function(){var n=Common.a.a.a("IsRoamingServiceEnabled"),t=Common.a.a.a("IsAnonymousUser");return n&&!t}};Common.App.AccessibilitySettings.g=function(n){this.b=Function.createDelegate(this,this.c);Common.App.AccessibilitySettings.g.initializeBase(this,[!1,!1,!0,!1]);this.a=n};Common.App.AccessibilitySettings.g.prototype={a:null,d:function(){var n={id:"AccessibilitySettingsDialog",bodyControls:{tooltipPersistenceEnabled:this.a.a()}};this.A("",this.b,n)},c:function(n,t){n===1&&this.a.c(t.tooltipPersistenceEnabled)}};Common.App.AccessibilitySettings.d=function(n,t){this.d=Function.createDelegate(this,this.e);this.c=n;this.b=t};Common.App.AccessibilitySettings.d.prototype={c:null,b:null,a:function(){this.c.a(2236763780,2147483648,this.d)},e:function(){return new Common.App.AccessibilitySettings.g(this.b).d(),32}};Common.App.AccessibilitySettings.b=function(){};Common.App.AccessibilitySettings.b.b=function(n){var t=new($$sc.D.$$(Boolean));return Common.a.e.a(Common.App.AccessibilitySettings.b.a(n),1,null,null,!0,2,function(n){n.b.a===200?t.b(n.b.b.toLowerCase()==="true"):t.b(!1)},function(){t.b(!1)},null,null,!1,null,null,"7",null,!1,null,!1,null),t.a};Common.App.AccessibilitySettings.b.c=function(n,t){Common.a.e.a(Common.App.AccessibilitySettings.b.a(n),2,t.toString().toLowerCase(),null,!0,2,null,null,null,null,!1,null,null,"8",null,!1,null,!1,null)};Common.App.AccessibilitySettings.b.a=function(n){var t=Common.a.a.l.d.RoamingServiceHandlerWebServiceBase||"";return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",t,n,Common.a.i)};Common.App.AccessibilitySettings.e.registerClass("Common.App.AccessibilitySettings.e",null,Common.App.AccessibilitySettings.c);Common.App.AccessibilitySettings.g.registerClass("Common.App.AccessibilitySettings.g",CommonUI.b);Common.App.AccessibilitySettings.d.registerClass("Common.App.AccessibilitySettings.d",null,Common.App.AccessibilitySettings.f);Common.App.AccessibilitySettings.a.a=null;Common.App.AccessibilitySettings.a.c();Type.registerNamespace("Common.App.AltTextDialog");Common.App.AltTextDialog.c=function(n){Common.App.AltTextDialog.c.initializeBase(this);this.F=Common.App.AltTextDialog.c.a;this.h(n)};Common.App.AltTextDialog.a=function(){this.d=Function.createDelegate(this,this.e);Common.App.AltTextDialog.a.initializeBase(this,[!1,!1,!1,!1]);this.L=Common.App.AltTextDialog.b.b();this.F="BaseAltTextDialogWithDescription"};Common.App.AltTextDialog.a.prototype={h:function(n){var t={},i;t[Common.App.AltTextDialog.a.a]=this.f(n);t[Common.App.AltTextDialog.a.b]=this.g(n)||"";this.A($a.dU,this.d,t);i=document.getElementById(Common.App.AltTextDialog.a.a);i.focus();i.select()},cj:function(n){return n.c.id===Common.App.AltTextDialog.a.b?!1:CommonUI.c.prototype.cj.call(this,n)}};Common.App.AltTextDialog.b=function(){};Common.App.AltTextDialog.b.b=function(){return CommonUI.b.a(Common.App.AltTextDialog.b.a,$a.dV,$a.dT)};Common.App.AltTextDialog.a.registerClass("Common.App.AltTextDialog.a",CommonUI.b);Common.App.AltTextDialog.c.registerClass("Common.App.AltTextDialog.c",Common.App.AltTextDialog.a);Common.App.AltTextDialog.c.a="AAltTextDialogWithDescription";Common.App.AltTextDialog.a.a="titleText";Common.App.AltTextDialog.a.b="descriptionText";Common.App.AltTextDialog.b.a="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}<\/label> <\/div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> <\/div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}<\/label> <\/div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"><\/textarea> <\/div>";Type.registerNamespace("Common.App.NewAndOpen.Core");Common.App.NewAndOpen.Core.n=function(){};Common.App.NewAndOpen.Core.n.prototype={a:function(){return this.f},g:function(n){return Diag.a.a(5849616,202,50,"Changing event result state. {0}",{OldState:Common.ef.toString(this.f),NewState:Common.ef.toString(n)},"ResultType",this.j()),this.f=n,n},f:0};Common.App.NewAndOpen.Core.h=function(){};Common.App.NewAndOpen.Core.g=function(n,t){this.e=n;this.d=Common.App.NewAndOpen.Core.h.a++;this.f=t};Common.App.NewAndOpen.Core.g.$$=function(n){var u=Common.App.NewAndOpen.Core.__tc=Common.App.NewAndOpen.Core.__tc||{},t="g$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.NewAndOpen.Core.g.apply(this,t)};i.registerClass("Common.App.NewAndOpen.Core.__tc."+t,null,Common.kn.$$(n));o={"Common.App.NewAndOpen.Core.g":{T:n},ctor:Common.App.NewAndOpen.Core.g};i.prototype.$$gta=o;f=Common.App.NewAndOpen.Core.g.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.NewAndOpen.Core.g.prototype={e:null,f:null,d:0,c:function(){return this.d},b:function(n,t){this.f(n,t)},a:function(n,t){return this.e.a(n,t?this:null)}};Common.App.NewAndOpen.Core.f=function(){this.i={}};Common.App.NewAndOpen.Core.f.$$=function(n){var u=Common.App.NewAndOpen.Core.__tc=Common.App.NewAndOpen.Core.__tc||{},t="f$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.NewAndOpen.Core.f.apply(this,t)};i.registerClass("Common.App.NewAndOpen.Core.__tc."+t,null,Common.km.$$(n));o={"Common.App.NewAndOpen.Core.f":{T:n},ctor:Common.App.NewAndOpen.Core.f};i.prototype.$$gta=o;f=Common.App.NewAndOpen.Core.f.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.NewAndOpen.Core.f.prototype={K:function(n){this.i[n.c().toString()]=n},L:function(n){var i=this.i,t,r,u;for(t in i)r={key:t,value:i[t]},u=r.value,u.b(n,!1);this.i={}},a:function(n,t){return t&&this.K(t),this.M(n,t)},n:function(n){this.L(n)},v:function(n,t){n.b(t,!0)}};Common.App.NewAndOpen.Core.j=function(){this.i=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.j)};Common.App.NewAndOpen.Core.j.prototype={e:null,a:function(){return"Common.App.NewAndOpen.Core"},c:function(n){var t,i,r;this.e=n;t=this;n.c(Common.cu,null).a().b(function(){return Common.App.NewAndOpen.Core.c.a()});i=this;n.c(Common.km.$$(Common.by),null).a().b(function(){return Common.App.NewAndOpen.Core.b.b()});r=this;n.c(Common.km.$$(Common.bI),null).a().b(function(){return Common.App.NewAndOpen.Core.a.a()})},b:function(){var n=this;Common.a.a.k(function(){n.n()})},n:function(){var n,t;this.e.a(Common.cu,null);this.e.a(Common.km.$$(Common.by),null);this.e.a(Common.km.$$(Common.bI),null);n=!1;Common.App.NewAndOpen.Core.c.a().y();Common.a.bA&&(n=!0);Common.a.cx&&(Common.App.NewAndOpen.Core.a.a().Y(),Common.a.cu>0&&this.j(),this.o(),n=!0);Common.a.cA&&n&&Common.App.NewAndOpen.Core.b.b().l();Common.a.dB&&(t=Common.App.NewAndOpen.Core.a.a(),t.bb(),t.Z(),Common.S.a().a(this.m()))},o:function(){Common.App.NewAndOpen.Core.d.b().l(Common.App.NewAndOpen.Core.a.a().B);Common.App.NewAndOpen.Core.d.b().l(this.h);Common.App.NewAndOpen.Core.d.b().n(this.i)},l:function(){Common.S.a().b(this.k())},j:function(){Common.S.a().a(this.k())},k:function(){return this.g||(this.g=new Common.V(5,2,Common.a.cu,Common.App.NewAndOpen.Core.a.a().z,109,null,!1,0))},g:null,m:function(){return this.d||(this.d=new Common.V(2,2,Common.a.a.g("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440)*6e4,Common.App.NewAndOpen.Core.a.a().C,197,null,!1,0))},d:null,f:!1,dispose:function(){this.f||(this.f=!0,this.d&&(Common.S.a().b(this.d),this.d=null))}};Common.App.NewAndOpen.Core.k=function(){Common.App.NewAndOpen.Core.k.initializeBase(this);this.g(0);this.i=!1;this.k=!1};Common.App.NewAndOpen.Core.k.prototype={h:null,b:function(){return this.h},e:null,c:function(){return this.e},i:!1,d:function(){return this.i},k:!1,j:function(){return"GetMoreInfo Result"}};Common.App.NewAndOpen.Core.b=function(n,t){Common.App.NewAndOpen.Core.b.initializeBase(this);this.e=n;this.c=new Common.App.NewAndOpen.Core.m(t,this.d().f(),"GetMoreInfo");this.b=new Common.App.NewAndOpen.Core.k};Common.App.NewAndOpen.Core.b.b=function(){return Common.App.NewAndOpen.Core.b.a||(Common.App.NewAndOpen.Core.b.a=Common.App.NewAndOpen.Core.b.d())};Common.App.NewAndOpen.Core.b.d=function(){return new Common.App.NewAndOpen.Core.b(new($$sc.z.$$(Common.cu))(function(){return Common.App.NewAndOpen.Core.c.a()}),new($$sc.z.$$(String))(function(){return Common.a.dl}))};Common.App.NewAndOpen.Core.b.c=function(n){if(!n)return Diag.a.a(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;var t=n.toLowerCase();return t.startsWith("https://")?!0:(Diag.a.a(5849625,202,10,"StorageUrl has invalid scheme."),!1)};Common.App.NewAndOpen.Core.b.prototype={e:null,c:null,b:null,l:function(){this.f("Document opened",!1)},k:function(n){var t=this;return function(){t.f(n,!0)}},M:function(n,t){return Diag.a.a(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:n}),this.b.f===3?(t&&this.v(t,this.b),Diag.a.a(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:n})):this.f(n,!1),this.b},f:function(n,t){if(this.c.g(!t),this.b.f===1){Diag.a.a(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:n,RetryIndex:this.c.a});return}Diag.a.a(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:n,RetryIndex:this.c.a});this.b.g(1);var i=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.d().e(),Common.a.i),r=this.d().d().d(i,1,null,null,["PersonalFileStorageUrl","StorageServiceDisplayName"],!1,5,this.j(n),this.h(n),null,null,!1,null,null,null,null,!1,null,!1,null,null)},j:function(){var n=this;return function(t){var r=!1,e=!1,o=!1,s=null,h,c,i,u,f,l;Common.a.a.a("GetMoreInfoDataFromResponseBody")&&(t.b.b?(c=Common.bp.a(t.b.b,h={val:s}),s=h.val,c)?(i=s,i?(o=!0,n.b.e=i.StorageServiceDisplayName,n.b.h=Common.App.NewAndOpen.Core.b.c(i.PersonalFileStorageUrl)?i.PersonalFileStorageUrl:"",r=n.b.h===""&&n.b.e!==""):Diag.a.a(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers")):Diag.a.a(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):Diag.a.a(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));o||(u=t.b.d,u?(n.b.e=(u.StorageServiceDisplayName||"").toString(),f=(u.PersonalFileStorageUrl||"").toString(),n.b.h=Common.App.NewAndOpen.Core.b.c(f)?f:"",r=f===""&&n.b.e!==""):(Diag.a.a(5849622,202,50,"Null response headers received."),e=!0));l=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",n.c.a,e,r,o);n.d().b("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",t.b,l);n.g(3,r,e)}},h:function(n){var t=this;return function(i){t.d().b("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",i.b,"Failure");t.g(2,!1,!1);t.c.j(t.k(n))}},g:function(n,t,i){this.b.g(n);this.b.i=t;this.b.k=i;this.n(this.b)},d:function(){return this.e.a()}};Common.App.NewAndOpen.Core.o=function(){};Common.App.NewAndOpen.Core.o.prototype={PersonalFileStorageUrl:null,StorageServiceDisplayName:null};Common.App.NewAndOpen.Core.d=function(n,t,i,r,u){this.j=Function.createDelegate(this,this.p);this.f=n;this.b=t;this.e=i;this.g=r;this.a=new Common.bc;u&&this.q();this.d=this.b()};Common.App.NewAndOpen.Core.d.b=function(){return Common.App.NewAndOpen.Core.d.a||(Common.App.NewAndOpen.Core.d.a=Common.App.NewAndOpen.Core.d.c())};Common.App.NewAndOpen.Core.d.c=function(){return new Common.App.NewAndOpen.Core.d(new($$sc.z.$$(Common.eo))(function(){return Common.S.a()}),function(){return Common.a.dM.getTime()},function(){return(new Date).getTime()},new($$sc.z.$$(Number))(function(){return Common.a.dz}),!0)};Common.App.NewAndOpen.Core.d.prototype={k:6e4,d:0,f:null,b:null,e:null,g:null,a:null,i:"inactive",h:"active",c:!0,l:function(n){this.a.m(this.h,n)},n:function(n){this.a.m(this.i,n)},q:function(){var n=new Common.V(5,2,this.k,this.j,108,null,!1,0);this.o().a(n)},p:function(){var n=this.b(),i=this.e(),t=i-n;t>this.m()&&this.c&&(Diag.a.a(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:t}),this.c=!1,this.a.k(this.i,null,null));n-this.d>this.m()&&(this.c=!0,this.a.k(this.h,null,null));this.d=n},o:function(){return this.f.a()},m:function(){return this.g.a()}};Common.App.NewAndOpen.Core.l=function(){Common.App.NewAndOpen.Core.l.initializeBase(this);this.g(0);this.h=!1};Common.App.NewAndOpen.Core.l.prototype={k:null,c:function(){return this.k},l:null,d:function(){return this.l},i:null,b:function(){return this.i},m:0,e:function(){return this.m},h:!1,j:function(){return"MruActor Result"}};Common.App.NewAndOpen.Core.a=function(n,t,i,r,u,f,e){this.y=Function.createDelegate(this,this.S);this.x=Function.createDelegate(this,this.R);this.A=Function.createDelegate(this,this.U);this.w=Function.createDelegate(this,this.P);this.E=Function.createDelegate(this,this.bd);this.D=Function.createDelegate(this,this.bc);this.C=Function.createDelegate(this,this.ba);this.z=Function.createDelegate(this,this.T);this.B=Function.createDelegate(this,this.X);Common.App.NewAndOpen.Core.a.initializeBase(this);this.r=n;this.q=t;this.d=new Common.App.NewAndOpen.Core.i(Common.a.a.g("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5e3),Common.a.a.g("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.c().f());this.e=new Common.App.NewAndOpen.Core.i(Common.a.a.g("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15e3),Common.a.a.g("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.c().f());this.s=i;this.k=r;this.f={};this.b=new Common.App.NewAndOpen.Core.l;this.p=u;this.g="";this.o=f;this.j=e};Common.App.NewAndOpen.Core.a.a=function(){return Common.App.NewAndOpen.Core.a.b||(Common.App.NewAndOpen.Core.a.b=Common.App.NewAndOpen.Core.a.c())};Common.App.NewAndOpen.Core.a.c=function(){return new Common.App.NewAndOpen.Core.a(new($$sc.z.$$(Common.cu))(function(){return Common.App.NewAndOpen.Core.c.a()}),new($$sc.z.$$(String))(function(){return Common.e.b(Common.a.n).a}),new($$sc.z.$$(Boolean))(function(){return Common.a.b().a().d()}),Common.a.a.a("MruWriteFileIdInHeader"),function(){return Common.a.b().a().r()},function(){return Common.a.m},new($$sc.z.$$(Boolean))(function(){return Common.a.a.a("OICEncodeUrlIsEnabled")}))};Common.App.NewAndOpen.Core.a.prototype={r:null,q:null,k:!1,b:null,d:null,e:null,g:null,p:null,o:null,s:null,j:null,f:null,bb:function(){var n=this.c().h();n.a(3502386740,2147483648,this.D)},bc:function(){return this.u("Rename",!1)},Z:function(){this.J("File Opened")},ba:function(){this.J("IntervalUpdate")},J:function(n){Diag.a.a(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:n});this.u(n,!1)},Q:function(n){var t=Common.d.i(n);return t&&t.startsWith(".")&&(t=t.substring(1,t.length)),t},G:function(){switch(this.c().a()){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}},V:function(n){var r=this.p(),t,i,u;return r?(t=new Common.MruV2.a,t.documentUrl=this.j.a()?encodeURI(r):r,t.mruItemId=this.g,t.app=this.G(),i=this.o(),i&&(t.folderName=i.b(),u=i.a(),t.documentName=Common.d.d(u),t.documentExt=this.Q(u)),n&&(t.documentName?t.documentName.length?t.documentName.length>=255?n.set("DocumentNameLength","Long"):t.documentName.length>=2084&&n.set("DocumentNameLength","VeryLong"):n.set("DocumentNameLength","0"):n.set("DocumentNameLength","Null")),JSON.stringify(t)):null},u:function(n,t){var i,r,e,u,f;return this.c().a()===4&&!Common.a.R?2:(i=this.h(),i&&(i.set("Trigger",n),i.set("IsRetry",t?"true":"false"),i.set("MruIdSent",this.g?"true":"false"),i.set("URLEncoded",this.j.a()?"true":"false")),Common.i.a().recordKpiUsage("WriteMru",0,"smartfio",i),r=this.V(i),!r)?(e=!Common.a.cp,i&&(i.set("WebEditingIsEnabled",Common.a.cp?"true":"false"),i.set("ProtectedFile",Common.a.bj?"true":"false")),Common.i.a().recordKpiFailure("WriteMru","MissingDocumentUrl",e,!1,(u=new Common.U,u.extendedProperties=i,u)),2):(this.e&&!t&&this.e.g(),f=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.c().e(),this.F()),this.k?this.f["X-FileId"]=Common.a.i:f+=String.format("&{0}",Common.a.i),Common.a.d&&(this.f["X-Office-AudienceGroup"]=$$as(String,Common.a.d.AudienceGroup)||""),this.f["X-Timeout"]=Common.a.a.g("Microsoft.Office.SharedOnline.MruWriteTimeout",1e4),this.c().d().a(f,2,r,this.f,!0,5,this.E,this.w,null,null,!1,null,null,"4",null,!1,null,!1,null))},bd:function(n){this.H(n.b)},H:function(n){var t=this.h(),i,u,r;this.e&&(t&&this.e.a&&(t.set("LastError",this.e.a),t.set("NumRetries",this.e.b.toString())),this.e.g());i=Common.App.NewAndOpen.Core.e.b(n.b);i&&i.diagnostics_data&&(this.g=i.diagnostics_data.mru_id);u=n.i-n.h;t&&t.set("RequestDuration",u.toString());Common.i.a().recordKpiSuccess("WriteMru",(r=new Common.U,r.extendedProperties=t,r))},P:function(n){var i,t,r;if(n.b.a===201){this.H(n.b);return}i=n.b.a===412;t=this.h();this.I(this.e,n,this.O(),t);t&&(t.set("StatusCode",n.b.a.toString()),i||this.t(n.b,t));Common.i.a().recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",n.b.a),i,!1,(r=new Common.U,r.extendedProperties=t,r))},O:function(){var n=this;return function(){n.u("Retry",!0)}},T:function(){this.l("Polling",!1)},S:function(){this.l("Retry",!0)},Y:function(){this.l("Open",!1)},X:function(){this.l("Activity",!1)},l:function(n,t){Diag.a.a(5849674,202,50,"Making GetMru request {0}",{Trigger:n});var i=this.h();i&&(i.set("Trigger",n),i.set("IsRetry",t?"true":"false"));Common.i.a().recordKpiUsage("GetMru",0,"smartfio",i);this.d&&!t&&this.d.g();this.N(this.A,this.x)},t:function(n,t){if(n&&n.d){var i=n.d["X-CorrelationId"];i&&t.set("ServerCorrelationId",i)}},h:function(){try{return new Map}catch(n){return null}},W:function(n,t){var r,i;n&&(t&&(r=n.i-n.h,t.set("RequestDuration",r.toString())),Common.i.a().recordKpiSuccess("GetMru",(i=new Common.U,i.extendedProperties=t,i)))},U:function(n){var o="",u=null,f=null,r=null,i=Common.App.NewAndOpen.Core.e.b(n.b.b),t,e;i&&(u=i.places?i.places.items:[],f=i.documents?i.documents.items:[],r=Common.App.NewAndOpen.Core.e.d(i),r&&(o=JSON.stringify(r)));Common.a.b()&&Common.a.b().a().k()&&Common.F.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(o,!0));t=this.h();this.d&&(t&&this.d.a&&(t.set("LastError",this.d.a),t.set("NumRetries",this.d.b.toString())),this.d.g());r||u||f?(this.c().b("MruActor.GetMruV2FromServerSuccessCallback",n.b,"Success"),this.m(3,r,u,f,!1),this.W(n.b,t)):(this.c().b("MruActor.GetMruV2FromServerSuccessCallback",n.b,"Failure: Invalid JSON"),t&&this.t(n.b,t),Common.i.a().recordKpiFailure("GetMru","JsonParseFailed",!1,!1,(e=new Common.U,e.extendedProperties=t,e)),this.m(3,null,null,null,!0));this.n(this.b)},I:function(n,t,i,r){var f=0,e=0,u=Common.App.NewAndOpen.Core.e.b(t.b.b),o;(u&&(u.response_code!=null&&(f=u.response_code,r&&r.set("MruResponseCode",f.toString()),f===9&&(this.g="")),u.error_data&&u.error_data.retry_after_ms!=null&&(e=u.error_data.retry_after_ms,r&&r.set("ExpectedRetryAfter",e.toString()))),n)&&(o=n.j(i,e,t.b.a,f),r&&(r.set("CurrentRetryCount",n.b.toString()),r.set("RetryScheduled",o?"true":"false")))},R:function(n){var r=n.b.a===412,t=this.h(),i;t&&(t.set("StatusCode",n.b.a.toString()),r||this.t(n.b,t));this.c().b("MruActor.GetMruFromServerFailureCallback",n.b,"Failure");this.m(2,null,null,null,!1);this.I(this.d,n,this.y,t);Common.i.a().recordKpiFailure("GetMru",String.format("RequestFailed_{0}",n.b.a),r,!1,(i=new Common.U,i.extendedProperties=t,i));this.n(this.b);Common.a.b()&&Common.a.b().a().k()&&Common.F.a()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1))},m:function(n,t,i,r,u){(this.b.f!==3||n===3)&&(this.b.k=t,this.b.l=i,this.b.i=r,this.b.g(n),this.b.h=u,this.b.m=this.c().g()())},M:function(n,t){return Diag.a.a(6029918,202,50,"MRU result requested {0}",{Trigger:n,ResultState:this.b.f}),t&&this.b.f===3&&this.v(t,this.b),this.b},N:function(n,t){this.m(1,null,null,null,!1);var i,r={};i=String.format(this.c().e()+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.G(),this.F());this.s.a()||(i+="&entity=docs");Common.a.d&&(r["X-Office-AudienceGroup"]=$$as(String,Common.a.d.AudienceGroup)||"");this.k?r["X-FileId"]=Common.a.i:i+=String.format("&{0}",Common.a.i);this.c().d().a(i,1,null,r,!0,5,n,t,null,null,!1,null,null,null,null,!1,null,!1,null)},c:function(){return this.r.a()},F:function(){return this.q.a()}};Common.App.NewAndOpen.Core.e=function(){};Common.App.NewAndOpen.Core.e.b=function(n){if(!n)return null;var t;try{t=JSON.parse(n)}catch(i){t=null;Diag.a.a(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",i)}return t};Common.App.NewAndOpen.Core.e.a=function(n,t){var i=new Array(0),r;return n.breadcrumbs&&n.breadcrumbs.length>0?i=n.breadcrumbs:(r=n.service_info,r&&r.friendly_service_name&&Array.add(i,r.friendly_service_name),n.display_path&&Array.addRange(i,n.display_path)),i.join(t?" \u00ab ":" \u200f\u00bb ")};Common.App.NewAndOpen.Core.e.c=function(n){var t=n.title;return t?(n.extension&&(t=String.format("{0}.{1}",t,n.extension)),t):(Diag.a.a(578352837,202,15,"empty file title"),"")};Common.App.NewAndOpen.Core.e.d=function(n){var f,e,r,t,u,i;if(!n)return[];if(!n.documents)return Diag.a.a(578352838,202,15,"missing documents object"),[];if(!n.documents.items)return Diag.a.a(578352839,202,15,"missing items object"),[];for(f=n.documents.items,e=new($$sc.v.$$(Object)),r=0;r<f.length;r++){if(t=f[r],u=t.web_url,!u){if(Diag.a.a(578320064,202,15,"Empty web_url"),!t.url){Diag.a.a(578140248,202,15,"Empty url");continue}u=String.format("{0}?web=1",t.url)}i={};i.DocumentUrl=u;i.MruId=t.mru_id;i.FileName=Common.App.NewAndOpen.Core.e.c(t);i.IsPinned=t.is_pinned;i.Path=Common.App.NewAndOpen.Core.e.a(t,Common.a.h);e.b(i)}return e.g()};Common.App.NewAndOpen.Core.m=function(n,t,i){this.f=n;this.e=t;this.d=i};Common.App.NewAndOpen.Core.m.prototype={b:null,f:null,c:null,d:"",e:null,g:function(n){this.b&&(this.e.b(this.b),this.b=null);n&&(this.a=0)},j:function(n){var t=this.i(),i=t>=0;return i?(this.a++,this.g(!1),this.b=new Common.V(4,1,t,n,107,null,!1,0),this.e.a(this.b)):(this.g(!0),Diag.a.a(5849676,202,50,"Retries exhausted {0}",{Action:this.d})),i},a:0,i:function(){return this.a>=this.h().length?-1:this.h()[this.a]},h:function(){var t,n,i;if(!this.c)for(t=(this.f.a()||"0").split(","),this.c=[],n=0;n<t.length;n++)i=parseInt(t[n]),isNaN(i)?Diag.a.a(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:this.d,Entry:t[n]}):Array.add(this.c,i);return this.c}};Common.App.NewAndOpen.Core.c=function(n,t,i,r,u,f,e,o){this.r=Function.createDelegate(this,this.w);this.s=Function.createDelegate(this,this.x);this.t=Function.createDelegate(this,this.v);this.k=n;this.n=t;this.l=i;this.m=r;this.q=u;this.j=f;this.o=e;this.p=o};Common.App.NewAndOpen.Core.c.a=function(){return Common.App.NewAndOpen.Core.c.b||(Common.App.NewAndOpen.Core.c.b=Common.App.NewAndOpen.Core.c.c())};Common.App.NewAndOpen.Core.c.c=function(){return new Common.App.NewAndOpen.Core.c(new($$sc.z.$$(Common.fI))(function(){return Common.a.c()}),new($$sc.z.$$(Common.fJ))(function(){return Common.a.e}),new($$sc.z.$$(Common.hv))(function(){return Common.a.b()}),new($$sc.z.$$(Common.bY))(function(){return Common.a.b().a().a()}),new($$sc.z.$$(Common.eo))(function(){return Common.a.k()}),function(){return(new Date).getTime()},new($$sc.z.$$(String))(function(){return Common.a.b().a().n()}),new($$sc.z.$$(Boolean))(function(){return Common.a.cA}))};Common.App.NewAndOpen.Core.c.prototype={k:null,n:null,l:null,m:null,q:null,j:null,o:null,p:null,y:function(){this.h().a(1959943459,2147483648,this.t);this.h().a(2155708348,2147483648,this.s);Common.a.bU?this.u():this.h().b(1169404878,2147483648,this.r,96)},v:function(n,t,i,r,u){var f=u,e;return u&&f.MenuItemId&&(Diag.a.a(5849678,202,50,"Opening new tab {0}",{Id:f.SourceControlId,AppType:Common.bY.toString(this.a())}),e=f.MenuItemId.toString(),Common.g.b(e,"_blank","","NewAndOpenCommonHelpers:OpenUrlInNewTab")),32},x:function(n,t,i,r,u){var e=u,o,s,h,f,c;return u&&e.MenuItemId&&(o=Common.a.a.a("WacInTabOpenMRUIsEnabledForUiHost"),s=Common.a.a.a("UiHostSupportsDocRebootFeatures"),Diag.a.a(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",o,s),o&&s?(Diag.a.a(592237458,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:Common.bY.toString(this.a())}),h=e.MenuItemId.toString(),f={},f.rebootMode="1",f.documentUrl=h,f.reason="open",Diag.a.a(592237460,202,50,"Send PostMessage to the Ui host to reboot a document"),c=this,Common.a.J().a(function(n){n.a("App_DocReboot",f,"")})):this.v(n,t,i,r,u)),32},w:function(){return this.u(),32},b:function(n,t,i){if(t&&t.h){var u=Common.bT.toString(t.c),r=t.h.getTime(),f=this.j()-r;Diag.a.a(5849679,202,50,"Making request to the WAC server {0}",{Caller:n,RequestStatus:u,ElapsedMs:f,StartTime:r,Notes:i})}else Diag.a.a(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:n})},u:function(){var i=Common.a.a.a("QPGVCI"),f=Common.k.b(document.URL,"wdNewAndOpenCt",i),t;if(f){var n=parseInt(f),r=Common.k.b(document.URL,"wdPreviousSession",i),u=Common.k.b(document.URL,"wdPreviousCorrelation",i),e=Common.a.a.a("NAOPLP");if(!Common.a.bU){Diag.a.a(5849681,202,e?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:n,SessionId:r,Correlation:u});return}t=Common.a.bU.getTime();!n||n>t?Diag.a.a(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:n,DocumentLoadedTime:t,SessionId:r,Correlation:u}):Diag.a.a(5849683,202,e?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{ClickToLoadTime:t-n,ClickTimestamp:n,SessionId:r,Correlation:u})}},h:function(){return this.k.a()},d:function(){return this.n.a()},i:function(){return this.l.a()},a:function(){return this.m.a()},f:function(){return this.q.a()},g:function(){return this.j},e:function(){return this.o.a()},c:function(){return this.p.a()}};Common.App.NewAndOpen.Core.p=function(){};Common.App.NewAndOpen.Core.p.a=function(){Common.App.a.a().a(new Common.App.NewAndOpen.Core.j,0,!1)};Common.App.NewAndOpen.Core.i=function(n,t,i){this.h=n;this.i=t;this.f=i;this.e=0;this.b=0;this.d=null;this.a=null};Common.App.NewAndOpen.Core.i.prototype={k:function(n,t){return n===403||t===20||t===18||t===3},l:function(n){return n===3||n===5||n===6||n===7||n===9||n===10||n===11||n===12||n===13||n===14||n===15||n===16||n===23||n===26||n===27||n===28},b:0,e:0,h:0,i:0,a:null,c:null,d:null,f:null,g:function(){this.b=0;this.e=0;this.d=null;this.a=null;this.c&&(this.f.b(this.c),this.c=null)},j:function(n,t,i,r){if(this.a=String.format("{0}_{1}",i,r),this.b>=this.i)return Diag.a.a(562656907,202,50,"Max retries exceeded"),!1;if(this.k(i,r))return Diag.a.a(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.l(r)&&this.e>=1)return this.d=i,!1;var u=Math.max(t,this.h*Math.pow(2,this.e));return r===26?u=Math.max(u,3e4):(r===27||r===28)&&(u=Math.max(u,6e4)),r!==9&&(i!==412||this.d!=null&&this.d===412)?this.e++:u=500,this.d=i,this.b++,this.c&&this.f.b(this.c),Diag.a.a(562656909,202,50,"Scheduling next retry after {0} ms.",u),this.c=new Common.V(2,1,u,n,107,null,!1,0),this.f.a(this.c),!0}};Common.App.NewAndOpen.Core.n.registerClass("Common.App.NewAndOpen.Core.n",null,Common.ko);Common.App.NewAndOpen.Core.k.registerClass("Common.App.NewAndOpen.Core.k",Common.App.NewAndOpen.Core.n,Common.by,Common.ko);Common.App.NewAndOpen.Core.b.registerClass("Common.App.NewAndOpen.Core.b",Common.App.NewAndOpen.Core.f.$$(Common.by));Common.App.NewAndOpen.Core.l.registerClass("Common.App.NewAndOpen.Core.l",Common.App.NewAndOpen.Core.n,Common.bI,Common.ko);Common.App.NewAndOpen.Core.a.registerClass("Common.App.NewAndOpen.Core.a",Common.App.NewAndOpen.Core.f.$$(Common.bI));Common.App.NewAndOpen.Core.i.registerClass("Common.App.NewAndOpen.Core.i");Common.App.NewAndOpen.Core.h.a=0;Common.App.NewAndOpen.Core.b.a=null;Common.App.NewAndOpen.Core.d.a=null;Common.App.NewAndOpen.Core.a.b=null;Common.App.NewAndOpen.Core.c.b=null;Common.App.NewAndOpen.Core.p.a();Type.registerNamespace("Common.App.SessionExpiration");Common.App.SessionExpiration.j=function(){};Common.App.SessionExpiration.e=function(){};Common.App.SessionExpiration.e.registerInterface("Common.App.SessionExpiration.e");Common.App.SessionExpiration.k=function(){};Common.App.SessionExpiration.l=function(){};Common.App.SessionExpiration.m=function(){};Common.App.SessionExpiration.c=function(){};Common.App.SessionExpiration.a=function(){};Common.App.SessionExpiration.d=function(){};Common.App.SessionExpiration.i=function(){var n,t;(this.p=Function.createDelegate(this,this.y),this.o=Function.createDelegate(this,this.x),n=Common.a.o,n<=0)||(this.m=n,t=new Date,Diag.a.a(17581890,217,50,"Initializing SessionExpirationManager. {0}",{AccessTokenTtl:this.m,NowGetTime:t.getTime(),BootTime:Common.a.N}),Common.be.a().j(this.o),Common.be.a().i(this.p))};Common.App.SessionExpiration.i.prototype={n:!1,q:!1,m:0,x:function(){Common.be.a().n(this.o);Diag.a.a(19247381,217,50,"SessionExpiredDetected");this.w()},y:function(){Common.be.a().m(this.p);this.q||this.n||(Diag.a.a(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.q=!0,this.u())},w:function(){this.n||(Common.a.bb(28,null,null,null),this.n=!0,this.t())}};Common.App.SessionExpiration.f=function(n){this.m=Function.createDelegate(this,this.q);this.f={};this.e={};this.o={};this.p=new Date;this.g=new Date;this.r=new Date;this.i=n;this.h=new Common.V(2,2,this.k*6e4,this.m,135,"SL",!1,0);this.i.a(this.h);this.s()};Common.App.SessionExpiration.f.prototype={k:15,h:null,n:!1,i:null,q:function(){Diag.a.a(41964821,217,50,Diag.a.g({Aggregate:this.e,Current:this.f}))},s:function(){this.e.RequestGroups=0;this.e.Requests=0;this.e.Responses=0;this.e.Status="Initialized";this.e.FirstActivity=new Date;this.e.SessionDuration=0;this.e.ActivityDuration=0;this.e.SessionDuration=0;this.f.SessionDuration=0;this.e.ActivityDuration=0;this.f.ActivityDuration=0},j:function(n,t){var i=n[t],r=i?i:0;r++;n[t]=r;this.l(n)},l:function(n){var t=new Date;n.ActivityDuration=t-this.g;this.g=t;n.SessionDuration=this.g-this.p;n.LastActivity=this.g},a:function(n,t){this.f[n]=t;this.l(this.f)},c:function(n,t){this.f[n]=t;this.l(this.f)},b:function(n){this.j(this.f,n);this.j(this.e,n);this.j(this.o,n)},d:function(){this.n||(this.e.Status=this.f.Status,this.q(this.h),this.i.d(this.h,this.k*6e4))}};Common.App.SessionExpiration.b=function(n,t){this.d=n;this.c=t};Common.App.SessionExpiration.b.prototype={d:null,b:function(){return this.d},c:null,a:function(){return this.c}};Common.App.SessionExpiration.g=function(n,t,i,r){this.q=Function.createDelegate(this,this.w);this.p=Function.createDelegate(this,this.u);this.o=new($$sc.v.$$(Common.App.SessionExpiration.c));this.h=new($$sc.v.$$(Common.App.SessionExpiration.a));this.k=n;this.m=t;var u=this;this.m.a(function(n){n.b("Host_RefreshSessionInfo",u.p)});this.e=i;this.n=new DiagUse.b("WebServiceCall","TokenRefresh");this.d=r||new Common.App.SessionExpiration.f(n)};Common.App.SessionExpiration.g.prototype={k:null,m:null,e:null,j:0,g:null,f:null,i:null,n:null,l:!1,d:null,u:function(n){var e,i,t,o,r,f,u,s;if(n.MessageId!=="Host_RefreshSessionInfo"){Diag.b.a(39408099,306,15,"Unexpected message.");return}for(e=new($$sc.v.$$(Common.App.SessionExpiration.c)),i=new($$sc.v.$$(Common.App.SessionExpiration.a)),this.d.b("Responses"),t=n.Values.Tokens,(!t||t.length<=0)&&(Diag.b.a(40122317,306,15,"Found no tokens in the dictionary"),t=n.Values),Diag.b.a(40122318,306,100,"The Tokens array contains {0} tokens",t.length),this.d.a("Correlation",n.CorrelationId),o=0;o<t.length;o++)(this.d.c("Tokens",t.length),r=t[o],f=r,f&&f.Name)&&(this.d.b(f.Name),u=r,u&&u.Value?(Diag.b.a(39408128,306,100,"Received token with name: {0}",u.Name),e.b(u),this.o.b(u),this.d.a("Status","Success")):(Diag.b.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",f.Name,JSON.stringify(r),this.f),i.b(r),this.h.b(r),this.d.a("Error",JSON.stringify(r)),this.d.a("Status","Failed")));if(Diag.b.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",e.f.length,i.f.length,n.CorrelationId,this.f),i.f.length>0&&!this.a(i)){s=this.e.e(i);s!==this.e.b()&&(this.d.c("RetryOverride",s),this.k.d(this.g,s));return}this.d.d();this.g&&(Diag.b.a(39408131,306,100,"Deleting task {0} from task manager",this.g.g),this.k.b(this.g));!this.i||this.i.a.b>3||this.i.b(new Common.App.SessionExpiration.b(e,i))},w:function(){var n,t,i;if(this.j>=this.e.c()){Diag.b.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.f);this.r(this.i,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts");return}Common.i.a().recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);n={};n.Tokens=this.e.a();t=Common.v.a().a;Diag.b.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.e.a()),this.j+1,t,this.f);i=this;this.m.a(function(i){i.a("App_RefreshSessionInfo",n,t)});this.j++;this.d.b("Requests")},r:function(n,t,i){for(var r,u,e,o=new($$sc.v.$$(Common.App.SessionExpiration.a)),f=0;f<this.e.a().length;f++)e=(u=new Common.App.SessionExpiration.a,u.Name=this.e.a()[f],u.Errors=[(r=new Common.App.SessionExpiration.d,r.Id=t,r.Details=i,r)],u),o.b(e),this.h.b(e);this.k.b(this.g);this.d.a("Errors",JSON.stringify(this.h));this.d.a("Status","Failed");!n||n.a.b>3||n.b(new Common.App.SessionExpiration.b(new($$sc.v.$$(Common.App.SessionExpiration.c)),this.h))},c:function(n,t){var i,r;return this.n.d(),this.l=n,this.f=Common.v.a().a,Diag.b.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.f,this.l),this.j=0,this.h.h(),this.o.h(),i=new($$sc.D.$$(Common.App.SessionExpiration.e)),this.i=i,t&&(r=this,t.R(function(){var n=!!i&&!(i.a.b>3);Diag.b.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",r.f,r.l,n);n&&r.r(i,"ABORTED_BY_CALLER","The refresh was aborted by the caller")})),this.g=new Common.V(this.e.d(),2,this.e.b(),this.q,98,"App_RefreshSessionInfo",!0,0),this.k.a(this.g),this.i.a},b:function(n){var t,i,r;if(this.n.a(),t=this.t(n.a().a()),Diag.a.a(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!t,this.f,this.l,this.j,this.h.f.length,n.a().a().f.length>0?n.a().a().a(0).Name:"",n.a().a().f.length>0&&n.a().a().a(0).Errors.length>0?n.a().a().a(0).Errors[0].Id:"",n.a().a().f.length>0&&n.a().a().a(0).Errors.length>0?n.a().a().a(0).Errors[0].Details:""),t)r=(i=new Common.U,i.extendedProperties=new Map,i),r.extendedProperties.set("Errors",this.s(n.a().a())),Common.i.a().recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,r);else return Common.i.a().recordKpiSuccess("WACTokenRefresh",null),this.v(n.a().b());return!1},a:function(n){return this.e.f(n)},v:function(n){for(var t,r,i=0;i<n.f.length;i++)t=n.a(i),t.Name==="AccessToken"&&(r=(new Date).getTime(),t.Expiry>Common.a.o?(Diag.a.a(39706827,217,50,"Updating AccessToken: {0}",{AccessTokenTtl:t.Expiry,NowGetTime:r,BootTime:Common.a.N},"PreviousAccessTokenTtl",Common.a.o),Common.a.gl(t.Value),Common.a.cY(Math.floor(t.Expiry)),Common.a.cC=r,Common.a.bm=Math.floor(t.Expiry)):Diag.a.a(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{AccessTokenTtl:t.Expiry,NowGetTime:r,BootTime:Common.a.N},"PreviousAccessTokenTtl",Common.a.o));return!0},t:function(n){for(var i,r=!1,t=0;t<n.f.length;t++)r=!0,i=n.a(t),Diag.a.a(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",i.Name,JSON.stringify(i.Errors),this.f);return r},s:function(n){for(var i,r={},t=0;t<n.f.length;t++)i=n.a(t),r[i.Name]=JSON.stringify(i.Errors);return JSON.stringify(r)}};Common.App.SessionExpiration.h=function(){this.i=Common.a.bS;this.l=Common.a.dC;this.n=Common.a.dF;this.o=Common.a.bQ;this.m=Common.a.bT;this.j=this.p();this.h=Common.a.dD;this.g=!1;this.k=Common.a.bS;Common.a.a&&(this.g=Common.a.a.d("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",!1),this.g&&(this.k=Common.a.a.g("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",Common.a.bS)))};Common.App.SessionExpiration.h.prototype={j:null,h:null,g:!1,k:0,i:0,b:function(){return this.i},l:0,c:function(){return this.l},n:null,a:function(){return this.n},o:0,m:0,d:function(){return this.m},f:function(n){var u=JSON.stringify(n),i;if(this.h&&this.h.length>0)for(var r=this.h,f=r.length,t=0;t<f;++t)if(i=r[t],i.length>0&&u.indexOf(i)>=0)return!0;return!1},e:function(n){var i,r,t,e;try{if(n)for(i=n.$$lge();i.$$mn();)if(r=i.$$cu(),r.Errors)for(var f=r.Errors,o=f.length,u=0;u<o;++u){if(t=f[u],t.Id in this.j)return Number.parseInvariant(this.j[t.Id].toString());if(this.g)try{if(e=Number.parseInvariant(t.Id),e>=500)return this.k}catch(s){Diag.a.a(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",s.toString(),t.Id);continue}}}catch(h){Diag.a.a(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.i},p:function(){var n={},i;try{if(!Common.a.bC||Common.a.bC.length<=0||Common.a.bC[0]==="")return n;for(var r=Common.a.bC,u=r.length,t=0;t<u;++t)i=r[t],i.length>0&&(n[i]=Common.a.dE)}catch(f){Diag.a.a(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",f.toString())}return n}};Common.App.SessionExpiration.m.registerClass("Common.App.SessionExpiration.m");Common.App.SessionExpiration.c.registerClass("Common.App.SessionExpiration.c",Common.App.SessionExpiration.m);Common.App.SessionExpiration.a.registerClass("Common.App.SessionExpiration.a",Common.App.SessionExpiration.m);Common.App.SessionExpiration.i.registerClass("Common.App.SessionExpiration.i");Common.App.SessionExpiration.b.registerClass("Common.App.SessionExpiration.b",null,Common.App.SessionExpiration.e);Type.registerNamespace("_Ewa");_Ewa.bif=function(){};_Ewa.bif.a=function(){Common.M.a('.ewr-selection-draghandle{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}')};_Ewa.bif.a();Type.registerNamespace("_Ewa");_Ewa.bog=function(){};_Ewa.bog.a=function(){Common.M.a('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')};_Ewa.bog.a();Type.registerNamespace("_Ewa");_Ewa.boI=function(){};_Ewa.boI.a=function(){Common.M.a(".ewa-svg-icon{height:100%;width:100%}")};_Ewa.boI.a();Type.registerNamespace("_Ewa");_Ewa.boL=function(){};_Ewa.boL.a=function(){Common.M.a(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")};_Ewa.boL.a();Type.registerNamespace("_Ewa");_Ewa.zV=function(n){_Ewa.zV.initializeBase(this);this.i=n;this.l()};_Ewa.zV.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.kt),164,new _Ewa.zV(n))};_Ewa.zV.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.kt,451,!1,null)||this.i.a().b(_Ewa.kt,451,new _Ewa.NewAndOpenCoreManager(this.i)))}};_Ewa.NewAndOpenCoreManager=function(n){_Ewa.NewAndOpenCoreManager.initializeBase(this,[!1]);this.c=n;Diag.a.a(544289228,0,50,"NewAndOpenCoreManager created")};_Ewa.NewAndOpenCoreManager.prototype={c:null,b:null,a:function(){var r=new($$sc.v.$$(Object)),h=Common.Utils.b.a(Common.km.$$(Common.bI),Common.Utils.a.a().b(Common.km.$$(Common.bI),null)),a=this,f=new($$sc.z.$$(Common.km.$$(Common.bI)))(function(){return h.a()}),c,n,i,t;if(f&&(c=this,this.b=new($$sc.z.$$(Common.kn.$$(Common.bI)))(function(){return new(Common.App.NewAndOpen.Core.g.$$(Common.bI))(f.a(),null)})),!this.b)return r;if(n=this.b.a().a("NewAndOpenCoreManager",!1),!n||n.a()!==3||!n.b())return n?Diag.a.a(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",n.a(),!n.b()):Diag.a.a(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;var e=n.b(),l=["xlsx","xlsb","xlsm"];for(i=0;i<e.length;i++)if(t=e[i],!(Array.indexOf(l,t.extension)<0)){var o=String.format("{0}.{1}",t.title,t.extension),s=Common.App.NewAndOpen.Core.e.a(t,Common.a.h),u=t.url;if(!o||!s||!u){u||Diag.a.a(544289225,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null");continue}r.b({FileName:o,FriendlyPath:s,Section:"mru",AbsoluteUrl:u})}return r},dispose:function(){_Ewa.bgJ.prototype.dispose.call(this)}};_Ewa.zV.registerClass("_Ewa.zV",_Ewa.sY.$$(_Ewa.kt));_Ewa.NewAndOpenCoreManager.registerClass("_Ewa.NewAndOpenCoreManager",_Ewa.bgJ,_Ewa.kt,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.blD=function(){};_Ewa.blD.a=function(){_Ewa.m.a(_Ewa.zV.a)};_Ewa.blD.a();Type.registerNamespace("_Ewa");_Ewa.Xm=function(n,t,i){this.r=Function.createDelegate(this,this.x);this.n=n;this.m=document.createElement("div");this.m.setAttribute("aria-hidden","true");this.m.className="ewa-gridReader";t.insertBefore(this.m,i);_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")&&(this.p=document.createElement("div"),this.p.setAttribute("aria-hidden","true"),this.p.className="ewa-gridReader",t.insertBefore(this.p,this.m));this.s=_Ewa.ClientStringManager.a().b(2);this.o=document.createElement("div");this.o.setAttribute("role","alert");this.o.setAttribute("aria-live","assertive");this.o.className="ewa-gridReader";t.insertBefore(this.o,_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")?this.p:this.m);this.y();this.n.a().b(_Ewa.cC,211,this)};_Ewa.Xm.prototype={n:null,o:null,m:null,p:null,s:null,c:function(){return this.s},l:function(){return!0},v:function(){return _Ewa.c.a(this.n).g(null)},dispose:function(){this.n&&this.z();_Ewa.b.g(this.o);_Ewa.b.g(this.m);_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")&&_Ewa.b.g(this.p);this.n=null;this.o=null;this.m=null;_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")&&(this.p=null)},b:function(n){this.u(_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")?this.p:this.m,n)},j:function(n){this.u(this.m,n)},a:function(n){this.q(_Ewa.cP.a(n),_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite"))},d:function(n){this.q(_Ewa.cP.a(n),!1)},f:function(n,t){if(t<1||!n||!n.length){Diag.a.b(18219406,0,!1,"Skiping listbox description readout");return}var i=new Sys.StringBuilder,r=String.format(_Ewa.ClientStringManager.a().c(33),t,n);_Ewa.bw.a(i,r);_Ewa.bw.a(i,_Ewa.ClientStringManager.a().a(814));this.q(_Ewa.cP.a(i.toString()),!1)},h:function(n,t,i){if(i<1||t<1||t>i||!n||!n.length){Diag.a.b(18219407,0,!1,"Skipping listbox item readout");return}var r=new Sys.StringBuilder;_Ewa.bw.a(r,n);r.append(String.format(_Ewa.ClientStringManager.a().c(54),t,i));this.q(_Ewa.cP.a(r.toString()),!1)},g:function(n){var t=this.w(n);this.q(t,!1)},q:function(n,t){var i=n?n.a():null,r;i&&(r=t?this.p:this.m,_Ewa.f.b(r.innerHTML,i,!1)&&(i=i+_Ewa.cP.e()),r.innerHTML=i)},e:function(n,t){this.o.getAttribute("aria-live")!==t&&this.o.setAttribute("aria-live",t);var i=n?_Ewa.cP.a(n).a():"";this.o.innerHTML=i},i:function(n,t,i,r){var u=_Ewa.ClientStringManager.a().c(53),f;Diag.a.b(19674567,0,!isNullOrUndefined(n),null);Diag.a.b(19674568,0,!isNullOrUndefined(t),null);Diag.a.b(19674569,0,!isNullOrUndefined(i),null);Diag.a.b(19674570,0,!isNullOrUndefined(r),null);Diag.a.b(19674571,0,!isNullOrUndefined(u),null);f=String.format(u,n||"",t||"",i||"",r||"");this.a(f)},k:function(n){var r=_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")?this.p.style:this.m.style,i,t;n?(i=_Ewa.ch.c(n.a(),r),t=i.a,t.top=t.left=t.bottom=t.right=null,i.b()):r.cssText=""},w:function(n){var t,i,r;switch(n){case-1985798686:return _Ewa.cP.b(12);case-911352779:return _Ewa.cP.b(11);case 237279923:return _Ewa.cP.b(13);case-1502853784:return _Ewa.cP.d(81);case-111689794:return _Ewa.cP.d(78);case-287251124:return t=this,this.t(1255,function(n){return n.r()});case-1925065947:return i=this,this.t(1256,function(n){return n.w()});case 1764140053:return r=this,this.t(1257,function(n){return n.x()})}return null},y:function(){Diag.a.b(18458268,0,!!this.n,"Can't register to ewaControl's events");this.n&&(Diag.a.b(18458269,0,!!this.n.i(),"Can't register to CommandHandlerManager's event"),this.n.i()&&this.n.i().i(this.r))},z:function(){this.n&&this.n.i().f(this.r)},x:function(n,t){this.g(t.a.a)},u:function(n,t){var i=n===this.m;t?(n.setAttribute("aria-live","polite"),i&&n.setAttribute("role","alert"),n.setAttribute("aria-hidden","false"),n.removeAttribute("aria-hidden"),n.innerHTML+=" "):(n.removeAttribute("aria-live"),i&&n.removeAttribute("role"),n.setAttribute("aria-hidden","true"))},t:function(n,t){var i=this.v(),r;return i?(r=t(i)?7:8,_Ewa.cP.h(r,_Ewa.cP.b(n))):null}};_Ewa.BK=function(n){_Ewa.BK.initializeBase(this);this.i=n;this.l()};_Ewa.BK.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.cC),212,new _Ewa.BK(n))};_Ewa.BK.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.cC,211,!1,null)||new _Ewa.Xm(this.i,this.i.Z(),this.i.G()))}};_Ewa.Xn=function(n,t,i){this.d=Function.createDelegate(this,this.f);this.c=t;this.b=n;this.e=new _Ewa.BN(n,t);this.a=i.d(this.c);this.a.a(this.d)};_Ewa.Xn.prototype={c:null,e:null,b:null,a:null,dispose:function(){this.a&&this.a.b(this.d);this.c=null;this.b=null;this.a=null},f:function(){this.e.c();this.b.b(!0)}};_Ewa.fR=function(n,t){this.e=t;this.f(n);this.g();_Ewa.a.g()&&n.a().b(_Ewa.mh,244,this)};_Ewa.fR.b=function(){if(!(_Ewa.fR.a!=null))if(_Ewa.a.c("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1))_Ewa.fR.a=!0,Diag.a.a(540037213,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else{_Ewa.fR.a=!1;var n=Common.c.l()||Common.c.b();n&&(_Ewa.fR.a=!0,Diag.a.a(22115012,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on"))}return _Ewa.fR.a};_Ewa.fR.c=function(n){_Ewa.fR.b()&&n.a().b(_Ewa.fR,244,new _Ewa.fR(n,_Ewa.c.a(n).k().a().g()))};_Ewa.fR.prototype={b:null,d:null,c:null,e:null,l:function(){return!!this.e&&document.activeElement===this.e},a:function(n){this.b.setAttribute("aria-label",n);this.d.setAttribute("aria-label",n);this.h()},dispose:function(){this.c&&this.c.parentNode&&this.c.parentNode.removeChild(this.c);this.e=null;this.c=null;this.b=null;this.d=null},f:function(n){var r=n.l()+"readoutElementWrapper",u=n.l()+"readoutElement1",f=n.l()+"readoutElement2",i,t;this.c=document.getElementById(r);this.c||(this.c=document.createElement("div"),this.c.id=r,this.b=document.createElement("label"),this.b.id=u,this.d=document.createElement("label"),this.d.id=f,this.b.style.width="0px",this.b.style.height="0px",this.d.style.width="0px",this.d.style.height="0px",this.b.tabIndex=-1,this.d.tabIndex=-1,this.c.appendChild(this.b),this.c.appendChild(this.d),i=n.l()+"contentAreaDiv",t=document.getElementById(i),Diag.a.b(22115013,3,!!t,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",i),t&&t.appendChild(this.c))},g:function(){this.e&&this.b&&this.d&&(this.e.setAttribute("aria-activedescendant",this.b.id),this.e.setAttribute("aria-owns",String.format("{0} {1}",this.b.id,this.d.id)))},h:function(){var n,t;this.l()?(n="",_Ewa.b.B(this.e,"aria-activedescendant")&&(n=this.e.getAttribute("aria-activedescendant").toString()),t=n===this.b.id?this.d.id:this.b.id,this.e.setAttribute("aria-activedescendant",t)):Diag.a.b(22115014,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}};_Ewa.BL=function(n){_Ewa.BL.initializeBase(this);this.i=n;this.l()};_Ewa.BL.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.mh),315,new _Ewa.BL(n))};_Ewa.BL.prototype={i:null,a:function(){if(_Ewa.fR.b()){var n=this;_Ewa.c.a(this.i).k().a().p(function(){var t=n.i.a().a(_Ewa.mh,244,!1,null)||new _Ewa.fR(n.i,_Ewa.c.a(n.i).k().a().g());n.k(t)})}else this.k(null)}};_Ewa.cP=function(n){this.b=n||""};_Ewa.cP.i=function(){return _Ewa.cP.c||(_Ewa.cP.c=new _Ewa.cP(""))};_Ewa.cP.e=function(){return _Ewa.cP.f||(_Ewa.cP.f=_Ewa.cP.d(2).a())};_Ewa.cP.a=function(n){var t=Common.d.b(n||"");return new _Ewa.cP(t)};_Ewa.cP.b=function(n){return _Ewa.cP.a(_Ewa.ClientStringManager.a().a(n))};_Ewa.cP.d=function(n){return new _Ewa.cP(_Ewa.ClientStringManager.a().b(n))};_Ewa.cP.h=function(n){for(var i=[],t=1;t<arguments.length;++t)i[t-1]=arguments[t];return _Ewa.cP.g.apply(null,[_Ewa.ClientStringManager.a().c(n)].concat(i))};_Ewa.cP.g=function(n){for(var u,f,t,r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];for(u=r.length,f=new Array(u),t=0;t<u;t++)f[t]=(r[t]||_Ewa.cP.i()).a();return new _Ewa.cP(String.format.apply(null,[n].concat(f)))};_Ewa.cP.prototype={b:null,a:function(){return this.b}};_Ewa.bw=function(){};_Ewa.bw.a=function(n,t){!t||!t.length||(n.append(t),n.append(_Ewa.cP.e()))};_Ewa.SelectionReadoutHandler=function(n,t,i,r,u){this.f=Function.createDelegate(this,this.G);this.n=Function.createDelegate(this,this.F);this.p=Function.createDelegate(this,this.E);this.d=t;this.k=n;this.m=r;this.h=i;this.e=new _Ewa.SelectionReadoutHandler.c;this.l=_Ewa.fR.b();this.l&&(this.i=_Ewa.a.g()?u:t.a().a(_Ewa.mh,244,!1,null),Diag.a.b(21866445,0,!!this.i,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),_Ewa.SelectionReadoutHandler.b=700);this.j=_Ewa.B.a().a(this.p,_Ewa.SelectionReadoutHandler.b,_Ewa.o.cx,!1,!1);this.H()};_Ewa.SelectionReadoutHandler.d=function(n,t){return String.format(_Ewa.ClientStringManager.a().c(t),_Ewa.SelectionReadoutHandler.a(n.G,n.u,n.k),n.u)};_Ewa.SelectionReadoutHandler.g=function(n){var t=n.bq();return _Ewa.ClientStringManager.a().a(t?796:797)};_Ewa.SelectionReadoutHandler.a=function(n,t,i){return n&&n.length||t&&t.length?n:i};_Ewa.SelectionReadoutHandler.f=function(n){var u=n.b().a(),i=u.a(),t=i.e,f=t.ChartTitle,e=i.G,r=i.u,o=!!(t.Attributes&4),s=u.bP();return s?s:t.DataRangeForDisplay?String.format(_Ewa.ClientStringManager.a().c(o?48:46),_Ewa.SelectionReadoutHandler.a(e,r,i.k),r,f,_Ewa.ClientStringManager.a().a(_Ewa.uf.a(t.ChartCategory)),t.DataRangeForDisplay):String.format(_Ewa.ClientStringManager.a().c(o?49:47),_Ewa.SelectionReadoutHandler.a(e,r,i.k),r,f,_Ewa.ClientStringManager.a().a(_Ewa.uf.a(t.ChartCategory)))};_Ewa.SelectionReadoutHandler.j=function(n){return _Ewa.a.b(104)&&(n.bk()||n.bj())};_Ewa.SelectionReadoutHandler.e=function(n,t){var r;if(!t.Z()){Diag.a.b(41165275,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");return}if(t.bk())r=t.Z().e().toString(),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(26),r));else if(t.bj()){var i=t.Z().z(),u=(i.LastColumn-i.FirstColumn+1).toString(),f=(i.LastRow-i.FirstRow+1).toString();_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(27),u,f))}};_Ewa.SelectionReadoutHandler.i=function(n,t,i){if(n.n()||!_Ewa.a.b(142))return!1;var r=i.a().a(_Ewa.dW,271,!1,null);return r?r.F(t):!1};_Ewa.SelectionReadoutHandler.h=function(n){return n.a===n.c&&n.b+1===n.d||n.a+1===n.c&&n.b===n.d};_Ewa.SelectionReadoutHandler.prototype={d:null,k:null,m:null,h:null,i:null,l:!1,j:null,g:null,s:function(){return _Ewa.c.a(this.d).g(null)},e:null,dispose:function(){this.d&&this.I();System.a.a(this.j);this.j=null;this.d=null;this.m=null},c:function(n,t,i){var a,r,f,e,g,o,nt,s,u,it,y,ut,p,ft,et,w,h,c,b,k,l,d;if(!n)return"";a=this.d.a();r=new Sys.StringBuilder;this.y(r,n,t);_Ewa.a.a("OfficeVSO:4124702_ColumnHeaderReadout")&&(f=this.h.d(n.b()),f&&f.bi&&this.q(r,f),e=this.h.b(n.b()),e&&e.q&&this.q(r,e));g=n.j()?this.u(n):n.c();_Ewa.bw.a(r,g);o=this.d.F();this.e.c!==o&&(_Ewa.bw.a(r,o),this.e.c=o);nt=t.length===1?_Ewa.h.h(t).o()?"":_Ewa.ClientStringManager.a().a(810):String.format(_Ewa.ClientStringManager.a().c(30),t.length);_Ewa.bw.a(r,nt);for(var tt=t,ot=tt.length,v=0;v<ot;++v)s=tt[v],_Ewa.bw.a(r,_Ewa.dY.b(s)),_Ewa.a.a("OfficeVSO:4823595_LastSelectedCellInRangeReadoutV2")&&t.length===1&&_Ewa.SelectionReadoutHandler.h(s)&&(u=_Ewa.c.a(this.d).b().e(s.m(),!1),isNullOrUndefined(u)||_Ewa.f.a(u.e())||(it=u.bw()?this.t(u,u.e(),!0):u.e(),_Ewa.bw.a(r,it)));var rt=n.a(),st=rt.bG(),ht=rt.bo(),ct=this.C(st,ht);return _Ewa.bw.a(r,ct),this.x(r,n),i&&(n.I()?_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(798)):n.F()&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(799))),(n.v()||n.U())&&(this.z(r,n.v()?n.a().bm():n.a().cH()),i&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(801))),_Ewa.eD.c(this.d,n.b())&&_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(805)),this.w(r,n),y=a.a(_Ewa.hr,14,!1,null),ut=y?y.c():"",_Ewa.bw.a(r,ut),n.n()&&(p=_Ewa.c.a(this.d).b().e(n.b(),!1),ft=!!p&&p.Y(),_Ewa.SelectionReadoutHandler.j(n,this.d)?_Ewa.SelectionReadoutHandler.e(r,n):_Ewa.a.a("OfficeVSO:3286994_NarratorForFormulaErrors")&&ft?_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(803)):_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(802))),n.S()&&(_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(804)),n.T()&&_Ewa.bw.a(r,String.format(_Ewa.ClientStringManager.a().c(16),n.bC())),et=n.bi(),_Ewa.bw.a(r,et)),n.V()&&(w=this.d.a().a(_Ewa.dW,271,!1,null),h="",w&&n.a().bd()&&(c=w.b(n.a().bd()),c&&c.DomainId.Id!==268435712&&(h=c.Name)),n.a().co()?(_Ewa.bw.a(r,String.format(_Ewa.ClientStringManager.a().c(133),h)),_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(1696))):(_Ewa.bw.a(r,String.format(_Ewa.ClientStringManager.a().c(131),h)),_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(1695)))),this.D(n)&&_Ewa.bw.a(r,_Ewa.SelectionReadoutHandler.g(n)),b=a.a(_Ewa.pH,231,!1,null),b&&_Ewa.bw.a(r,b.a(t,!0)),t.length===1&&t[0].o()&&_Ewa.SelectionReadoutHandler.i(n,t[0],this.d)&&(k=this.d.a().a(_Ewa.dW,271,!1,null),k&&_Ewa.bw.a(r,k.C())),n.bQ()&&!_Ewa.f.a(n.bp())&&_Ewa.bw.a(r,n.bp()),l=n.a().ca(),!l||!l.length||_Ewa.bw.a(r,l),_Ewa.a.a("OfficeVSO:5463515_PhoneticSlice1")&&n.X()&&n.bo()&&(d=n.bN(),d&&(_Ewa.bw.a(r,_Ewa.ClientStringManager.a().a(1853)),_Ewa.bw.a(r,d))),r.toString()},a:function(n){this.g=this.e;var t;this.e=(t=new _Ewa.SelectionReadoutHandler.c,t.c=this.g.c,t.d=n?this.g.d:!1,t.a=n?this.g.a:"",t.b=n?this.g.b:-1,t)},b:function(){this.g&&(this.e=this.g,this.g=null)},C:function(n,t){return n===2||t===2?_Ewa.ClientStringManager.a().a(831):n===1||t===1?_Ewa.ClientStringManager.a().a(832):""},u:function(n){if(!_Ewa.a.a("OfficeVSO:4823595_LastSelectedCellInRangeReadoutV2")){var t=n.a().w();return n.a().u()?String.format(_Ewa.ClientStringManager.a().c(14),n.c(),t):String.format(_Ewa.ClientStringManager.a().c(13),n.c(),_Ewa.dY.f(t))}return this.t(n.a(),n.c(),n.j())},G:function(){_Ewa.c.a(this.d).m()||this.j.b(-1)},y:function(n,t,i){var r,u,f,e;if(i&&i.length===1&&i[0].o()){if(r="",u=this.h.d(t.b()),u){r=u.t;this.o(n,r);this.r(n,!0,r,u.V?_Ewa.ClientStringManager.a().a(793):"");_Ewa.bw.a(n,this.h.s(u,t.b())?_Ewa.ClientStringManager.a().a(795):"");_Ewa.bw.a(n,this.h.r(u,t.b())?_Ewa.ClientStringManager.a().a(794):"");return}if(f=this.h.b(t.b()),f){e=_Ewa.c.a(this.d).e().a(t.b(),!1);r=e?e.N:"";this.o(n,r);this.r(n,!1,r,"");_Ewa.bw.a(n,this.h.g(f,t.b())?_Ewa.ClientStringManager.a().a(794):"");return}this.o(n,r);this.e.a="";this.e.b=-1}},o:function(n,t){t===this.e.a||_Ewa.f.a(this.e.a)||(n.append(_Ewa.ClientStringManager.a().a(this.e.d?792:791)),_Ewa.bw.a(n," "+this.e.a))},r:function(n,t,i,r){i!==this.e.a&&(n.append(_Ewa.ClientStringManager.a().a(t?790:789)),_Ewa.bw.a(n," "+i),_Ewa.bw.a(n,r),this.e.a=i,this.e.d=t,this.e.b=-1)},q:function(n,t){var i=_Ewa.c.a(this.d).a().a().a(),u,r,f;i.a!==t.a&&i.b!==this.e.b&&(n.append(_Ewa.ClientStringManager.a().a(794)),u=new _Ewa.p(t.a,i.b,t.a,i.b,!0,!0),_Ewa.bw.a(n,_Ewa.dY.b(u)),r=_Ewa.c.a(this.d).g(u),r&&(f=r.j()?this.u(r):r.c(),_Ewa.bw.a(n,f)),this.e.b=i.b)},t:function(n,t){var i=n.w();return n.u()?String.format(_Ewa.ClientStringManager.a().c(14),t,i):String.format(_Ewa.ClientStringManager.a().c(13),t,_Ewa.dY.f(i))},H:function(){var n,t;Diag.a.b(19265428,0,!!this.d,"Can't register to ewaControl's events");this.d&&(n=_Ewa.c.a(this.d),Diag.a.b(19265429,0,!!n,"Can't register to grid's events"),n&&(n.f().d(this.n),n.b().d(this.f),n.M(this.f),t=n.a(),Diag.a.b(19265430,0,!!t,"Can't register to selectionManager's events"),t&&(t.g(this.f),t.e(this.f),t.b().g(this.f))))},I:function(){var n,t;this.d&&(n=_Ewa.c.a(this.d),n&&(n.f().c(this.n),n.b().f(this.f),n.N(this.f),t=n.a(),t&&(t.k(this.f),t.i(this.f),t.b().i(this.f))))},E:function(){if(!_Ewa.c.a(this.d).a().b().q()){var n,t,i,r=(i=this.A(t={val:n}),n=t.val,i);this.v(r,n)}},v:function(n,t){this.l&&this.i&&this.i.l()?this.i.a(n):(_Ewa.a.a("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.k.b(!0),this.k.a(n),this.k.k(t))},F:function(){var n=this.s(),t;_Ewa.a.a("OfficeVSO:5300772_FixA11yReadEditingOnStartEdit")&&(t="Editing",this.v(t,n));_Ewa.a.a("OfficeVSO:5190952_removePhoneticErrorDialog2")||n&&n.bG()&&!_Ewa.c.a(this.d).dk()||this.j.a()},A:function(n){var t,r,o,s,u,h,c;if(n.val=null,t=_Ewa.c.a(this.d).a(),t.c()!==1&&!t.b().a())return Diag.a.a(40632717,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",t.c()),"";switch(t.c()){case 2:return this.B(t);case 64:var i=t.b().a().a(),f="",e=t.b().a().i()||t.b().a().g();return e&&(r=e.firstChild,f=r?_Ewa.b.z(r):""),String.format(_Ewa.ClientStringManager.a().c(52),_Ewa.SelectionReadoutHandler.a(i.G,i.u,i.k),f,i.u);case 4:return o=t.b().a().a(),_Ewa.SelectionReadoutHandler.d(o,51);case 512:return s=t.b().a().a(),_Ewa.P.w(s.Q);case 8:return u=t.b().a().a(),h=u?u.k:"",String.format(_Ewa.ClientStringManager.a().c(50),h);case 1:return n.val=this.s(),c=t.a().b(),this.c(n.val,c,!0)}return""},B:function(n){var t=new Sys.StringBuilder,i,r;return t.append(_Ewa.SelectionReadoutHandler.f(n)),i=this.d.a().a(_Ewa.pH,231,!1,null),i&&(r=n.b().a().a(),_Ewa.bw.a(t,i.a(r,!1))),t.toString()},D:function(n){var t=n.bq(),i=!1;return this.e.e!==t&&(this.e.e=t,i=!0),i},x:function(n,t){var i,r,u;t.bg()&&(i=this.m.b(t),i?(r=_Ewa.ClientStringManager.a().a(_Ewa.Zf.a(i.t)),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(25),r)),u=String.format(_Ewa.ClientStringManager.a().c(24),_Ewa.dY.b(i.q)),_Ewa.bw.a(n,u)):(Diag.a.a(20821025,0,15,"No sparkline range was found on a cell with sparkline."),_Ewa.bw.a(n,String.format(_Ewa.ClientStringManager.a().c(25),""))))},z:function(n,t){switch(t){case 1:case 11:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(806));break;case 6:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(806));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(808));break;case 7:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(806));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(809));break;case 2:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(807));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(808));break;case 3:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(807));_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(809));break;default:_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(807))}},w:function(n,t){var i=this.d.a().a(_Ewa.df,65,!1,null),r=i?i.D(t.b()):null,u="",f=$$as(_Ewa.ld,r);r?u=!r.C()&&f&&f.Q()?String.format(_Ewa.ClientStringManager.a().c(29),f.R()):String.format(_Ewa.ClientStringManager.a().c(23),r.B()):i&&i.a()&&i.a().a()&&(u=String.format(_Ewa.ClientStringManager.a().c(28),i.a().c().B()));_Ewa.bw.a(n,u)}};_Ewa.SelectionReadoutHandler.c=function(){};_Ewa.SelectionReadoutHandler.c.prototype={c:null,e:!1,a:null,b:0,d:!1};_Ewa.BM=function(n){_Ewa.BM.initializeBase(this);this.i=n;this.l()};_Ewa.BM.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.mi),227,new _Ewa.BM(n))};_Ewa.BM.prototype={i:null,a:function(){var n=this.i.a(),r=_Ewa.l.b(_Ewa.cC,n,211,212,this.j,null),u=_Ewa.l.b(_Ewa.dA,n,66,134,this.j,null),f=_Ewa.l.b(_Ewa.mp,n,240,239,this.j,null),t=$$sc.a.a(_Ewa.mh,null),i;_Ewa.a.g()&&(t=_Ewa.l.b(_Ewa.mh,n,244,315,this.j,null));i=this;_Ewa.g.a(_Ewa.g.b([r,u,f,t],this.h(),3),function(){var e=n.a(_Ewa.mi,226,!1,null)||new _Ewa.SelectionReadoutHandler(r.a(),i.i,u.a(),f.a(),t.a());i.k(e)},this.i.g(),3,null,null)}};_Ewa.BN=function(n,t){this.a=t;this.b=n};_Ewa.BN.prototype={a:null,b:null,c:function(){var n=this.d();this.b.e(n,"assertive")},d:function(){var n=new Sys.StringBuilder;return this.a.k()&&_Ewa.bw.a(n,this.a.k().WorkbookFileName),_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(812)),_Ewa.bw.a(n,this.f()),_Ewa.bw.a(n,this.e()),_Ewa.bw.a(n,_Ewa.ClientStringManager.a().a(813)),n.toString()},f:function(){return this.a.j()?_Ewa.ClientStringManager.a().a(817):_Ewa.ClientStringManager.a().a(818)},e:function(){var i=this.g(),n=this.a.d().a(),r=i!==1?String.format(_Ewa.ClientStringManager.a().c(31),i):_Ewa.ClientStringManager.a().a(811),t=new Sys.StringBuilder(r);return n&&!_Ewa.f.a(n.b())&&(t.append(_Ewa.cP.e()),t.append(String.format(_Ewa.ClientStringManager.a().c(32),n.b()))),t.toString()},g:function(){for(var r,t=0,i=this.a.d().h(),u=i.length,n=0;n<u;++n)r=i[n],r.h()&&t++;return t}};_Ewa.Xp=function(n,t){this.a=Function.createDelegate(this,this.g);this.d=!1;this.b=t.Y();this.c=n;this.e=new _Ewa.BN(n,t);this.b&&this.b.br()?this.f():this.h()};_Ewa.Xp.prototype={b:null,e:null,c:null,d:!1,dispose:function(){this.i();this.b=null;this.c=null;this.d=!0},h:function(){if(!this.b){Diag.a.a(20235935,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events");return}this.b.B(this.a);this.b.b().d(this.a);this.b.M(this.a);var n=$$as(_Ewa.eC,this.b);n&&(n.f().d(this.a),n.a().g(this.a),n.a().e(this.a),n.a().b().g(this.a))},i:function(){if(this.b){this.b.b().f(this.a);this.b.N(this.a);var n=$$as(_Ewa.eC,this.b);n&&(n.f().c(this.a),n.a().k(this.a),n.a().i(this.a),n.a().b().i(this.a))}},g:function(){this.d||this.f()},f:function(){this.e.c();this.c.b(!0);_Ewa.a.a("OfficeVSO:5561276_AriaLiveNotifierPolite")&&this.c.j(!0);this.dispose()}};_Ewa.BO=function(n){_Ewa.BO.initializeBase(this);this.i=n;this.l()};_Ewa.BO.a=function(n){n.a().b(_Ewa.bkt.$$(Sys.IDisposable),229,new _Ewa.BO(n))};_Ewa.BO.prototype={i:null,a:function(){var u=this.i.a(),n=_Ewa.l.b(_Ewa.cC,u,211,212,this.j,null),t,i,r;this.i.bQ()?(t=_Ewa.l.a(_Ewa.db,this.i.a(),12,this.i.g(),this.j,null),i=this,_Ewa.g.a(_Ewa.g.b([n,t],this.i.g(),3),function(){var r=new _Ewa.Xn(n.a(),i.i,t.a());i.k(r)},this.i.g(),3,null,null)):(r=this,_Ewa.g.a(n,function(n){var t=new _Ewa.Xp(n.a(),r.i);r.k(t)},this.i.g(),3,null,null))}};_Ewa.BK.registerClass("_Ewa.BK",_Ewa.sY.$$(_Ewa.cC));_Ewa.Xn.registerClass("_Ewa.Xn",null,Sys.IDisposable);_Ewa.fR.registerClass("_Ewa.fR",null,_Ewa.mh,Sys.IDisposable);_Ewa.BL.registerClass("_Ewa.BL",_Ewa.sY.$$(_Ewa.mh));_Ewa.SelectionReadoutHandler.registerClass("_Ewa.SelectionReadoutHandler",null,_Ewa.mi,Sys.IDisposable);_Ewa.SelectionReadoutHandler.c.registerClass("_Ewa.SelectionReadoutHandler.c");_Ewa.BM.registerClass("_Ewa.BM",_Ewa.sY.$$(_Ewa.mi));_Ewa.Xp.registerClass("_Ewa.Xp",null,Sys.IDisposable);_Ewa.BO.registerClass("_Ewa.BO",_Ewa.sY.$$(Sys.IDisposable));_Ewa.fR.a=null;_Ewa.cP.c=null;_Ewa.cP.f=null;_Ewa.SelectionReadoutHandler.b=500;Type.registerNamespace("_Ewa");_Ewa.bnG=function(){};_Ewa.bnG.a=function(){_Ewa.m.a(function(n){_Ewa.BK.a(n);_Ewa.a.g()?_Ewa.BL.a(n):_Ewa.fR.c(n);_Ewa.BM.a(n);_Ewa.BO.a(n)})};_Ewa.bnG.a();Type.registerNamespace("_Ewa");_Ewa.bnU=function(n,t,i){_Ewa.bnU.initializeBase(this,[n,null]);this.a=t;this.e=i};_Ewa.bnU.prototype={a:null,e:!1,dispose:function(){this.a=null;this.l=null;this.o=null;_Ewa.bdU.prototype.dispose.call(this)},h:function(n){this.e=n;this.cx().setAttribute("aria-disabled",n.toString());_Ewa.b.i(this.cx(),"cui-disabled",n)},l:null,o:null};_Ewa.Ti=function(n,t){this.sheetName=n;this.newSheetIndex=t};_Ewa.Ti.prototype={sheetName:null,newSheetIndex:0};_Ewa.bof=function(){};_Ewa.kC=function(n,t,i,r){this.d=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.m);this.c=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.n);_Ewa.kC.initializeBase(this,[document.createElement("a"),t,r]);this.b=_Ewa.a.b(550)?"ewa-stb-insert-new-uir":"ewaboot-stb-insert-new";this.l=i.be(this.cx(),_Ewa.ClientStringManager.a().a(483),0,this.b,_Ewa.ClientStringManager.a().a(484),"CommonControlSliderPlus_12",r);n.appendChild(this.cx());var u=this;this.cE().a("contextmenu",function(n){_Ewa.M.a(n,!0)},!1);_Ewa.a.b(550)||(this.cE().a("mouseover",this.g,!1),this.cE().a("mouseout",this.g,!1));Common.j.a().a("click",this.cx(),this.c);this.i=Common.h.a().c(this.cx(),this.c,13,32);_Ewa.a.a("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(_Ewa.c.a(this.a).k().d(this.f),_Ewa.c.a(this.a).k().h(this.d))};_Ewa.kC.a=function(n){return!n.j()||!n.d().e()};_Ewa.kC.prototype={b:null,i:null,dispose:function(){Common.j.a().b("click",this.cx(),this.c);Common.h.a().d(this.cx(),this.i);_Ewa.a.a("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&_Ewa.c.a(this.a)&&_Ewa.c.a(this.a).k()&&(_Ewa.c.a(this.a).k().c(this.f),_Ewa.c.a(this.a).k().f(this.d));_Ewa.bnU.prototype.dispose.call(this)},h:function(n){var t=_Ewa.kC.a(this.a);_Ewa.bnU.prototype.h.call(this,n||t)},j:function(n){return this.e||this.a.v(-1935155518,n.b,30,null),!0},n:function(n){var t=n.type==="mouseover"||n.type==="focus",i=_Ewa.cO.a(this.a)?this.o:this.l;_Ewa.j.N(i,this.b,this.b+"-hover",t&&!_Ewa.c.a(this.a).F())},m:function(){this.h(!0)},k:function(){this.h(!1)}};_Ewa.Ys=function(n,t,i){this.c=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_Ewa.Ys.initializeBase(this,[document.createElement("a"),t,!1]);this.a=t;this.b=_Ewa.a.b(550)?"ewa-stb-insert-new-uir":"ewaboot-stb-insert-new";this.d=i.be(this.cx(),_Ewa.ClientStringManager.a().a(485),0,this.b,_Ewa.ClientStringManager.a().a(486),"CommonControlSliderPlus_12",!1);n.appendChild(this.cx());var r=this;this.cE().a("contextmenu",function(n){_Ewa.M.a(n,!0)},!1);this.cE().a("mouseover",this.f,!1);this.cE().a("mouseout",this.f,!1);Common.j.a().a("click",this.cx(),this.c);this.g=Common.h.a().c(this.cx(),this.c,13,32)};_Ewa.Ys.prototype={b:null,d:null,g:null,dispose:function(){Common.j.a().b("click",this.cx(),this.c);Common.h.a().d(this.cx(),this.g);this.d=null;_Ewa.bnU.prototype.dispose.call(this)},i:function(n){return this.a.v(-684145703,n.b,0,null),!0},j:function(n){var t=n.type==="mouseover"||n.type==="focus";_Ewa.j.N(this.d,this.b,this.b+"-hover",t&&!_Ewa.c.a(this.a).F())}};_Ewa.Yt=function(n,t,i){this.n=t;this.q=i;this.o=n;this.p=_Ewa.ClientStringManager.a().a(1861)};_Ewa.Yt.prototype={n:!1,q:!1,o:null,p:null,b:function(){return this.o.n()},j:function(){return this.o.bb()},f:function(){return this.n?"ewa-stb-lock-uir":this.b()?"ewa-stb-lock-active":"ewa-stb-lock"},c:function(){return"ProtectForm_16"},k:function(){return 13},l:function(){return 12},e:function(){return null},g:function(){return this.n?this.q?"ewa-stb-locked-sheet-svg":"ewa-stb-locked-sheet":null},m:function(){return null},a:function(){return null},i:function(){return 0},h:function(){return this.p},d:function(){return!0}};_Ewa.Yu=function(n,t,i){this.o=t;this.q=i;this.n=n;this.p=_Ewa.ClientStringManager.a().a(1862)};_Ewa.Yu.prototype={o:!1,q:!1,n:null,p:null,b:function(){return this.n.n()},j:function(){return this.n.be()},f:function(){return this.o?"ewa-stb-lock-uir":this.b()?"ewa-stb-lock-active":"ewa-stb-lock"},c:function(){return this.n.bb()?"ProtectForm_16":"Unlock_16"},k:function(){return 13},l:function(){return 12},e:function(){return null},g:function(){return this.o?this.q?"ewa-stb-locked-sheet-svg":"ewa-stb-locked-sheet":null},m:function(){return null},a:function(){return null},i:function(){return 0},h:function(){return this.p},d:function(){return!0}};_Ewa.Cj=function(n,t,i,r){this.n=n;this.p=_Ewa.ClientStringManager.a().a(1785);this.r=t;this.o=i;this.q=r};_Ewa.Cj.prototype={n:null,r:null,p:null,o:null,q:!1,b:function(){return this.n.n()},j:function(){return this.n.P.d()},e:function(){return this.q?this.b()?"ewa-stb-nsv-active-svg":"ewa-stb-nsv-inactive-svg":this.b()?"ewa-stb-nsv-active":"ewa-stb-nsv-inactive"},f:function(){return!this.b()&&this.o()?"ewamenu_namedSheetViewSheetTabWhite":"ewamenu_namedSheetViewSheetTabBlack"},c:function(){return!this.b()&&this.o()?"SheetViewWhite_16":"SheetView_16"},k:function(){return 14},l:function(){return 16},g:function(){return"ewa_nsv_margin"},m:function(){return this.n.P.g()},a:function(){return this.r},i:function(){return 8},h:function(){return this.p},d:function(){return!1}};_Ewa.nL=function(n,t){this.p=Function.createDelegate(this,this.v);this.q=Function.createDelegate(this,this.w);this.e=n;this.a=t;this.i=_Ewa.s.s(n)};_Ewa.nL.prototype={a:null,c:null,d:null,j:null,e:null,l:null,n:!1,g:null,f:null,h:null,i:!1,m:null,k:function(){return this.j||(this.j=_Ewa.bL.a().a(this.b))},s:function(){if(this.l)return this.l;var n=new($$sc.D.$$(Boolean)),t=this;return this.e.V(function(i){_Ewa.g.a(i.b(),function(){n.b(!0)},t.e.g(),3,null,null)}),this.l=n.a},b:null,z:function(){var r,t,n,i;this.b&&(this.c||this.d)&&(this.i?(r=this.a.c(),this.m!==r&&(this.d&&this.d.parentNode.removeChild(this.d),this.t(),this.m=r)):(t=this.a.f(),this.g!==t&&(this.o(this.c,this.g,t),this.g=t)),n=this.a.e(),this.f!==n&&(this.i?this.x(this.d,this.f,n):this.o(this.c,this.f,n),this.f=n),i=this.a.g(),this.h!==i&&(this.o(this.b,this.h,i),this.h=i),this.a.a()&&!this.a.b()&&this.r())},y:function(n,t,i){this.u(n,t,i);_Ewa.b.b(this.b,this.a.j(),!0)},r:function(){var n=this;_Ewa.g.a(this.s(),function(){dialogControls.clearToolTip(n.a.a())},this.e.g(),3,null,null)},u:function(n,t,i){if(this.b&&this.n!==n&&(this.b.parentNode.removeChild(this.b),this.b=null,this.g=null,this.m=null,this.f=null,this.h=null,this.a.a()&&(this.k().b("mouseover",!0),this.k().b("mouseout",!0))),!this.b){if(this.b=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.b,"cui-img-container"),Sys.UI.DomElement.addCssClass(this.b,"clip16x16"),_Ewa.a.b(550)?n===this.a.d()?t.appendChild(this.b):t.insertBefore(this.b,i):n?t.insertBefore(this.b,i):t.appendChild(this.b),this.i)this.t();else{this.c=document.createElement("img");this.c.tabIndex=-1;this.c.alt=this.a.h();this.b.appendChild(this.c);var r=this.a.i();this.c.src=_Ewa.y.a(r)}this.a.a()&&(this.k().a("mouseover",this.q,!0),this.k().a("mouseout",this.p,!0));this.n=n}},x:function(n,t,i){n&&(Sys.UI.DomElement.removeCssClass(n,t),Sys.UI.DomElement.addCssClass(n,i))},o:function(n,t,i){t&&Sys.UI.DomElement.removeCssClass(n,t);i&&Sys.UI.DomElement.addCssClass(n,i)},dispose:function(){System.a.a(this.j)},w:function(){if(this.a.b()){var n=this;_Ewa.g.a(this.s(),function(){dialogControls.renderToolTip(n.a.a(),"SheetIconTooltip",n.a.m(),n.b,10,!1,!1,1)},this.e.g(),3,null,null)}},v:function(){this.a.b()&&this.r()},t:function(){var n=this.e.a().a(_Ewa.hz,388,!1,null);if(!n){Diag.a.b(590918347,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.");return}this.d=n.b(this.a.c(),this.a.k(),this.a.l(),null,null);this.d?this.b.appendChild(this.d):Diag.a.b(590918346,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.a.c())}};_Ewa.Yw=function(n,t,i){this.d=Function.createDelegate(this,this.j);this.b=Function.createDelegate(this,this.g);this.c=Function.createDelegate(this,this.i);_Ewa.Yw.initializeBase(this,[document.createElement("a"),n,!0]);this.l=t.be(this.cx(),_Ewa.ClientStringManager.a().a(487),0,"ewa-stb-all-sheets",_Ewa.ClientStringManager.a().a(487),"Hamburger_12",this.e);Sys.UI.DomElement.addCssClass(this.cx(),"ewa-stb-dropdown-menu-button");i.appendChild(this.cx());this.a.b().l(this.c);this.k()};_Ewa.Yw.prototype={dispose:function(){this.m();_Ewa.bnU.prototype.dispose.call(this)},h:function(n){_Ewa.bnU.prototype.h.call(this,n||!this.a.b().bs())},f:function(n){this.e||(Diag.a.a(588310283,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",Common.m.a.toString(n)),this.a.i().a(new _Ewa.L(1243860697,n,this.a.p(),30,null),null,null))},i:function(){this.h(!1);this.a.b().q(this.c)},k:function(){Common.j.a().a("click",this.cx(),this.b);Common.h.a().a("keydown",this.cx(),this.d)},m:function(){Common.j.a().b("click",this.cx(),this.b);Common.h.a().b("keydown",this.cx(),this.d)},g:function(n){return this.f(n.b),!0},j:function(n){return n.a.keyCode===13||n.a.keyCode===32?(this.f(n.b),!0):!1}};_Ewa.Yv=function(n,t){this.b=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.o);_Ewa.Yv.initializeBase(this,[document.createElement("div"),null]);this.c=n;this.f=t;this.e=!1;this.d=0};_Ewa.Yv.prototype={c:null,f:null,e:!1,d:0,dispose:function(){this.j();_Ewa.bdU.prototype.dispose.call(this)},a:function(){this.i(!0,"TogglerSheetDropdownMenu")},i:function(n,t){Diag.a.a(588310285,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",t,n,this.d);n&&(this.d=this.d+1);var i=this.c.o().a("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",t,n,this.d,this.c.d().e())),f=this,r=function(){i.a()},u=this.l();appChrome.renderSheetDropdownMenu(this.cx(),this.f,u,this.d,this.h,this.g,r,_Ewa.cO.a(this.c))},l:function(){for(var t,u,i=this.c.d(),r=[],n=0;n<i.e();n++)t=$$as(_Ewa.J,i.g(n)),t.S||(u=this.k(t),r.push(u));return r},k:function(n){var t={};return t.key=n.N,t.text=n.N,t.onClick=this.m(n),n.n()&&(t.className=_Ewa.cO.a(this.c)?"ewa-active-sheet-menu-item-present-mode":"ewa-active-sheet-menu-item"),t},m:function(n){var t=this;return function(){var i=new _Ewa.L(-1876836819,0,t.c.p(),30,null);t.c.i().a(i,{SNTA:n.N},null)}},p:function(){Diag.a.a(588310284,0,50,"SheetDropdownMenu.OnSheetsChanges");this.i(!1,"OnSheetsChanged")},q:function(){if(!this.e){var n=this.c.d();n.c(this.b);n.x(this.b);n.k(this.b);n.l(this.b);n.p(this.b);n.I(this.b);n.r(this.b);this.e=!0}},j:function(){if(this.e){var n=this.c.d();n.d(this.b);n.A(this.b);n.n(this.b);n.o(this.b);n.s(this.b);n.O(this.b);n.B(this.b);this.e=!1}},o:function(){this.q()},n:function(){this.j()}};_Ewa.tc=function(n,t,i){var r,f,u;this.ca=Function.createDelegate(this,this.eA);this.cb=Function.createDelegate(this,this.eB);this.bb=Function.createDelegate(this,this.ed);this.bY=Function.createDelegate(this,this.ev);this.G=Function.createDelegate(this,this.ec);this.cC=Function.createDelegate(this,this.ek);this.bP=Function.createDelegate(this,this.ei);this.bM=Function.createDelegate(this,this.dZ);this.bQ=Function.createDelegate(this,this.dj);this.cA=Function.createDelegate(this,this.eh);this.cJ=Function.createDelegate(this,this.ew);this.bN=Function.createDelegate(this,this.ea);this.bZ=Function.createDelegate(this,this.dm);this.bO=Function.createDelegate(this,this.eg);this.bJ=Function.createDelegate(this,this.dW);this.bI=Function.createDelegate(this,this.dV);this.bH=Function.createDelegate(this,this.dU);this.bV=Function.createDelegate(this,this.eq);this.bX=Function.createDelegate(this,this.eu);this.bU=Function.createDelegate(this,this.ep);this.bT=Function.createDelegate(this,this.en);this.bS=Function.createDelegate(this,this.em);this.bR=Function.createDelegate(this,this.el);this.bL=Function.createDelegate(this,this.dY);this.bK=Function.createDelegate(this,this.dX);this.dy=_Ewa.ClientStringManager.a().a(690);this.dx=_Ewa.ClientStringManager.a().a(692);this.k=[];this.u=new Array(6);this.bA=new Array(6);this.Y=-1;this.br=-1;this.I=new _Ewa.Yz;_Ewa.tc.initializeBase(this,[t,null]);this.j=n;this.bm=this.j.b();this.n=_Ewa.s.C(this.j);this.V=this.n&&!_Ewa.a.a("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.r=_Ewa.a.b(550);this.K=_Ewa.s.s(this.j);this.bz=this.r;this.n&&(this.T=this.r&&!Common.c.h());this.cm=this.j.e().SheetTabNavigateButtonLongKeyPressPeriodMS;this.cl=this.j.e().SheetTabNavigateButtonIntervalPeriodMS;this.ch=this.j.e().SheetTabDragStartPixelThreshold;this.N=-1;this.M=-1;this.bd=!1;this.K&&(this.S=i);this.bx=new _Ewa.gV(this.cx(),3,null,!1);this.r&&this.cx().classList.add("ewa-stb-uir");this.dE();this.dC();this.dF();this.dH();this.dt(!0);this.dm(null,null);r=this.j.d();r.c(this.bK);r.x(this.bL);r.k(this.bR);r.l(this.bS);r.p(this.bT);r.I(this.bU);r.r(this.bX);r.S(this.bV);r.C(this.bH);r.F(this.bI);r.G(this.bJ);r.H(this.bO);this.j.B(this.bZ);this.j.S(this.bN);_Ewa.bj.a(this.j).a(this);this.j.a().b(_Ewa.dT,32,this);_Ewa.a.c("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&this.j.b().p(this.cJ);this.Z=this.cG.a(this.cx());this.Z.a("keydown",this.cA,!1);_Ewa.A.a(this.j).b()&&this.dj(null,new _Ewa.kw(!0,0));_Ewa.A.a(this.j).a().a(this.bQ);_Ewa.c.a(this.j).cr(this.bM);_Ewa.a.a("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(f=this,this.Z.a("mousedown",function(n){n.preventDefault()},!1));Common.G.a().a(Common.I.a(),this.cx(),this.bP);this.bo=this.cG.a(this.l);this.bo.a("scroll",this.cC,!1);u=this;this.cw=_Ewa.pc.a(function(){u.B()},200,this.j.g(),_Ewa.o.cE,!0,!1);this.j.bg("skeletonSheetBar",!0,"");this.bz&&(this.cc=new _Ewa.Yv(this.j,this.O.cx()));_Ewa.a.c("Microsoft.Office.Excel.PageloadMetrics",!1)&&_Ewa.V.a().v("sheetTabBar",["sheetTabBar"])};_Ewa.tc.a=function(n,t,i,r){n<i.val?(t>i.val&&i.val--,t>r.val&&r.val--):n>r.val?(t<i.val&&i.val++,t<r.val&&r.val++):t<i.val&&i.val++};_Ewa.tc.prototype={cw:null,n:!1,V:!1,r:!1,K:!1,bz:!1,S:null,cm:0,cl:0,j:null,bm:null,bx:null,l:null,bE:null,bp:null,R:null,bn:null,s:null,X:null,O:null,q:!1,m:0,t:0,bl:!1,bf:!1,Z:null,bo:null,N:0,M:0,bd:!1,F:0,ch:0,bB:0,bg:null,D:null,A:null,v:null,p:0,bj:0,ba:null,z:null,bk:0,E:0,H:function(){return this.cx()},bG:function(){return this.cF()},bq:function(){return"STB"},o:!1,y:null,b:function(n){return this.y=n,n},U:null,bv:null,f:function(){return this.bv},bw:null,g:function(){return this.bw},bc:null,T:!1,c:function(){return!!this.I&&this.I.d()},d:function(){return!!this.I&&this.I.e()},bt:null,bu:!1,ci:function(){return this.r?this.j.O()?["ewa-stb-last","ewa-stb-next-uir","ewa-stb-prev-uir","ewa-stb-first","ewa-stb-more","ewa-stb-more"]:["ewa-stb-first","ewa-stb-prev-uir","ewa-stb-next-uir","ewa-stb-last","ewa-stb-more","ewa-stb-more"]:this.j.O()?["ewa-stb-last","ewa-stb-next","ewa-stb-prev","ewa-stb-first","ewa-stb-more","ewa-stb-more"]:["ewa-stb-first","ewa-stb-prev","ewa-stb-next","ewa-stb-last","ewa-stb-more","ewa-stb-more"]},cj:function(){return this.j.O()?[null,"CommonControlChevronRight_12","CommonControlChevronLeft_12"]:[null,"CommonControlChevronLeft_12","CommonControlChevronRight_12"]},cU:function(){return this.j.O()?[null,"CommonControlChevronRightWhite_12","CommonControlChevronLeftWhite_12"]:[null,"CommonControlChevronLeftWhite_12","CommonControlChevronRightWhite_12"]},bh:function(){if(this.q){if(Common.c.j())return 0;if(Common.c.b())return-1*(this.l.scrollWidth-this.l.clientWidth);if(Common.c.h())return this.l.scrollWidth-this.l.clientWidth;Diag.a.a(594915794,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0},bi:function(){if(this.q){if(Common.c.j())return this.l.scrollWidth-this.l.clientWidth;if(Common.c.b()||Common.c.h())return 0;Diag.a.a(594915793,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.l.scrollWidth-this.l.clientWidth},cT:function(){return this.I?[this.s,this.X]:[this.s,this.X,this.O]},dQ:function(){var n;return(n=this.k).concat.call(n,this.O)},cc:null,e:function(){return this.cc},be:function(n,t,i,r,u,f,e){var h,s,o;return n.removeAttribute("Href"),n.setAttribute("role","button"),n.className="ewa-stb-navbutton",n.title=t,n.tabIndex=0,this.K&&f?h=this.S.a(f,12,12,n,24,24,null,null):(s=document.createElement("span"),s.className=this.r?"clip12x12":"clip16x16",s.classList.add("cui-img-container"),s.tabIndex=-1,n.appendChild(s),o=document.createElement("img"),o.src=_Ewa.y.a(i),o.className=r,o.alt=u,o.tabIndex=-1,s.appendChild(o),h=o),e&&n.classList.add("cui-disabled"),h},dispose:function(){var n,t,i;if(this.j&&(n=this.j.d(),n.d(this.bK),n.A(this.bL),n.n(this.bR),n.o(this.bS),n.s(this.bT),n.O(this.bU),n.B(this.bX),n.bc(this.bV),n.D(this.bH),n.L(this.bI),n.M(this.bJ),n.N(this.bO),this.j.C(this.bZ),this.j.T(this.bN),_Ewa.A.a(this.j)&&_Ewa.A.a(this.j).a().b(this.bQ),this.I&&_Ewa.c.a(this.j).cF(this.bM),Common.G.a().b(Common.I.a(),this.cx(),this.bP)),System.a.b(this.bA),this.bA=null,this.u)for(t=0;t<this.u.length;t++)i=_Ewa.b.Y(this.u[t],this.cx(),!1,"a"),i&&Common.m.e(i);System.a.a(this.bx);System.a.a(this.Z);System.a.a(this.bo);this.bx=null;this.s=null;this.X=null;this.Z=null;this.bo=null;this.j&&this.n&&this.w(!1);this.D=null;this.cr(null,"Dispose");this.bg=null;this.v=null;this.ba=null;this.ce();this.bm=null;this.j=null;this.u=null;this.l=null;this.bE=null;this.bp=null;this.R=null;_Ewa.bdU.prototype.dispose.call(this)},L:function(n,t){var i,f;if(!t){if(Diag.a.b(2472137,0,this.k.length>0,"There is no sheet tab button."),!this.k.length)return!1;i=null;for(var u=this.k,e=u.length,r=0;r<e;++r)if(f=u[r],i=f.bn(),i)break;if(!i)return Diag.a.b(18661726,0,!1,"There is no focusable tab element."),!1;_Ewa.b.c(i,!1)}return!t},eo:function(n){return _Ewa.b.e(this.H(),n)},cV:function(){},bW:function(){},a:function(n,t,i){var u,r;this.y&&this.y!==n&&(u=this.y.c(),this.ex(this.y,n,t),r=n?n.c()-1:t?this.j.d().e()-1:0,u!==r&&(this.dT(u,r,i),this.dL(this.y.a(),r)))},el:function(n,t){this.dk(t.a)},en:function(n,t){for(var r,u=this.j.d().a().c(),i=0,f=this.k.length;i<f;i++)if(r=this.x(i),r.c.innerText===t.b){r.bc(t.a);this.B();i===u&&this.C(6);break}},eq:function(n,t){var i=this.W(t.a);i&&i.H()},eu:function(n,t){t.b?(this.Q(!1),this.dl(t.a)):this.dk(t.a)},h:function(n){var t=this.J(n);return t!==-1&&this.m<=t&&t<=this.t?this.k[t].cx():null},i:function(n){var t,i,u,f,r;if(this.K){for(t=0;t<this.u.length;t++)i=this.u[t],i&&this.S&&(u=i.parentNode,this.dn(i),u&&(f=n?this.cU()[t]:this.cj()[t],this.u[t]=this.S.a(f,12,12,u,24,24,null,null)));for(r=0;r<this.k.length;r++)this.k[r].be(n);this.O&&this.O.l&&this.dz("HamburgerWhite_12",this.O,n);this.s&&this.s.l&&this.dz("CommonControlSliderPlusWhite_12",this.s,n)}},dz:function(n,t,i){t.o||(t.o=this.S.a(n,12,12,t.l.parentNode,24,24,null,null));t.o&&(_Ewa.b.b(t.l,!i,!0),_Ewa.b.b(t.o,i,!0))},et:function(n,t){var i=_Ewa.c.a(this.j),f=i.m(),r=i.F();f&&!r&&_Ewa.c.a(this.j).ca(!0,"SheetTabBar.OnSheetTabMouseDown");var e=t.a,o=t.b===2&&!e.button,u=this.T&&t.b===3;!(o||u)||r||this.o||_Ewa.A.a(this.j).b()||(u&&n.by(),this.Y=t.get_clientPoint().x,this.z=t,this.dB(n,t.get_clientPoint().x))},er:function(n){!this.n&&this.o&&this.ct(n.b,!1)},es:function(n){this.n||(this.o&&this.a(n.b,!1,!0),this.w(!0));this.B()},cQ:function(){return this.j.j()&&!(this.j.w()&16384)},B:function(){var n=this,t=_Ewa.j.m(function(){n.eG();n.r&&n.eC();n.cs(!1)});Diag.a.a(51446688,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",t)},eC:function(){var n=!this.m,t=this.t===this.k.length-1;_Ewa.b.i(this.R,this.j.O()?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!n);_Ewa.b.i(this.R,this.j.O()?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!t)},cs:function(n){var t=!this.m,i=this.t===this.k.length-1;this.dv(4,this.dy,!t);this.dv(5,this.dx,!i);this.bD(0,t||n);this.bD(1,t||n);this.bD(2,i||n);this.bD(3,i||n)},dv:function(n,t,i){var r=this.u[n],u;r&&(_Ewa.b.b(r,i,!0),u=this.cX(r),u.title=r.nodeName==="img"?r.alt=this.k.length>0&&i?t:"":r.title=this.k.length>0&&i?t:"",u.tabIndex=i?0:-1)},cX:function(n){return this.K?n.parentNode:n.parentNode.parentNode},bD:function(n,t){var r=this.u[n],i;r&&((i=this.cX(r),isNullOrUndefined(i))||(!this.k.length||t?(i.classList.add("cui-disabled"),i.setAttribute("aria-disabled","true")):(i.classList.remove("cui-disabled"),i.setAttribute("aria-disabled","false"))))},Q:function(n){var i=this.j.O()?0:this.k.length-1,r=this.j.O()?this.k.length-1:0,t=this.cZ(i);(t&&(t.borderRightWidth=n?"1px":"0"),this.m!==this.t)&&(t=this.cZ(r),t&&(t.borderRightWidth="0"))},cL:function(n,t){this.k||(this.k=[]);t===-1?Array.add(this.k,n):Array.insert(this.k,t,n)},cS:function(n,t){var i=-1,u=null,r;t||(i=this.dR(n.W),i!==-1&&(u=this.P(i)));r=new _Ewa.gO(this.j,this.l,u,n,this,this.r,this.K);this.cL(r,i);_Ewa.b.b(r.cx(),!0,!0)},ct:function(n,t){var u=this.W(n),i,r,f;u&&(this.bt=n,this.bu=t,i=u.cx(),r=this.q?i.offsetLeft+(this.l.scrollWidth-this.l.clientWidth-this.l.scrollLeft):i.offsetLeft-this.l.scrollLeft,f=!this.q&&t||this.q&&!t,f&&(r+=i.offsetWidth),this.bn.style.left=r-4+"px",_Ewa.b.b(this.bn,!0,!0))},dc:function(){_Ewa.b.b(this.bn,!1,!0)},C:function(n){var t=this,i=_Ewa.j.m(function(){switch(n){case 0:t.bC(0);break;case 1:t.bC(t.m-1);break;case 2:t.bC(t.m+1);break;case 3:t.dq(t.k.length-1);break;case 4:t.m&&t.k.length>=1&&(t.cK(t.m-1),t.cq());break;case 5:t.t!==t.k.length-1&&t.k.length>=1&&(t.cK(t.t+1),t.cq());break;case 6:t.cq()}});this.V&&this.o&&this.bs();Diag.a.a(51446689,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",n,i)},cK:function(n){var t=this.x(n);t&&t.W(0,!1)},dP:function(n){var i,r,t,f,u;if(!n.S)for(i=this.j.d(),r=0,t=0,f=i.e();t<f;t++){if(u=$$as(_Ewa.J,i.g(t)),u===n)return r;u.S||r++}return-1},dN:function(n){for(var i,r=this.j.d(),t=n.c()+1,u=r.e();t<u;t++)if(i=$$as(_Ewa.J,r.g(t)),!i.S)return i;return null},J:function(n){for(var i,t=0;t<this.k.length;t++)if(i=this.x(t),i){if(i.b===n)return t}else Diag.a.a(592189569,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",t);return-1},W:function(n){var t=this.J(n);return this.x(t)},dT:function(n,t,i){var r={};r.a=this.j.e().UserSessionId;r.b=i;r.c=this.bf;r.d=n;r.e=t;r.f=this.j.d().e();_Ewa.H.a().a(2,r,i)},ex:function(n,t,i){var f=$$as(_Ewa.cr,this.j.d()),u,r;t?(r=t.c(),u=n.c()<r?r-1:r):u=i?f.e()-1:0;f.bZ(n,u,!0)},du:function(n){_Ewa.c.a(this.j).r().a(n)},dB:function(n){var t,i;this.bl||(t=this.cx().ownerDocument.body,this.n?(Common.f.a().a("msospPointerMove",document.documentElement,this.G),this.T&&(Common.l.a().a("touchmove",document.documentElement,this.G),Common.l.a().a("touchmove",this.cx(),this.bY))):(Common.f.a().a("msospPointerMove",t,this.G),Common.l.a().a("touchmove",t,this.G)),Common.f.a().a("msospPointerUp",document.documentElement,this.bb),Common.l.a().a("touchend",t,this.bb),this.bl=!0);this.y=n.b;this.bf=!1;this.n?(this.v=null,this.bg=n,this.D=n.cx(),this.cr(_Ewa.b.h(this.D),"BeginSheetTabButtonDrag")):(Diag.a.a(595100060,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),i="pointer",this.cx().classList.add("ewa-stb-drag"),this.cx().style.cursor="",this.du(i))},w:function(n){if(this.bl){this.du(null);var t=this.cx().ownerDocument.body;this.n?(Common.f.a().b("msospPointerMove",document.documentElement,this.G),this.T&&(Common.l.a().b("touchmove",document.documentElement,this.G),Common.l.a().b("touchmove",this.cx(),this.bY))):(Common.f.a().b("msospPointerMove",t,this.G),Common.l.a().b("touchmove",t,this.G));Common.f.a().b("msospPointerUp",document.documentElement,this.bb);Common.l.a().b("touchend",t,this.bb);this.o=this.bl=!1}this.bB=0;this.bf=!1;this.y=null;this.bt=null;this.n?(this.D&&(this.D.style.visibility="visible",this.D=null),this.bg=null,this.cr(null,"EndSheetTabButtonDrag"),this.v&&(this.v.parentNode&&this.v.parentNode.removeChild(this.v),this.v=null),this.ez(n)):(this.cx().classList.remove("ewa-stb-drag"),this.dc())},ez:function(n){this.cu(n);this.Y=-1;this.p=-1},dL:function(n,t){var i=this.j.c(),f=i?i.a():null,e=this,r=function(){return new _Ewa.Ti(n,t)},o=this,u=function(i,r,u){return _Ewa.YA.a(f,n,t,i,r,u,null,null)};_Ewa.a.d()?this.j.f().a(new _Ewa.t(557,0,u,64,r),null):this.j.f().a(new _Ewa.ba(557,0,u,0,r),null)},x:function(n){return n>=0&&n<this.k.length?this.k[n]:null},cY:function(n){var t=this.x(n);return t?t.b:null},P:function(n){var t=this.x(n);return t?t.cx():null},cZ:function(n){var t=this.P(n);return t?t.style:null},dR:function(n){for(var u=this.j.d(),i=n+1,t=-1,f=this.k?this.k.length:0,r;i<u.e();){if(r=$$as(_Ewa.J,u.g(i)),!r.S){for(t=0;t<f;t++)if(this.cY(t)===r)break;break}i++}return t===-1||t===f?-1:t},dk:function(n){var i=this.W(n),t,r;i&&(this.n&&this.o&&(Diag.a.a(594625671,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),_Ewa.a.a("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.w(!0)),this.l.removeChild(i.cx()),t=Array.indexOf(this.k,i),Array.removeAt(this.k,t),this.B(),r=!this.q&&t===this.k.length||this.q&&!t,r&&this.Q(!0),this.V&&this.o?n===this.y?(this.w(!0),this.C(6)):this.bs():this.C(6))},dl:function(n){var i=$$as(_Ewa.J,n),t;(this.n&&this.o&&(Diag.a.a(594625669,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),_Ewa.a.a("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.w(!0)),i.S)||(this.Q(!1),t=this.J(n),t===-1&&(Diag.a.a(592189568,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.cS(i,!1),t=this.J(n)),this.db(t,!0,!0))},ey:function(n,t){var r=this.W(n),i;r&&(this.n&&this.o&&!t&&(Diag.a.a(592740950,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),_Ewa.a.a("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.w(!0)),i=this.eE(n,r),!_Ewa.a.a("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.n&&i&&t&&i.bx())},eE:function(n,t){var i,r=Array.indexOf(this.k,t),f=this.dP($$as(_Ewa.J,n)),e,o,s;if(f===-1||r===-1)return null;if(e=r!==f||this.n,e){this.Q(!1);_Ewa.tc.a(r,f,o={val:this.m},s={val:this.t});this.m=o.val;this.t=s.val;t&&t.cx().parentNode===this.l&&(this.l.removeChild(t.cx()),Array.removeAt(this.k,r));var h=this.dN(n),u=this.J(h),c=this.P(u);i=new _Ewa.gO(this.j,this.l,c,$$as(_Ewa.J,n),this,this.r,this.K);this.cL(i,u);u=this.J(n);this.db(u,!1,!this.r)}else i=null;return i},dM:function(){for(var t,i,r=this.k?this.k.length:0,u=this.m,f=this.t,n=0;n<r;n++)t=this.x(n),i=n>=u,t&&(t.f.tabIndex=i&&n<=f?0:-1)},eF:function(){for(var t,i=this.k?this.k.length:0,n=0;n<i;n++)t=this.x(n),t&&t.H()},db:function(n,t,i){t&&n<=this.m&&this.m++;this.dM();this.Q(!0);this.B();this.V&&this.o?this.bs():i&&this.C(6)},dt:function(n){var i=this.j.O(),t;for((n||this.q!==i)&&(this.q=i,this.cx().classList.remove(this.q?"ewa-stb-ltr":"ewa-stb-rtl"),this.cx().classList.add(this.q?"ewa-stb-rtl":"ewa-stb-ltr"),this.cx().dir=this.q?"rtl":"ltr",this.eF()),n||this.Q(!0),t=0;t<this.u.length;t++)t&&t!==3&&(this.r&&(t===4||t===5)||this.dw(t))},dE:function(){var n=this.bE=document.createElement("div");n.className="ewa-stb-navarea";this.r&&n.classList.add("ewa-stb-navarea-dimensions");this.cx().appendChild(n);this.by(n,1,685,684);this.by(n,2,687,686);this.bz&&(this.O=new _Ewa.Yw(this.j,this,n));this.r||this.by(n,4,691,690)},dF:function(){var n=this.bp=document.createElement("div");n.className="ewa-stb-navareaextra";this.cx().appendChild(n);this.r||this.by(n,5,693,692);this.cf()},dH:function(){var t=document.getElementById("SheetBarProgressBar"),u=document.getElementById("SheetBarProgressBarSeparator"),i,n,f,r,e;t&&!u&&Diag.a.a(576239773,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",t.parentNode.id,!!t.firstChild,!!document.getElementById("SheetBarProgressBarMessage"));_Ewa.s.F(this.j)&&t&&u?(this.cx().appendChild(t),this.bv=t.firstChild,this.bw=document.getElementById("SheetBarProgressBarMessage"),u.style.visibility="visible"):(i=document.createElement("div"),n=document.createElement("div"),i.className="ewa-stb-progressbar-outer-container-flex",n.className="ewa-stb-progressbar-inner-container-flex",n.style.display="none",f=document.createElement("div"),f.className="ewa-stb-progressbar-separator",r=document.createElement("div"),r.className="ewa-stb-progressbar-message",e=document.createElement("div"),e.className="ewa-stb-progressbar",n.appendChild(f),n.appendChild(r),n.appendChild(e),i.appendChild(n),this.cx().appendChild(i),this.bv=n,this.bw=r)},dw:function(n){var t=this.u[n],i,r;t&&(this.K?(i=t.parentNode,this.dn(t),r=_Ewa.cO.a(this.j)?this.cU()[n]:this.cj()[n],this.u[n]=this.S.a(r,12,12,i,24,24,null,null)):t.className=this.ci()[n])},dn:function(n){n&&n.parentNode&&n.parentNode.removeChild(n)},dC:function(){var n=this.R=document.createElement("div");n.className="ewa-stb-contentarea";this.cx().appendChild(n);this.dI(n)},dI:function(n){var t=document.createElement("div");t.className="ewa-stb-tabarea";t.classList.add("ewa-stb-disable-scrollbar");this.j.ba()||t.classList.add("ewr-grddisableprint");n.appendChild(t);this.l=document.createElement("ul");_Ewa.b.j(this.l,"tablist",null,null,null);this.l.className="ewa-stb-tabs";t.appendChild(this.l);this.dD();this.U=document.createElement("div");this.U.id="SheetIconTooltipContainer";t.appendChild(this.U)},dD:function(){var n=document.createElement("div"),t=_Ewa.y.j("ewaboot-stb-reorder-indicator",0,"55_16_N","");n.innerHTML=String.format("<div class='clip8x5'>{0}<\/div>",t);n.className="ewa-stb-sheettabmoveindicator";_Ewa.b.b(n,!1,!0);this.bn=n;this.l.appendChild(n)},cg:function(){for(var n,i=this.j.d(),t=0,r=i.e();t<r;t++)n=$$as(_Ewa.J,i.g(t)),n.S||(this.cS(n,!0),n.n()&&n.d(!1))},ce:function(){System.a.b(this.k);this.k=[];this.m=0;this.t=0},by:function(n,t,i,r){var u=document.createElement("a"),l,a,f,h,v,y,p,s,c;n.appendChild(u);l=this.cj()[t];this.u[t]=this.be(u,_Ewa.ClientStringManager.a().a(r),0,this.ci()[t],_Ewa.ClientStringManager.a().a(i),l,!1);(t===5||t===4)&&(a=_Ewa.b.Y(this.u[t],u,!1,"span"),a.style.marginTop="10px");this.dw(t);f=this.bA[t]=this.cG.a(u);h=this;Common.f.a().a("msospPointerDown",u,function(n){return n.i()&&h.eb(t)?!0:h.dg(t)});v=this;Common.f.a().a("msospPointerUp",u,function(){return v.dh()});y=this;Common.l.a().a("touchend",u,function(){return y.dh()});p=this;Common.f.a().a("msospPointerOut",u,function(){return p.cd()});s=this;Common.h.a().a("keydown",u,function(n){return(n.a.keyCode===13||n.a.keyCode===32)&&!s.bd?(s.bd=!0,s.dg(t)):!1});c=this;Common.h.a().a("keyup",u,function(n){return n.a.keyCode===13||n.a.keyCode===32?(c.bd=!1,c.cd()):!1});var w=this.cQ(),e=this,o=function(n){n.type==="mouseup"&&e.n&&e.o||_Ewa.M.a(n,!0);Sys.UI.DomElement.containsCssClass(u,"cui-disabled")||(w?e.ej(n,t):e.r||e.di(n,t))};f.a("mouseover",o,!1);f.a("mouseout",o,!1);f.a("focus",o,!1);f.a("blur",o,!1);w&&f.a("mouseup",o,!1)},dd:function(n){var t=!1,i=this.j.G();return i&&(t=Common.g.d(_Ewa.b.h(i),n.get_clientPoint())),t},df:function(n){return Common.g.d(_Ewa.b.h(this.cx()),n.get_clientPoint())||this.dd(n)},dO:function(n,t){var r=null,f=n.get_clientPoint(),i=this.m,u;if(this.df(n))for(i=this.m;i<=this.t;i++)if(r=this.x(i),r&&(u=_Ewa.b.h(r.cx()),!this.q&&f.x<u.x+u.width||this.q&&f.x>u.x))break;return t.val=i>this.t,r},ec:function(n){return this.o?(this.z=n,this.bs()):(this.z&&(this.bB+=this.z.get_clientPoint().x-n.get_clientPoint().x),this.z=n,Math.abs(this.bB)>=this.ch&&this.bs()),!0},ev:function(n){return n.a.preventDefault(),!1},bs:function(){var o,s,t,f,h,c,e;if(this.n){if(!this.v){if(Diag.a.a(595100061,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop."),this.v=this.D.cloneNode(!0),!this.dp(this.v,this.D,!0,"UpdateDragAndDropState"))return;this.D.style.visibility="hidden";this.v.classList.add("ewa-stb-tabs-ghost");this.v.style.borderRightWidth="";this.bj=this.z.get_clientPoint().x-this.A.width/2;this.v.style.left=this.bj+"px";this.p=this.J(this.y);this.p<0&&Diag.a.a(592189539,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.V&&(this.p=this.J(this.y));var i=_Ewa.b.h(this.l),r=i.x,u=i.x+i.width,n=this.z.get_clientPoint().x-this.A.width/2;n=Math.min(n,u-this.A.width);n=Math.max(n,r);o=Math.abs(n-this.bj);this.v.style.transform="translateX("+o*(this.bj<n?1:-1)+"px)";s=this.z.get_clientPoint().x>this.Y;t=this.z.get_clientPoint().x;n>=u-this.A.width?(t=u-this.A.width/2,this.cp()||this.E||(Diag.a.a(595100059,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.bk=this.l.scrollLeft,this.E=window.requestAnimationFrame(this.cb))):n<=r?(t=r+this.A.width/2,this.co()||this.E||(Diag.a.a(595100058,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.bk=this.l.scrollLeft,this.E=window.requestAnimationFrame(this.ca))):this.E&&(Diag.a.a(592189591,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.cu(!0));this.z.get_clientPoint().x!==this.Y&&(this.cv(s,t),this.Y=this.z.get_clientPoint().x)}else e=(c=this.dO(this.z,h={val:f}),f=h.val,c),e?this.ct(e.b,f):this.dc();this.o=!0;return},cv:function(n,t){for(var i,r,u;u=this.dK(t,n,r={val:i}),i=r.val,u;)this.ba=i,this.dA(n)},dA:function(n){var e,i,t,r,u,s,h,o,f,c;this.ba&&(e=(n?1:-1)*this.A.width,n&&!this.j.O()||!n&&this.j.O()?(i=this.D,t=this.p+1,r=!0):(u=this.x(this.p+1),i=u?u.cx():null,t=this.p-1,r=!1),s=this,h=function(n){return n?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",n.id,n.className,n.nodeName):null},this.dp(this.ba,i,r,"AnimateSheetSwap"))&&(Diag.a.a(592189590,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.p,t,this.k.length,n),this.p>=0&&this.p<this.k.length&&t>=0&&t<this.k.length?(o=this.k[t],this.k[t]=this.k[this.p],this.k[this.p]=o):(Diag.a.a(592189538,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.k.length,this.p,t),this.w(!0)),this.p=t,f=this.ba,f.style.transform="translateX("+e+"px)",c=this,window.requestAnimationFrame(function(){f.style.transform="translateX(0px)"}))},dp:function(n,t,i,r){var s=this,u=function(n){return n?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",n.id,n.className,n.nodeName):null},f,e;try{return this.l.insertBefore(n,t),!0}catch(o){return f=this.W(this.y),e=f?f!==this.bg?"Changed":"NoChange":"Removed",Diag.a.a(594871898,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",e,r,u(t),u(t.parentNode),u(this.l),i,this.p,this.k.length,o),this.w(!0),!1}},dK:function(n,t,i){var u,r;return(u=this.j.O()===t?this.x(this.p-1):this.x(this.p+1),!u)?(i.val=null,!1):(i.val=u.cx(),r=_Ewa.b.h(i.val),!this.A)?(Diag.a.a(592189589,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.w(!0),!1):t?n+this.A.width/2>=r.x+r.width*.5:n-this.A.width/2<=r.x+r.width*.5},eB:function(n){this.dr(n,!0)},eA:function(n){this.dr(n,!1)},dr:function(n,t){var r,o,i;if(r=t?this.cb:this.ca,this.br===-1){this.br=n;this.E=window.requestAnimationFrame(r);return}var s=n-this.br,u=Math.floor(s/1e3*300),f=this.bi()>this.bh()?1:-1,e;(e=t?this.bk+u*f:this.bk-u*f,o=Math.abs(this.l.scrollLeft-e),this.cn(o*(t?-1:1)),i=this.cW("ScrollStep"),i)&&(this.cv(t,i.x+i.width/2),(!t||this.cp())&&(t||this.co())?(Diag.a.a(592189588,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.cu(!0)):this.E=window.requestAnimationFrame(r))},cp:function(){var n=this.bi()>this.bh();return n&&this.F>=this.bi()||!n&&this.F<=this.bi()},co:function(){var n=this.bi()>this.bh();return n&&this.F<=this.bh()||!n&&this.F>=this.bh()},cu:function(n){this.l&&(this.F=this.l.scrollLeft);window.cancelAnimationFrame(this.E);this.E=0;this.br=-1;n&&this.B()},ed:function(n){var t,i;return this.o&&(this.n||this.df(n))&&(this.bf=this.dd(n),this.n?(t=(i=this.x(this.p+1))?i.b:null,this.a(t,this.p+1===this.k.length,!0)):(t=this.bu?null:this.bt,this.a(t,this.bu,!0))),this.w(!0),!0},cr:function(n,t){n||Diag.a.a(592189587,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",t);this.A=n},eb:function(n){return n===2?(this.C(3),!0):n===1?(this.C(0),!0):!1},dg:function(n){Diag.a.b(50385695,0,this.N===-1&&this.M===-1,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");this.N!==-1&&(window.clearTimeout(this.N),this.N=-1);this.M!==-1&&(window.clearInterval(this.M),this.M=-1);this.C(n);var t=this;return this.N=window.setTimeout(function(){t.eD(n)},this.cm),!0},eD:function(n){var t=this;this.M=window.setInterval(function(){t.C(n)},this.cl)},dh:function(){return this.cd(),!this.n||!this.o},cd:function(){return window.clearTimeout(this.N),window.clearInterval(this.M),this.N=-1,this.M=-1,!0},di:function(n,t){var i=this.ci()[t],r=n.type==="mouseover"||n.type==="focus";_Ewa.j.N(this.u[t],i,i+"-hover",r)},ej:function(n,t){var r=this.dS(t),i=t===5,u;n.type==="mouseup"?(i||t===4)&&(r||this.a(null,i,!1),this.w(!0)):!this.n&&this.o?(r||(u=this.cY(i?this.t:this.m),this.ct(u,i)),this.C(i?2:1)):this.r||this.di(n,t)},dS:function(n){var t=_Ewa.b.Z(this.u[n],"a",!1);return!!t.title},dX:function(n,t){t.b&&this.cy(t.b);this.dt(!1);this.B();t.a&&(this.cy(t.a),this.C(6),this.bm.M())},bF:function(n){this.cy(n);this.B()},dU:function(n,t){this.bF(t.a)},dV:function(n,t){this.bF(t.a)},dW:function(n,t){this.bF(t.a)},eg:function(n,t){this.bF(t.a)},cy:function(n){var t=this.W(n);t&&t.H()},dY:function(){this.ce()},cq:function(){var t=this.j.d(),n,i;if(t.a()&&(!_Ewa.bm.b(this.j)||t.e())){if(n=this.J(t.a()),n===-1){Diag.a.a(36766555,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");return}i=this.P(n);n<this.m?this.bC(n):n>this.m&&!this.ck(i)&&this.dq(n)}},eG:function(){var t,n,i,u,r;for(this.m=0,this.t=this.k.length-1,t=!1,n=0;n<this.k.length;n++){if(i=this.x(n),!i)break;if(u=i.cx(),r=this.ck(u),i.f.tabIndex=r?0:-1,!t&&r)this.m=n,t=!0;else if(t&&!r){this.t=n-1;break}}},bC:function(n){var r=this.j.d(),t,i;r.e()&&(this.k.length||this.cg(),t=Math.max(0,Math.min(n,this.k.length-1)),i=this.P(t),this.ds(i),this.B())},dq:function(n){var f,i,r,o,u,s;if(Diag.a.b(51446690,0,n>=this.m,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!"),f=this.j.d(),f.e()){this.k.length||this.cg();var h=Math.max(0,Math.min(n,this.k.length-1)),e=this.P(h),t=this.P(this.m);if(!this.ck(e)){for(i=_Ewa.b.h(e),r=_Ewa.b.h(this.R),o=this.q?r.x-i.x:i.x+i.width-(r.x+r.width),u=0;t&&u<o;)s=_Ewa.b.h(t),u+=s.width,t=t.nextSibling;t?this.ds(t):Diag.a.a(50345676,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.m,this.t,n)}this.B()}},ds:function(n){var t=_Ewa.b.h(this.l),i=_Ewa.b.h(n),r;this.q?(r=Math.floor(t.x+t.width-(i.x+i.width+.5)),this.cn(r)):this.cn(Math.ceil(t.x-i.x-.5))},cn:function(n){(n<0&&this.cp()||n>0&&this.co())&&Diag.a.a(594915792,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var t=this.l.scrollLeft;if(this.q){if(Common.c.j()||Common.c.b()){this.l.scrollLeft=this.F=t-n;return}if(Common.c.i()||Common.c.l()){this.l.scrollLeft=this.F=t+n;return}Diag.a.a(594915791,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.l.scrollLeft=this.F=t-n},ck:function(n){var t=_Ewa.b.h(n),i=_Ewa.b.h(this.R);return!t||!i?(Diag.a.a(50345677,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1):t.x>=i.x-1&&t.x+t.width<=i.x+i.width+1},dG:function(){var t=this.j.d(),n=this.bp;_Ewa.kC.a(this.j)?this.r?(System.a.a(this.s),this.s=new _Ewa.kC(n,this.j,this,!0)):(System.a.a(this.s),this.s=null):(!this.s||this.r)&&(System.a.a(this.s),this.s=this.j.w()&16384?new _Ewa.Cm(n,this.j,this):new _Ewa.kC(n,this.j,this,!1))},cR:function(n,t){var r=this.j.d(),i;if(this.j.j()&&r.e()){if(!t.val)if(i=this.r?this.bE:this.bp,this.j.w()&16384)t.val=new _Ewa.Cm(i,this.j,this);else switch(n){case 0:t.val=new _Ewa.kC(i,this.j,this,!1);break;case 1:t.val=new _Ewa.Ys(i,this.j,this);break;default:Diag.a.a(50954334,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}}else System.a.a(t.val),t.val=null},dm:function(){this.cB(!this.bm.b());this.ce();this.cg();_Ewa.a.c("Microsoft.Office.Excel.PageloadMetrics",!1)&&(_Ewa.bm.d(this.j)||_Ewa.bm.b(this.j))&&(_Ewa.V.a().l("sheetTabBar",["sheetTabBar"]),_Ewa.V.a().k("sheetTabBar",["sheetTabBar"]));this.cf();this.B();this.Q(!0);this.C(6)},ea:function(){this.cF()&&(this.B(),this.C(6))},ew:function(){var i;_Ewa.kC.isInstanceOfType(this.s)===!!(this.j.w()&16384)&&this.cf();for(var t=this.k,r=t.length,n=0;n<r;++n)i=t[n],i.n=!(this.j.w()&16384)},cf:function(){var n,t;_Ewa.a.b(460)?(this.cR(0,n={val:this.s}),this.s=n.val,this.cR(1,t={val:this.X}),this.X=t.val):this.dG()},ep:function(n,t){this.ey(t.b,t.a)},em:function(n,t){this.dl(t.a)},eh:function(n){var i,r;switch(n.keyCode){case 9:var t=this.cx().querySelectorAll("input,button,select,submit,a,textarea"),u=_Ewa.b.n(t),f=_Ewa.b.u(t);_Ewa.b.F(n,u,f);break;case 39:case 37:i=this.cx().querySelectorAll("input,button,select,submit,a,textarea");r=n.keyCode===39?!this.q:this.q;_Ewa.b.bq(n,i,r)}Diag.a.a(579655310,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",n.keyCode)},ek:function(){this.l.scrollLeft!==this.F&&this.cw()},ei:function(n){if(n.i()||n.q())return!1;if(this.l.scrollLeft+=Math.floor(n.f*30),this.n&&this.o){var t=this.cW("OnMouseWheel");t&&this.cv(n.f>0,t.x+t.width/2)}return!0},cW:function(n){var t=_Ewa.b.h(this.v);return t||(Diag.a.a(592740949,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",n),this.w(!0)),t},dj:function(n,t){var r,f;if(this.I){this.da("PartialInteractivity",t.a?3:0);return}this.w(!1);this.cs(t.a);for(var e=this.cT(),s=e.length,i=0;i<s;++i)r=e[i],r&&r.h(t.a);for(var o=this.k,h=o.length,u=0;u<h;++u)f=o[u],f&&f.h(t.a)},dZ:function(n,t){var i=0;t.a&&(i=2|(t.b?1:0));this.da("ComponentRangePicker",i)},da:function(n,t){var r,f;this.I.c(n,t);this.w(!1);this.cs(this.c());for(var e=this.dQ(),s=e.length,i=0;i<s;++i)r=e[i],r&&r.h(this.c());for(var o=this.cT(),h=o.length,u=0;u<h;++u)f=o[u],f&&f.h(this.d())}};_Ewa.gO=function(n,t,i,r,u,f,e){var s,h,o,c;this.U=Function.createDelegate(this,this.bt);this.V=Function.createDelegate(this,this.bu);this.O=Function.createDelegate(this,this.bz);this.r=Function.createDelegate(this,this.bw);this.M=Function.createDelegate(this,this.bs);this.L=Function.createDelegate(this,this.br);this.I=Function.createDelegate(this,this.bo);this.K=Function.createDelegate(this,this.bq);this.J=Function.createDelegate(this,this.bp);this.N=Function.createDelegate(this,this.bv);_Ewa.gO.initializeBase(this,[document.createElement("li"),n,!1]);this.A=new _Ewa.Yx(this,n);this.i=f;this.p=e;this.Q=_Ewa.s.v(n);this.v=_Ewa.a.a("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.p;this.i?(this.R=n.e().SheetDragReorderDelayInMilliseconds,this.S=n.e().SheetDragReorderDelayInMillisecondsForTouch,this.B=18,this.C=20):(this.B=19,this.C=22);this.a=n;this.b=r;this.g=u;this.n=u.cQ();this.bk();this.bj();this.u=n.o().b("UserAction",this.c.innerText);this.w=!1;_Ewa.b.j(this.cx(),"presentation",null,null,null);this.cx().appendChild(this.f);this.f.appendChild(this.d);this.k=new($$sc.v.$$(_Ewa.nL));s=new _Ewa.Yt(this.b,this.i,this.p);this.k.b(new _Ewa.nL(this.a,s));this.a.b().K()&&(h=new _Ewa.Yu(this.b,this.i,this.p),this.k.b(new _Ewa.nL(this.a,h)));this.v||(o=this,c=new _Ewa.Cj(this.b,this.g.U,function(){return o.j?_Ewa.gO.c(o.j):!1},this.p),this.q=new _Ewa.nL(this.a,c),this.k.b(this.q));this.y=this.g.T;this.H();this.bA();this.z=new _Ewa.gV(this.cx(),1,null,!1);t.insertBefore(this.cx(),i);_Ewa.cO.a(this.a)&&this.be(!0)};_Ewa.gO.b=function(n){var t=Common.H.b(n);return t||(Common.H.a(n,"true",365),t=Common.H.b(n)),t};_Ewa.gO.a=function(n,t){if(t>1||t<-1)return n;var i=n.c,r=n.b,u=n.a;return t>0?(i=i*(1-t)+t*255,r=r*(1-t)+t*255,u=u*(1-t)+t*255):(i=i*(1+t),r=r*(1+t),u=u*(1+t)),_Ewa.bv.b(Math.round(i),Math.round(r),Math.round(u))};_Ewa.gO.c=function(n){var t=(n.c*222+n.b*707+n.a*71)/1e3;return t<=128};_Ewa.gO.prototype={i:!1,p:!1,Q:!1,v:!1,n:!1,R:0,S:0,B:0,C:0,y:!1,D:.5,G:!1,F:!1,z:null,c:null,k:null,q:null,d:null,E:null,j:null,P:!1,g:null,x:!1,A:null,u:null,w:!1,t:"#BEBBB8",bl:function(){return this.E||(this.E=_Ewa.U.a("#F5F5F5",null))},bc:function(n){return this.c&&(this.c.innerText=n,this.bd(),this.bf()),n},b:null,f:null,bn:function(){return _Ewa.b.U(this.f)?this.f:null},dispose:function(){var n,t;if(this.F&&(Common.f.a().b("msospPointerDown",this.cx(),this.N),Common.h.a().b("keydown",this.cx(),this.J),Common.h.a().b("keypress",this.cx(),this.K),Common.j.a().b("click",this.cx(),this.I),Common.f.a().b("msospPointerEnter",this.cx(),this.L),Common.f.a().b("msospPointerLeave",this.cx(),this.M),(this.n||_Ewa.a.c("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))&&(Common.f.a().b("msospPointerUp",this.cx(),this.r),this.y&&(Common.l.a().b("touchend",this.cx(),this.r),Common.l.a().b("touchmove",this.cx(),this.O))),this.F=!1,this.t="#BEBBB8"),System.a.b([this.A,this.z]),this.A=null,this.z=null,this.g=null,this.f=null,this.d=null,this.c=null,this.k){for(n=this.k.$$lge();n.$$mn();)t=n.$$cu(),t.dispose();this.k=null}this.b=null;this.j=null;_Ewa.bnU.prototype.dispose.call(this)},h:function(n){n&&this.m(!1,!1,null);_Ewa.bnU.prototype.h.call(this,n)},T:function(n){if(_Ewa.Q.a().h()){this.Z();var t=_Ewa.l.b(_Ewa.kq,this.a.a(),322,323,1,null),i=this;_Ewa.g.a(t,function(t){Common.UISurfaces.b().then(function(i){var r=t.a();return r.b(i),r.c(n),null},function(n){return Diag.a.a(595194386,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",n),null})},this.de(),3,null,null)}},X:function(){var n,t,u,r;if(this.b.n()&&this.a.P())if(n=this.a.P(),this.b.P.d()){this.q||(t=this,u=new _Ewa.Cj(this.b,this.g.U,function(){return t.j?_Ewa.gO.c(t.j):!1},this.p),this.q=new _Ewa.nL(this.a,u),this.k.b(this.q));Sys.UI.DomElement.addCssClass(n,"ewr-namedsheetview");var e=_Ewa.gO.b("NamedSheetViewTeachingUICookie"),f=_Ewa.gO.b("NamedSheetViewTeachingUITempViewCookie"),i=_Ewa.gO.b("NamedSheetViewTeachingUIAutoOptInCookie"),o=this.b.P.i;this.b.P.i=!1;i==="true"&&o&&this.a.b().cA()?(Common.H.a("NamedSheetViewTeachingUIAutoOptInCookie","false",365),this.a.b().cX(!1),this.T(3)):e==="true"&&f==="true"&&i==="true"?this.a.b().cB()&&this.a.b().bR()&&(this.b.P.c()?(r=1,Common.H.a("NamedSheetViewTeachingUITempViewCookie","false",365),this.a.b().cd(!1)):r=0,Common.H.a("NamedSheetViewTeachingUICookie","false",365),this.a.b().cY(!1),this.T(r)):this.b.P.c()&&f==="true"&&i==="true"&&this.a.b().bR()&&(Common.H.a("NamedSheetViewTeachingUITempViewCookie","false",365),this.a.b().cd(!1),this.T(2))}else this.Z(),Sys.UI.DomElement.removeCssClass(n,"ewr-namedsheetview")},Z:function(){if(this.a.cM()){var n=_Ewa.l.b(_Ewa.kq,this.a.a(),322,323,0,null),t=this;_Ewa.g.a(n,function(n){var t=n.a();t.a()},this.a.g(),3,null,null)}},H:function(){this.bc(this.b.N);this.cx().className=this.b.n()||this.bb()?"tab-active":"tab-inactive";_Ewa.a.a("OfficeVSO:5262355_SheetTabFocusBugFix")?Sys.UI.DomElement.addCssClass(this.c.parentNode,"leave-size-fixed-on-tab-hover"):Sys.UI.DomElement.addCssClass(this.c.parentNode,"leave-size-fixed-on-tab-hover-old");this.bf();this.v&&this.X();this.bE();this.bg();this.bd();this.v||this.X()},by:function(){this.G=!0;this.m(!0,!0,"OnSheetReorderStarted")},bx:function(){this.G=!1;this.m(!1,!1,"OnSheetReorderEnded")},W:function(n,t){if(!this.Y()){this.b.d(!1);t&&_Ewa.c.a(this.a).q();var i=null;i=_Ewa.a.a("OfficeVSO:5347991_AddComponentNamesToReport")?{InputMethod:Common.m.a.toString(n),AppMode:this.a.p(),Location:Common.n.toString(30)}:{InputMethod:Common.m.a.toString(n),AppMode:this.a.p()};_Ewa.Z.a(this.a).a(_Ewa.w.bI,i,null,!1)}},be:function(n){this.t=n?"#797775":"#BEBBB8";this.D=n?-.5:.5;this.E=n?_Ewa.U.a("#3B3A39",null):_Ewa.U.a("#F5F5F5",null);this.bg()},bi:function(n){n.n();this.b.d(!1)},bh:function(n){var t=new _Ewa.L(-1876836819,n,this.a.p(),30,null);return this.a.i().a(t,{SNTA:this.b.N},null)},bf:function(){this.c.parentNode.setAttribute("sheet-title",this.c.innerText)},bd:function(){var t=this.bm(),n;this.f.setAttribute("aria-label",t);n=this.b.n().toString();this.f.setAttribute("aria-selected",n)},bm:function(){var n=this.b.P.d(),t=this.b.P.g(),i=this.b.bb(),r=this.b.be();return n&&i?String.format(_Ewa.ClientStringManager.a().c(20),this.c.innerText,t):n&&r?String.format(_Ewa.ClientStringManager.a().c(22),this.c.innerText,t):n?String.format(_Ewa.ClientStringManager.a().c(19),this.c.innerText,t):i?String.format(_Ewa.ClientStringManager.a().c(18),this.c.innerText):r?String.format(_Ewa.ClientStringManager.a().c(21),this.c.innerText):this.c.innerText},bp:function(n){return n.a.keyCode===13&&!this.e?(this.s(1),!0):!1},bq:function(n){return n.a.charCode===32&&!this.e?(this.s(1),!0):!1},bu:function(){this.e||(this.g.er(this),this.g.o||this.m(!0,!1,"OnMouseOver"))},bt:function(){this.e||this.m(!1,!1,"OnMouseOut")},br:function(){return this.g.o||(this.bF(),this.b.X||_Ewa.c.a(this.a).dP(this.b.N)),!1},bs:function(){return this.ba(!1),!1},bo:function(n){if(this.e)return!0;var t=_Ewa.c.a(this.a),i=!this.b.n()&&n.b===3;return i?(!(_Ewa.s.u(this.a)||this.Q)||t.m()||t.u()||t.di(),this.s(n.b)):this.i?this.s(n.b):_Ewa.s.t(this.a)&&t.q(),n.b!==3},bv:function(n){var r,u,t,f,i;return this.e?!0:(this.ba(!0),_Ewa.c.a(this.a).F()&&Diag.a.a(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula)."),u=n.b===2,t=n.b===3,(u||t&&this.y)&&(this.i?(this.m(!0,!t,"OnPointerDown"),f=this,r=$$sc.a.b(t?this.S:this.R).CWR(Boolean,function(){return!0})):r=this.s(n.b),this.n&&(this.x=!0,i=this,this.g.bc=_Ewa.g.a(r,function(){i.x&&i.g.et(i,n)},this.de(),11,null,null))),!1)},bw:function(n){var i,t;return this.e||!this.n&&_Ewa.a.c("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)?!0:(i=this.g.o&&!_Ewa.s.C(this.a),this.x=!1,this.i&&this.m(n.b===2,!1,"OnPointerUp"),this.g.bc&&(t=this,_Ewa.g.a(this.g.bc,function(){t.g.es(t)},this.de(),11,null,null),this.g.bc=null),i)},s:function(n){return _Ewa.s.t(this.a)?_Ewa.a.a("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Y()?$$sc.a.a(Boolean,!1):(_Ewa.cM.a().a("ActivateSheet"),this.b.d(!1),$$sc.a.a(Boolean,!0)):this.bh(n)},bg:function(){var n=this.b.Y;this.j=!n||!n.length?this.bl():_Ewa.U.a(n,null);this.P=_Ewa.gO.c(this.j);this.m(!1,!1,"UpdateTabColor")},m:function(n,t,i){var e,s;if(!this.b){Diag.a.a(592192463,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",i);return}var r=this.b.n(),u=this.bb(),f=!_Ewa.f.a(this.b.Y),o=_Ewa.U.b(r||u?_Ewa.bv.d():this.j);for(this.d.style.background="",r||u?(f?_Ewa.a.a("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.a.bt()?this.bD():this.i?this.bC():this.bB():this.i||(this.d.style.backgroundColor=o),this.d.style.height=this.B.toString()+"px"):(this.d.style.filter="",this.d.style.backgroundColor=o,this.d.style.height=this.C.toString()+"px"),this.c.className=r?"tab-active-text":u?"dark":this.P?"light":"dark",e=this.k.$$lge();e.$$mn();)s=e.$$cu(),s.z();this.i&&(n&&!f&&(this.d.style.backgroundColor="#E1DFDD"),_Ewa.b.i(this.cx(),"tab-hover",n),t?(f||(this.d.style.backgroundColor=this.t),this.cx().style.backgroundColor=this.t):(f||(this.d.style.backgroundColor=""),this.cx().style.backgroundColor=""));this.c.style.fontWeight=r||u||!this.i&&n?this.i?"600":"bold":""},bC:function(){var n=this.d.style,t=_Ewa.U.b(_Ewa.gO.a(this.j,this.D));n.background=t},bB:function(){var t=this.d.style,i=_Ewa.U.b(_Ewa.gO.a(this.j,1)),r=_Ewa.U.b(_Ewa.gO.a(this.j,this.D)),n="";if(Common.c.s())n="-webkit-";else if(Common.c.b())n="-moz-";else if(Common.c.a()){if(n="-ms-",!Common.c.z()){t.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",i,r);return}}else Common.c.bl()&&(n="-o-");t.background=String.format("{0}linear-gradient({1}, {2})",n,i,r)},bD:function(){var n=this.d.style;n.background="transparent"},bj:function(){this.f=document.createElement("a");this.f.removeAttribute("Href");this.f.className="tab-anchor-text";_Ewa.b.j(this.f,"tab",null,null,null);this.f.tabIndex=-1},bk:function(){this.d=document.createElement("span");this.d.className="tab-content-container";this.c=document.createElement("span");this.c.className="tab-text";this.c.dir=this.b.bZ()?"rtl":"ltr";this.d.appendChild(this.c)},bE:function(){for(var i=this.a.O(),n=this.k.$$lge(),t;n.$$mn();)t=n.$$cu(),t.y(i,this.d,this.c)},bb:function(){return _Ewa.c.a(this.a).dA(this.b)},bF:function(){this.u.d();this.w=!0},ba:function(n){if(this.w){this.u.a();var t={"Sheet index":this.b.W,"Active Sheet":this.b.n(),"Hovering time":this.u.b(),"Has been clicked":n};Diag.a.a(39195022,0,50,JSON.stringify(t));this.w=!1}},bA:function(){Common.f.a().a("msospPointerDown",this.cx(),this.N);Common.h.a().a("keydown",this.cx(),this.J);Common.h.a().a("keypress",this.cx(),this.K);this.cE().a("mouseover",this.V,!1);this.cE().a("mouseout",this.U,!1);Common.f.a().a("msospPointerEnter",this.cx(),this.L);Common.f.a().a("msospPointerLeave",this.cx(),this.M);(this.n||_Ewa.a.c("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))&&(Common.f.a().a("msospPointerUp",this.cx(),this.r),this.y&&(Common.l.a().a("touchend",this.cx(),this.r),Common.l.a().a("touchmove",this.cx(),this.O)));Common.j.a().a("click",this.cx(),this.I);this.F=!0},bz:function(){return!this.n&&_Ewa.a.c("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)?!0:(this.x=!1,this.G||this.m(!1,!1,"OnTouchMove"),!1)},Y:function(){var n=this.a.a().a(_Ewa.df,65,!1,null);return n&&n.h()?(n.p(),this.bi(n),!0):!1}};_Ewa.Cm=function(n,t,i){_Ewa.Cm.initializeBase(this,[document.createElement("a"),t,!1]);this.b=_Ewa.a.b(550)?"ewa-stb-insert-new-uir":"ewaboot_stb-structurelock";i.be(this.cx(),_Ewa.ClientStringManager.a().a(681),0,this.b,_Ewa.ClientStringManager.a().a(681),"CommonControlSliderPlus_12",!0);n.appendChild(this.cx());var r=this;this.cE().a("contextmenu",function(n){_Ewa.M.a(n,!0)},!1)};_Ewa.Cm.prototype={b:null};_Ewa.Yx=function(n,t){this.e=Function.createDelegate(this,this.i);this.c=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.h);_Ewa.Yx.initializeBase(this,[n.cx(),null]);this.a=n;this.b=t;Common.j.a().a("dblclick",n.cx(),this.d);Common.bg.a().a(n.cx(),this.c);this.ez().a("keydown",this.e,!1)};_Ewa.Yx.prototype={b:null,a:null,dispose:function(){this.a&&(Common.j.a().b("dblclick",this.a.cx(),this.d),Common.bg.a().c(this.a.cx(),this.c),this.a=null);this.b=null;_Ewa.jY.prototype.dispose.call(this)},i:function(n){n.keyCode===121&&n.shiftKey&&!this.a.e&&(this.f(new Sys.UI.Point(0,0),1,this.a.f),_Ewa.M.a(n,!0))},h:function(n){return!this.b.j()||this.a.e?!0:(this.j(!1,n.b),!0)},g:function(n){return this.a.e?!0:this.f(n.get_clientPoint(),n.b,n.c)},f:function(n,t,i){this.a.W(t,_Ewa.s.t(this.b));var u=new _Ewa.L(-1075099431,t,this.b.p(),30,null),r;return!_Ewa.ca.b(r=this.b.i().a(u,{ClientPoint:n,Sheet:this.a.b,Target:i},null))&&(r.b!==6||r.a())},j:function(n,t){this.b.v(817296323,t,n?19:0,null)}};_Ewa.Ck=function(n){_Ewa.Ck.initializeBase(this,[n])};_Ewa.Ck.a=function(n){_Ewa.bh.a(392,new _Ewa.Ck(n))};_Ewa.Ck.prototype={m:function(){var n=this;this.i.V(function(t){t.c().then(function(){_Ewa.g.a(_Ewa.l.b(_Ewa.dT,n.i.a(),32,33,n.j,null),function(t){var i=t.a(),r=i.e();n.n([new _Ewa.Iv(r)],null)},n.i.g(),3,null,null)})})}};_Ewa.Yz=function(){this.b=new _Ewa.z(!0)};_Ewa.Yz.prototype={a:0,d:function(){return!!(this.a&1)},e:function(){return!!(this.a&2)},c:function(n,t){this.b.b(n,t);this.f()},f:function(){this.a=0;var n=this;_Ewa.z.d(this.b.c,function(t){n.a|=t.value})}};_Ewa.Cl=function(n){_Ewa.Cl.initializeBase(this);this.i=n;this.l()};_Ewa.Cl.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.dT),33,new _Ewa.Cl(n))};_Ewa.Cl.prototype={i:null,a:function(){var i=this.i.l(),n,t;_Ewa.bp.a(this.i.e(),1)||(n=document.getElementById(i+"m_sheetTabBar"),n)&&(_Ewa.s.s(this.i)?(t=this,_Ewa.g.a(_Ewa.l.b(_Ewa.hz,this.i.a(),388,387,this.j,null),function(i){t.k(t.i.a().a(_Ewa.dT,32,!1,null)||new _Ewa.tc(t.i,n,i.a()))},this.i.g(),3,null,null)):this.k(this.i.a().a(_Ewa.dT,32,!1,null)||new _Ewa.tc(this.i,n,null)))}};_Ewa.YA=function(){};_Ewa.YA.a=function(n,t,i,r,u,f,e,o){var s=n.a(9,o);return s.sheetName=t,s.newSheetIndex=i,_Ewa.k.a(n,"ReorderSheets",s,r,u,f,e,0,null,null)};_Ewa.Iv=function(n){this.a=n};_Ewa.Iv.prototype={a:null,z:function(){return!1},x:function(n,t){var i=t.a,r=null;switch(i){case 1243860697:this.a.a();break;default:r=_Ewa.Y.a(i)}return r||$$sc.a.a(Boolean,!0)},w:function(n,t){return t.a===1243860697},y:function(){return!1}};_Ewa.bnU.registerClass("_Ewa.bnU",_Ewa.bdU);_Ewa.Ti.registerClass("_Ewa.Ti");_Ewa.kC.registerClass("_Ewa.kC",_Ewa.bnU);_Ewa.Ys.registerClass("_Ewa.Ys",_Ewa.bnU);_Ewa.nL.registerClass("_Ewa.nL",null,Sys.IDisposable);_Ewa.Yw.registerClass("_Ewa.Yw",_Ewa.bnU);_Ewa.Yv.registerClass("_Ewa.Yv",_Ewa.bdU,Sys.IDisposable);_Ewa.tc.registerClass("_Ewa.tc",_Ewa.bdU,_Ewa.dT,Sys.IDisposable,_Ewa.pm);_Ewa.gO.registerClass("_Ewa.gO",_Ewa.bnU);_Ewa.Cm.registerClass("_Ewa.Cm",_Ewa.bnU);_Ewa.Yx.registerClass("_Ewa.Yx",_Ewa.jY);_Ewa.Ck.registerClass("_Ewa.Ck",_Ewa.bh);_Ewa.Yz.registerClass("_Ewa.Yz");_Ewa.Cl.registerClass("_Ewa.Cl",_Ewa.sY.$$(_Ewa.dT));_Ewa.Iv.registerClass("_Ewa.Iv",null,_Ewa.lK);Type.registerNamespace("_Ewa");_Ewa.boh=function(){};_Ewa.boh.a=function(){_Ewa.m.a(function(n){_Ewa.Cl.a(n);_Ewa.Ck.a(n)})};_Ewa.boh.a();Type.registerNamespace("_Ewa");_Ewa.Ze=function(n,t){_Ewa.Ze.resolveInheritance();this.a=this.ba;this.c=this.O;_Ewa.Ze.initializeBase(this,[n]);t.b(_Ewa.mp,240,this)};_Ewa.Ze.prototype={b:function(n){for(var i,r=this.A,u=r.length,t=0;t<u;++t)if(i=r[t],n.b().i(i))return i;return null},K:function(n){if(n.GridBlockModel){var t=gridRenderer.GridBlockRendererFactoryGlobal.getModelAccessor(n.GridBlockModel);if(t)return t.getSparklineRanges()}return null}};_Ewa.Cz=function(n){_Ewa.Cz.initializeBase(this);this.i=n;this.l()};_Ewa.Cz.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.mp),239,new _Ewa.Cz(n))};_Ewa.Cz.prototype={i:null,m:null,a:function(){this.k(this.m||(this.m=new _Ewa.Ze(_Ewa.c.a(this.i),this.i.a())))}};_Ewa.Ze.registerClass("_Ewa.Ze",_Ewa.boS,_Ewa.mp);_Ewa.Cz.registerClass("_Ewa.Cz",_Ewa.sY.$$(_Ewa.mp));Type.registerNamespace("_Ewa");_Ewa.boA=function(){};_Ewa.boA.a=function(){_Ewa.m.a(_Ewa.Cz.a)};_Ewa.boA.a();Type.registerNamespace("_Ewa");_Ewa.CE=function(n){_Ewa.CE.initializeBase(this);this.i=n;this.l()};_Ewa.CE.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.hz),387,new _Ewa.CE(n))};_Ewa.CE.prototype={i:null,a:function(){var n=this;_Ewa.g.a(_Ewa.y.e([109],4,this.j,!1,!1,!0,387),function(){var t=_Ewa.a.a("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",i=window[t];i?n.k(n.i.a().a(_Ewa.hz,388,!1,null)||new _Ewa.CD(n.i)):Diag.a.a(575807752,0,50,"window.[{0}] returned null.",t)},this.h(),3,null,null)}};_Ewa.CD=function(n){this.e=Function.createDelegate(this,this.k);this.c=n;this.f={};this.d={};var t=_Ewa.a.a("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",i=this.h(t);if(!i){Diag.a.a(590918344,0,15,"window[{0}].icons returned null.",t);return}this.g(i);this.c.b().f()?this.i("excel-uiSlice20-sprite","excelUiSlice20Sprite"):n.b().l(this.e);this.c.a().b(_Ewa.CD,388,this)};_Ewa.CD.prototype={c:null,f:null,d:null,dispose:function(){this.d=null;this.c.b().q(this.e)},b:function(n,t,i,r,u){var e,f,a,s,y;if((e=this.d[n])||(this.d[n]=e=this.l(this.f[n])),!e)return Diag.a.b(590918343,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",n),null;if(f=e.cloneNode(!0),!f.style){var c=Common.bx.b(e),l=Common.bx.b(f),o={};o.iconId=n;o.isOriginalNodeStyleNull=isNullOrUndefined(e.style);o.isOriginalNodeCurrentStyleNull=isNullOrUndefined(e.currentStyle);o.isClonedNodeCurrentStyleNull=isNullOrUndefined(f.currentStyle);o.originalNode=c.substring(0,c.indexOf(">")+1);o.clonedNode=l.substring(0,l.indexOf(">")+1);Diag.a.a(588801239,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(o))}if(a=String.format("height: {0}px; width: {0}px;",t,i),f.setAttribute("style",a),u&&(s=document.createElement("title"),s.innerHTML=u,f.insertBefore(s,f.childNodes[0])),r)for(var v=r,p=v.length,h=0;h<p;++h)y=v[h],Sys.UI.DomElement.addCssClass(f,y);return f},a:function(n,t,i,r,u,f,e,o){var h,s,c;return u&&f||(h=_Ewa.b.h(r),u=h.height,f=h.width),s=this.b(n,t,i,e,o),s&&(r.appendChild(s),c=_Ewa.b.r(s,"style",null),c?s.setAttribute("style",c+String.format(" margin: {0}px {1}px;",(u-t)/2,(f-i)/2)):Diag.a.a(588068257,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',n)),s},k:function(){this.i("excel-uiSlice20-sprite","excelUiSlice20Sprite");this.c.b().q(this.e)},i:function(n,t){var i=this;_Ewa.g.a(_Ewa.l.b(Common.bk,this.c.a(),283,284,0,null),function(r){var u=$$sc.h.a(Object,r.a().a().loadScript(n));_Ewa.g.a(u,function(){var n=i.h(t);n?i.g(n):Diag.a.a(574681088,0,15,"window[{0}].icons returned null.",t)},i.c.g(),3,null,null)},this.c.a().d(),3,null,null)},g:function(n){for(var t,u,f,r=n,e=r.length,i=0;i<e;++i)(t=r[i],u=t.type,u==="svg")&&(f=t.id,this.f[f]=t)},l:function(n){if(!n)return null;var u=n.id,i=n.viewBox,r=n.children,t=document.createElementNS("http://www.w3.org/2000/svg","svg");return Sys.UI.DomElement.addCssClass(t,"ewa-svg-icon"),t.setAttribute("focusable","false"),t.setAttribute("viewBox",i),this.j(t,r),t},j:function(n,t){for(var f,i,e=t,h=e.length,r=0;r<h;++r){var o=e[r],c=o.type,u=document.createElementNS("http://www.w3.org/2000/svg",c),s=o;for(f in s)i={key:f,value:s[f]},i.key==="className"?u.setAttribute("class",i.value):u.setAttribute(i.key,i.value);n.appendChild(u)}},h:function(n){var t=window[n];return t?t.icons:null}};_Ewa.CE.registerClass("_Ewa.CE",_Ewa.sY.$$(_Ewa.hz));_Ewa.CD.registerClass("_Ewa.CD",null,_Ewa.hz,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.boJ=function(){};_Ewa.boJ.a=function(){_Ewa.m.a(_Ewa.CE.a)};_Ewa.boJ.a();Type.registerNamespace("_Ewa");_Ewa.Tn=function(n){this.tableName=n};_Ewa.Tn.prototype={tableName:null};_Ewa.Tp=function(n){this.originalRange=n};_Ewa.Tp.prototype={originalRange:null};_Ewa.To=function(n,t){this.oldName=n;this.newName=t};_Ewa.To.prototype={oldName:null,newName:null};_Ewa.zw=function(n,t,i,r){_Ewa.zw.initializeBase(this,[n,i]);this.hasHeaders=t;this.isCreation=r};_Ewa.zw.prototype={hasHeaders:!1,isCreation:!1};_Ewa.Tr=function(n,t){this.tableRanges=n;this.tableRange=_Ewa.h.z(n.Ranges[0],n.SheetName);this.styleIndex=t};_Ewa.Tr.prototype={tableRanges:null,tableRange:null,styleIndex:0};_Ewa.Ts=function(n,t,i){this.tableRange=n;this.optionType=t;this.isPivotTable=i};_Ewa.Ts.prototype={isPivotTable:!1,tableRange:null,optionType:0};_Ewa.bli=function(){this.sheetRange=sheetRange;this.headerRow=headerRow};_Ewa.bli.prototype={sheetRange:null,headerRow:!1};_Ewa.Zu=function(n){this.bg=Function.createDelegate(this,this.bu);this.R=Function.createDelegate(this,this.br);this.be=Function.createDelegate(this,this.L);this.bf=Function.createDelegate(this,this.bt);this.Q=Function.createDelegate(this,this.X);this.S=Function.createDelegate(this,this.bs);this.P=Function.createDelegate(this,this.V);this.T=Function.createDelegate(this,this.bv);this.k=this.ba;this.x=this.O;_Ewa.Zu.resolveInheritance();this.c=this.bw;_Ewa.Zu.initializeBase(this,[_Ewa.c.a(n)]);this.y=n;this.z=_Ewa.c.a(this.y);this.y.a().b(_Ewa.dA,66,this);this.C={};this.V(null,null);this.y.d()&&this.y.d().c(this.T);this.j(this.P);this.y.b().H(this.S);this.z.a().e(this.Q);this.y.j()&&this.X(null,null)};_Ewa.Zu.prototype={F:null,y:null,z:null,J:null,D:null,G:null,U:!1,j:function(n){this.et("lrc",n)},w:function(n){this.ev("lrc",n)},i:function(n){this.et("tce",n)},v:function(n){this.ev("tce",n)},C:null,I:null,n:function(){return this.I},a:function(){var n=_Ewa.c.a(this.y);return n.e().a(n.a().a().a(),!1)},e:function(){if(!this.I)return null;var n=_Ewa.c.a(this.y);return n.e().a(this.I,!1)},f:function(n){return!!this.bb(n)},b:function(n){return this.bm(this.bc(n))},o:function(n){return this.bc(n)},u:function(n){if(!n){Diag.a.a(594130058,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved");return}this.G?this.G!==n&&(System.a.a(this.D),this.D=null,this.G=n):this.G=n;this.D||(this.D=_Ewa.bL.a().a(this.G));this.D.d("focusin",!1)||this.D.a("focusin",this.bf,!1)},g:function(n,t){return n?n.q&&n.a===t.a:(Diag.a.b(20821026,0,!!n,"autofilterRange can't be null"),!1)},d:function(n){var t=this.F?_Ewa.h.B(n,this.F,!1):this.B.C(n);return t.length>0&&_Ewa.cB.isInstanceOfType(t[0])?t[0]:null},r:function(n,t){return n?!n.V&&!!n.D&&n.D.h(t):(Diag.a.b(20821027,0,!!n,"Pivot table can't be null"),!1)},s:function(n,t){return n?!n.V&&!!n.J&&n.J.h(t):(Diag.a.b(20821056,0,!!n,"Pivot table can't be null"),!1)},ba:function(n){var t,i;if(_Ewa.boS.prototype.ba.call(this,n),t=_Ewa.j.V(n),t&&t.length>0)for(this.F=new Array(t.length),i=0;i<t.length;i++)this.F[i]=_Ewa.eN.a(t[i])},O:function(){_Ewa.boS.prototype.O.call(this);this.F=null},l:function(n,t){var i=!1,r,u;return u=this.m(n,t,r={val:i}),i=r.val,u},m:function(n,t,i){var r,u,f;return(i.val=!1,!n||!t)?!1:(r=n.f(),r.d=r.d+1,r.b=r.d,!r.v())?!1:r.a<t.h().c&&(u=r.f(),u.c>=t.h().c&&(u.c=t.h().c-1),!this.bh(u,t,i))?!1:r.c>=t.h().c&&(f=r.f(),f.a<=t.h().c&&(f.a=t.h().c),!this.bh(f,t,i))?!1:!0},h:function(n){var t=this.b(n.e()),i;t&&t.toString()in this.C&&(i=this.C[t.toString()],i.o=!1)},t:function(){this.es("tce",null,null)},p:function(n,t){var i,r;if(!this.J)return!1;switch(t){case-569786022:case 541421805:return this.J.j&&(i=document.getElementById("TableTotalRowDropDownIconButtonId"),i&&(r=this,_Ewa.B.a().a(function(){_Ewa.b.P(i,null)},0,_Ewa.o.cS,!0,!0))),!0;default:return!1}},dispose:function(){this.L(null,null);this.w(this.P);this.y.d().d(this.T);this.y.H(this.be);this.C=null;this.y.b()&&this.y.b().J(this.S);this.z.a().i(this.Q);this.J=null;_Ewa.a.b(437)&&this.D&&(System.a.a(this.D),this.D=null);_Ewa.boS.prototype.dispose.call(this)},q:function(n,t,i,r){var s=this.z.e().a(new _Ewa.p(t,i,t,i,!1,!1),!1);if(!s){Diag.a.b(542752843,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null");return}var u=s.O,h=_Ewa.bz.b(s),c=_Ewa.bz.c(s),l=n.ctrlKey||Common.c.d()&&_Ewa.M.b(n),f=!n.shiftKey&&l,e=n.shiftKey&&!l,o;switch(r){case 0:_Ewa.a.a("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(o=this.W(e,h,c,u.a,i,u.c,i),this.Y(o,f,e)):this.Z(u.a,i,u.c,i,h,c,f);break;case 1:_Ewa.a.a("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(o=this.W(e,!1,!1,t,u.b,t,u.d),this.Y(o,f,e)):this.Z(t,u.b,t,u.d,!1,!1,f);break;case 2:_Ewa.a.a("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(o=this.W(e,h,c,u.a,u.b,u.c,u.d),this.Y(o,f,e)):this.Z(u.a,u.b,u.c,u.d,h,c,f);break;default:Diag.a.b(542752842,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",r.toString())}},K:function(n){return n.Autofilters},V:function(){var r={},s=this.bn(),e=s,u,o,n,t,i,f;for(u in e)if((o={key:u,value:e[u]},n=o.value,n)&&(t=this.bo(n),t)){if(t in this.C&&(i=this.C[t],i.j())){i.a.g(n)||(i.a=n);delete this.C[t];r[t]=i;continue}f=_Ewa.nR.b(_Ewa.c.a(this.y),n,this.bl(),this);f?r[t]=f:Diag.a.a(42078495,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",n.w(!1,!1))}this.L(null,null);this.C=r},L:function(){var r=this.C,i=r,t,n;for(t in i)(n={key:t,value:i[t]},n.value)&&(n.value.dispose(),delete this.C[n.key]);this.C={}},bh:function(n,t,i){var e,r;i.val=!1;var u=t.h().d(n),o=t.n(u),f=o.t();if(!f)return Diag.a.a(40640599,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",u),!1;if(e=f.n(n),!e)return!0;r=t.s("TableManager.CouldExpandImpl",n,2,!0);try{while(r.$$mn()){if(!_Ewa.f.a(r.$$cu().c())||r.a().bv())return i.val=!0,!1;if(r.$$cu().d())return!1}}finally{r&&r.dispose()}return!0},bm:function(n){var i,r,u,t;if(!n)return null;for(i=new _Ewa.qz(n.a,n.b,n.c,n.d,null,null,null,n.A,n.q),i.t=n.t,r=0,u=this.A.length;r<u;r++)t=this.A[r],t.A===n.A&&t!==n&&this.bp(t)&&(i.H(t),t.t&&(i.t=!0));return i},bp:function(n){return!!_Ewa.c.a(this.y).e().a(n,!1)},bl:function(){for(var r,u,t=[],i=this.A,f=i.length,n=0;n<f;++n)r=i[n],u=new _Ewa.bN(this.b(r.e()),_Ewa.D.a(this.y.h())),t.push(u);return t},bn:function(){for(var n,i,r={},u=this.A,f=u.length,t=0;t<f;++t)(n=u[t],n)&&(i=this.b(n.e()),i)&&(r[i.toString()]=this.b(n.e()));return r},bv:function(){this.L(null,null);this.V(null,null)},bt:function(){this.I=_Ewa.c.a(this.y).a().a().a()},bs:function(){this.y.j()&&this.X(null,null)},X:function(){!this.U&&_Ewa.eD.c(this.y,this.z.a().a().a())&&this.bq(0)},bq:function(n){this.y.b().f()?this.bi(n):this.y.b().l(this.R)},br:function(){this.bi(1);this.y.b().q(this.R)},bi:function(n){var t=this;this.y.V(function(i){i.a(n).then(t.bg)})},bu:function(){this.U=!0;this.J=new _Ewa.eq(this.y)},bo:function(n){var t=this.z.e().a(n,!1);return t?t.N:n.toString()},Z:function(n,t,i,r,u,f,e){var y=n+(u?1:0),p=i-(f?1:0),h=this.z.F()||this.z.u(),c=!1,o=new _Ewa.p(y,t,p,r,!1,!1),w,s,v,l;if(u||f){w=h?_Ewa.bN.b(this.z.a().o().a()):this.z.a().a().b();for(var b=w,k=b.length,a=0;a<k;++a){if(s=b[a],c=this.M(s,y,t,p,r),v=this.M(s,n,t,i,r),h&&c)break;if(!h&&(c||v)){if(this.z.a().d(s,s.e(),0,1,!0,"",!1,!0,!0),e&&v)return;break}}}c&&(o.a=n,o.c=i);l=o.e();e?this.z.a().d(o,l,0,1,!0,"",!1,!0,!0):h?this.z.a().w([o],0,l,0,!0,"",!1,!0,!0):this.z.a().d(o,l,0,3,!0,"",!1,!0,!0)},Y:function(n,t,i){if(n){var r=i?_Ewa.c.a(this.y).a().a().a():n.e(),u=this.z.F()||this.z.u();if(t){this.z.a().d(n,r,0,1,!0,"",!1,!0,!0);return}this.z.a().w([n],0,r,0,!0,"",!1,!0,!0)}},W:function(n,t,i,r,u,f,e){var h=r+(t?1:0),c=f-(i?1:0),a=this.z.F()||this.z.u(),s,o=a?this.z.a().o().c():this.z.a().a().a(),v,p;if(n){var w=o.a<h?o.a:h,b=o.b<u?o.b:u,k=o.c>c?o.c:c,d=o.d>e?o.d:e;s=new _Ewa.p(w,b,k,d,!1,!1)}else s=new _Ewa.p(h,u,c,e,!1,!1);if((t||i)&&(!n||n&&this.M(s,h,u,c,e))){v=a?_Ewa.bN.b(this.z.a().o().a()):this.z.a().a().b();for(var y=v,g=y.length,l=0;l<g;++l)if(p=y[l],this.M(p,h,u,c,e)){s.a=r;s.c=f;break}}return s},M:function(n,t,i,r,u){return!!n&&n.a===t&&n.c===r&&n.b===i&&n.d===u}};_Ewa.boT=function(){};_Ewa.boT.a=function(){_Ewa.m.a(function(n){n.a().b(_Ewa.bkt.$$(_Ewa.dA),134,new _Ewa.Zv(n));n.a().b(_Ewa.bkt.$$(_Ewa.kI),330,new _Ewa.Zx(n))})};_Ewa.nR=function(n,t,i,r){this.t=Function.createDelegate(this,this.P);this.w=Function.createDelegate(this,this.S);this.x=Function.createDelegate(this,this.U);this.z=Function.createDelegate(this,this.X);this.y=Function.createDelegate(this,this.W);this.n=Function.createDelegate(this,this.V);this.u=Function.createDelegate(this,this.Q);this.v=Function.createDelegate(this,this.R);this.m=Function.createDelegate(this,this.T);this.D=[6];this.C=[26];_Ewa.nR.initializeBase(this,[n,null]);this.c=t;this.d=t.c();this.r=r;this.q=t.a();this.h=t.i();this.i=n;this.N();Common.c.f()||Common.c.q()||Common.f.a().a("msospPointerDown",this.e,this.m);this.a=i;this.o=!1;this.f=!1;this.c.f().d(this.v);this.c.f().h(this.u)};_Ewa.nR.b=function(n,t,i,r){var u,f,e;return t?(u=n.i(),u.c(i,[27],!0,null,!0),u.d(_Ewa.nR.a,null,null),f=n.h().d(t.m()),e=u.f(27,f,_Ewa.nR.c(t,i)).b,new _Ewa.nR(e,n,t,r)):null};_Ewa.nR.c=function(n,t){for(var i=0;i<t.length;i++)if(t[i]&&t[i].a&&t[i].a.g(n))return i;return 0};_Ewa.nR.prototype={h:null,q:null,c:null,d:null,r:null,g:null,p:!1,l:!1,j:function(){return this.l||this.p},o:!1,a:null,e:null,i:null,b:null,f:!1,dispose:function(){if(this.k(),this.c.f()&&(this.c.f().c(this.v),this.c.f().f(this.u)),this.f||Common.c.f()||Common.c.q()||Common.f.a().b("msospPointerDown",this.e,this.m),this.j()){_Ewa.bH.b(this.d,!1);try{this.K()}catch(n){Diag.a.a(42078529,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",n)}}this.i&&this.i.contains(this.e)&&this.i.removeChild(this.e);this.i=null;this.e=null;_Ewa.jY.prototype.dispose.call(this)},F:function(n){var t=n.d-this.a.e().d+1,i=n.c-this.a.e().c-1;return t>=0&&i>=0&&n.c>=this.a.a&&n.d>=this.a.b?new _Ewa.p(this.a.a,this.a.b,n.c,n.d,!1,!1):this.b},A:function(n){this.s([this.b],6,n);this.h.d(this.D,null,null)},H:function(n){this.h.a(this.D);this.s([null],6,n)},B:function(n){this.h.a(this.C);this.s([null],26,n)},O:function(n){var t=this.bb();t.length>0&&(this.s(t,26,n),this.h.d(this.C,null,null))},bb:function(){var n=[];return this.a.i(this.b)&&(this.a.d!==this.b.d&&n.push(new _Ewa.p(this.a.a,this.b.d+1,this.b.c,this.a.d,!1,!1)),this.a.c!==this.b.c&&n.push(new _Ewa.p(this.b.c+1,this.a.b,this.a.c,this.a.d,!1,!1))),n},T:function(n){var u,t,i,r;return this.d.i().d()!==1?!0:(n=_Ewa.u.a(this.d).a(n),this.j())?!0:(u=_Ewa.A.a(this.d).t()||_Ewa.A.a(this.d).b(),this.o||u)?(this.k(),!0):(this.b=this.a,this.B(!0),this.A(!0),t=n.b===2&&!n.f,i=n.b===3,(t||i)&&(r=this.q.h(n.get_clientPoint(),n.c,4,!1,!0,!0),r||(r=this.b),this.l=t,this.p=i,this.b=this.F(r),this.A(!0),t?this.Y():i&&this.Z(),_Ewa.bH.b(this.d,!0)),!0)},V:function(n){var i,t;return(n=_Ewa.u.a(this.d).a(n),!this.j())?!1:(i=this.l?this.q.h(n.get_clientPoint(),n.c,4,!1,!0,!0):this.q.h(n.get_clientPoint(),n.c,4,!0,!1,!0),i&&(t=this.F(this.L(i)),this.M(t.m()),this.b.g(t)||(this.b=t,this.H(!1),this.B(!1),this.A(!1),this.O(!1),this.h.e(!1,!0)),this.bf(this.b)),!0)},W:function(n){return(n=_Ewa.u.a(this.d).a(n),!this.j())?!1:(this.I(),this.k(),!0)},X:function(n){return(n=_Ewa.u.a(this.d).a(n),!this.j())?(Diag.a.b(592557912,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1):(this.I(),this.k(),!0)},I:function(){if(!this.b.g(this.a)){var n=new _Ewa.p(this.a.a,this.a.b,this.b.c,this.b.d,!1,!1);this.bc(n);this.o=!0}},U:function(n){return n=_Ewa.u.a(this.d).a(n),this.k(),!0},S:function(n){return n=_Ewa.u.a(this.d).a(n),!0},P:function(){this.k()},R:function(){this.f||Common.c.f()||Common.c.q()||(this.k(),Common.f.a().b("msospPointerDown",this.e,this.m),this.e.classList.add("ewr-table-resize-default-cursor"),this.e.disabled=!0,this.f=!0)},Q:function(){this.f&&(Common.c.f()||Common.c.q()||(Common.f.a().a("msospPointerDown",this.e,this.m),this.e.classList.remove("ewr-table-resize-default-cursor"),this.e.disabled=!1,this.f=!1),this.f=!1)},N:function(){var n=document.createElement("div"),t,i;n.className="ewr-table-resize-handle";t=document.createElement("div");t.className="ewr-table-resize-fillhandle-higher";i=document.createElement("div");i.className="ewr-table-resize-fillhandle-broader";n.appendChild(t);n.appendChild(i);this.e=n;this.i.appendChild(this.e)},M:function(n){var h=this.b.i(n),e=5,r=n.a,t=n.c,u=n.b,i=n.d,f=null,o,s;if(h){if(this.c.by(this.a.e())&&!this.a.t)return;r=Math.max(1,t-e,this.a.a);u=Math.max(1,i-e,this.a.b);t=r;i=u;f=new _Ewa.p(r,u,r,u,!1,!1)}else t+=e,i+=e,r=t,u=i,f=new _Ewa.p(t,i,t,i,!1,!1);this.c.by(f)||(this.g?this.g.c()||(s=this,this.g=_Ewa.B.a().a(function(){s.c.K(f,60,_Ewa.I.k,!1,null)},40,_Ewa.o.n,!0,!1)):(o=this,this.g=_Ewa.B.a().a(function(){o.c.K(f,60,_Ewa.I.k,!1,null)},40,_Ewa.o.n,!0,!1)))},L:function(n){var t=n,r,u,i;if(this.c.h().l()){if(r=this.c.g(n.e()),!r){u=this.b.a!==n.a?1:2;i=this.c.s("TableResizeBehavior.AdjustHiddenRowColumns",this.c.R(),u,!0);try{i.c(this.b.a<n.a||this.b.b<n.b);i.b(n.e(),!0);t=i.$$cu().b()}finally{i&&i.dispose()}}t.d=t.b+n.k()-1;t.c=t.a+n.j()-1}return t},s:function(n,t,i){for(var e,u=[],f=n,o=f.length,r=0;r<o;++r)e=f[r],u.push(new _Ewa.bN(e,_Ewa.D.a(this.d.h())));this.h.c(u,[t],!0,null,i)},Y:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.f.a().a("msospPointerMove",i.l(),this.n);Common.f.a().a("msospPointerUp",document.documentElement,this.y);this.E()},Z:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.l.a().a("touchmove",i.l(),this.n);Common.l.a().a("touchend",document.documentElement,this.z);this.E()},K:function(){this.l&&this.bd();this.p&&this.be()},bd:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.f.a().b("msospPointerMove",i.l(),this.n);Common.f.a().b("msospPointerUp",document.documentElement,this.y);this.G()},be:function(){for(var i,t=this.c.G(),r=t.length,n=0;n<r;++n)i=t[n],Common.l.a().b("touchmove",i.l(),this.n);Common.l.a().b("touchend",document.documentElement,this.z);this.G()},E:function(){Common.f.a().a("msospPointerLeave",document.documentElement,this.x);this.c.k().o(!0);Common.h.a().f("keydown",document.documentElement,this.w,!0);this.r.i(this.t)},G:function(){Common.f.a().b("msospPointerLeave",document.documentElement,this.x);this.c.k().o(!1);Common.h.a().b("keydown",document.documentElement,this.w);this.r.v(this.t)},bc:function(n){var t={ResizeTableRange:n,OriginalTableRange:this.a};this.d.v(-1400250766,_Ewa.K.a,30,t)},bf:function(n){var i,u;if(!this.a.i(n)){i=this.ba();for(var r=i,f=r.length,t=0;t<f;++t)if(u=r[t],this.r.f(u)){this.c.r().a("not-allowed");return}}this.c.d()?this.c.r().a("nesw-resize"):this.c.r().a("nwse-resize")},k:function(){if(this.j()){_Ewa.bH.b(this.d,!1);try{this.K()}catch(n){Diag.a.a(42321987,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",n)}}this.g&&(this.g.a(),this.g.dispose());this.l=!1;this.p=!1;this.H(!0);this.B(!0);_Ewa.bH.b(this.d,!1);this.c.r().a(null)},ba:function(){var n=[];return this.a.d!==this.b.d&&n.push(new _Ewa.p(this.a.a,this.a.d+1,this.b.c,this.b.d,!1,!1)),this.a.c!==this.b.c&&n.push(new _Ewa.p(this.a.c+1,this.a.b,this.b.c,this.a.d,!1,!1)),n}};_Ewa.bE=function(){};_Ewa.bE.m=function(n,t){var i=t.Type,r=n.Type;return _Ewa.bE.g[r]-_Ewa.bE.g[i]};_Ewa.bE.f=function(n,t){try{return appChrome.buildTableStyleGalleryIconNew(5,5,n,t)}catch(i){return null}};_Ewa.bE.k=function(n){if(n&&"MenuItemId"in n){var t=n.MenuItemId;if(!(!t||!t.length))return _Ewa.f.g(t,"preview")}return!1};_Ewa.bE.c=function(n){for(var s,f,e,r,t=[],i=0,o=n,h=o.length,u=0;u<h;++u){s=o[u];t[i]={};t[i].backgroundColor="white";t[i].color="black";f=s;for(e in f){r={key:e,value:f[e]};switch(r.key){case"background-color":t[i].backgroundColor=r.value;break;case"color":t[i].color=r.value;break;case"font-size":t[i].fontSize=r.value;break;case"border-bottom":t[i].borderBottom=r.value;break;case"border-right":t[i].borderRight=r.value;break;case"border-left":t[i].borderLeft=r.value;break;case"border-top":t[i].borderTop=r.value}}i++}return t};_Ewa.bE.d=function(n,t){var i=[],o,r,u,f,e;if(n&&n.TableStyleElementsList)for(o=!n.Category,r=0;r<5;r++)i.push.apply(i,_Ewa.bE.q(n,t,o,r));else{if(_Ewa.bE.e)return _Ewa.bE.e;for(u={},u.color="black",u["background-color"]="white",f=0;f<5;f++)for(e=0;e<5;e++)i.push(u);_Ewa.bE.e=i}return i};_Ewa.bE.r=function(n,t){var r,i;if(!n.TableStyleElementsList)return"";r="";for(var f=n.TableStyleElementsList,e=f.length,u=0;u<e;++u)if(i=f[u],!(!i.BackgroundColor||!i.BackgroundColor.length)&&i.BackgroundColor!=="#000000")switch(i.Type){case 0:r=i.BackgroundColor;break;case 5:case 7:(t.f||t.b)&&(r=i.BackgroundColor);break;case 3:case 4:(t.d||t.e)&&(r=i.BackgroundColor);break;case 2:t.c&&(r=i.BackgroundColor);break;case 1:t.a&&(r=i.BackgroundColor)}return r};_Ewa.bE.o=function(n){var t=parseInt("0x"+n.substr(1,2)),i=parseInt("0x"+n.substr(3,2)),r=parseInt("0x"+n.substr(5,2)),u=new _Ewa.bv(t,i,r);return _Ewa.eH.a(u)};_Ewa.bE.j=function(n,t){if(!n||!t)return"";var i,r=_Ewa.bE.r(n,t);i=r&&r.length?_Ewa.bE.o(r)+", ":_Ewa.ClientStringManager.a().a(1938)+", ";switch(n.Index){case 0:return i+_Ewa.ClientStringManager.a().a(1872);case 1:return i+_Ewa.ClientStringManager.a().a(1873);case 2:return i+_Ewa.ClientStringManager.a().a(1874);case 3:return i+_Ewa.ClientStringManager.a().a(1875);case 4:return i+_Ewa.ClientStringManager.a().a(1876);case 5:return i+_Ewa.ClientStringManager.a().a(1877);case 6:return i+_Ewa.ClientStringManager.a().a(1878);case 7:return i+_Ewa.ClientStringManager.a().a(1879);case 8:return i+_Ewa.ClientStringManager.a().a(1880);case 9:return i+_Ewa.ClientStringManager.a().a(1881);case 10:return i+_Ewa.ClientStringManager.a().a(1882);case 11:return i+_Ewa.ClientStringManager.a().a(1883);case 12:return i+_Ewa.ClientStringManager.a().a(1884);case 13:return i+_Ewa.ClientStringManager.a().a(1885);case 14:return i+_Ewa.ClientStringManager.a().a(1886);case 15:return i+_Ewa.ClientStringManager.a().a(1887);case 16:return i+_Ewa.ClientStringManager.a().a(1888);case 17:return i+_Ewa.ClientStringManager.a().a(1889);case 18:return i+_Ewa.ClientStringManager.a().a(1890);case 19:return i+_Ewa.ClientStringManager.a().a(1891);case 20:return i+_Ewa.ClientStringManager.a().a(1892);case 21:return i+_Ewa.ClientStringManager.a().a(1893);case 22:return i+_Ewa.ClientStringManager.a().a(1894);case 23:return i+_Ewa.ClientStringManager.a().a(1895);case 24:return i+_Ewa.ClientStringManager.a().a(1896);case 25:return i+_Ewa.ClientStringManager.a().a(1897);case 26:return i+_Ewa.ClientStringManager.a().a(1898);case 27:return i+_Ewa.ClientStringManager.a().a(1899);case 28:return i+_Ewa.ClientStringManager.a().a(1900);case 29:return i+_Ewa.ClientStringManager.a().a(1901);case 30:return i+_Ewa.ClientStringManager.a().a(1902);case 31:return i+_Ewa.ClientStringManager.a().a(1903);case 32:return i+_Ewa.ClientStringManager.a().a(1904);case 33:return i+_Ewa.ClientStringManager.a().a(1905);case 34:return i+_Ewa.ClientStringManager.a().a(1906);case 35:return i+_Ewa.ClientStringManager.a().a(1907);case 36:return i+_Ewa.ClientStringManager.a().a(1908);case 37:return i+_Ewa.ClientStringManager.a().a(1909);case 38:return i+_Ewa.ClientStringManager.a().a(1910);case 39:return i+_Ewa.ClientStringManager.a().a(1911);case 40:return i+_Ewa.ClientStringManager.a().a(1912);case 41:return i+_Ewa.ClientStringManager.a().a(1913);case 42:return i+_Ewa.ClientStringManager.a().a(1914);case 43:return i+_Ewa.ClientStringManager.a().a(1915);case 44:return i+_Ewa.ClientStringManager.a().a(1916);case 45:return i+_Ewa.ClientStringManager.a().a(1917);case 46:return i+_Ewa.ClientStringManager.a().a(1918);case 47:return i+_Ewa.ClientStringManager.a().a(1919);case 48:return i+_Ewa.ClientStringManager.a().a(1920);case 49:return i+_Ewa.ClientStringManager.a().a(1921);case 50:return i+_Ewa.ClientStringManager.a().a(1922);case 51:return i+_Ewa.ClientStringManager.a().a(1923);case 52:return i+_Ewa.ClientStringManager.a().a(1924);case 53:return i+_Ewa.ClientStringManager.a().a(1925);case 54:return i+_Ewa.ClientStringManager.a().a(1926);case 55:return i+_Ewa.ClientStringManager.a().a(1927);case 56:return i+_Ewa.ClientStringManager.a().a(1928);case 57:return i+_Ewa.ClientStringManager.a().a(1929);case 58:return i+_Ewa.ClientStringManager.a().a(1930);case 59:return i+_Ewa.ClientStringManager.a().a(1931);default:return!n.Name||!n.Name.length?"":n.Name}};_Ewa.bE.b=function(n,t,i){return!n&&i&&i.length?String.format("{0}, {1}, -version, {2}","TableStyleIcon",i,t.toString()):String.format("{0}, {1}, -version, {2}","TableStyleIcon",n.Index.toString(),t.toString())};_Ewa.bE.q=function(n,t,i,r){for(var f=[],u=0;u<5;u++)f.push(_Ewa.bE.p(n,t,i,r,u));return f};_Ewa.bE.p=function(n,t,i,r,u){var c=n.TableStyleElementsList,f=new _Ewa.DS,k=new Array(4),o={},a,s,h,e;if(!c)return o;for(var y=c,w=y.length,l=0;l<w;++l)if(a=y[l],!a.Type){f=a;break}s=!(!f.BackgroundColor||!f.BackgroundColor.length);h="";i||f.TableStyleBorderFromatList&&f.TableStyleBorderFromatList.length>0&&(h=f.TableStyleBorderFromatList[0].Color);o["background-color"]=s?f.BackgroundColor:"#FFFFFF";f.FontColor&&f.FontColor.length||(f.FontColor="#000000");o.color=f.FontColor;_Ewa.bE.i(r,u,o,f,h,i,s);for(var p=c,b=p.length,v=0;v<b;++v)(e=p[v],e&&e.Type)&&(e.Type!==2||s||(e.BackgroundColor=f.BackgroundColor),_Ewa.bE.t(e,r,u,t)&&(!e.BackgroundColor||!e.BackgroundColor.length||(o["background-color"]=e.BackgroundColor),o.color=!e.FontColor||!e.FontColor.length?f.FontColor:e.FontColor,_Ewa.bE.i(r,u,o,e,h,i,s)));return o};_Ewa.bE.a=function(n,t,i,r,u,f){if(i){!i.Color||!i.Color.length||i.Style||(i.Style=1);!i.Style||i.Color&&i.Color.length||(i.Color=u?"#000000":r&&r.length?r:f?"#FFFFFF":"#000000");var e=_Ewa.bE.l[i.Style];t[_Ewa.bE.h[n]]="1px "+e+" "+i.Color}};_Ewa.bE.t=function(n,t,i,r){return n.Type===-1?!1:_Ewa.bE.v(n,t,i,r)||_Ewa.bE.u(n,t,i,r)||_Ewa.bE.w(n,t,i,r)};_Ewa.bE.u=function(n,t,i,r){return!t&&r.a||t===4&&r.c?!1:t%2==1&&n.Type===5&&r.b&&r.a||t>1&&!!((t-1)%(n.BandSize+1))&&n.Type===6&&r.b&&r.a||!(t%2)&&n.Type===5&&r.b&&!r.a||!!(t%(n.BandSize+1))&&n.Type===6&&r.b&&!r.a||!(i%2)&&n.Type===7&&r.f||!!(i%(n.BandSize+1))&&n.Type===8&&r.f};_Ewa.bE.w=function(n,t,i,r){return t===4&&n.Type===2&&r.c||i===4&&t===4&&n.Type===12&&r.c&&r.e||!i&&t===4&&n.Type===11&&r.c&&r.d||i===4&&n.Type===4&&r.e};_Ewa.bE.v=function(n,t,i,r){return!t&&n.Type===1&&r.a||!i&&n.Type===3&&r.d||!i&&!t&&n.Type===9&&r.a&&r.d||i===4&&!t&&n.Type===10&&r.a&&r.e};_Ewa.bE.i=function(n,t,i,r,u,f,e){var o;if(r.TableStyleBorderFromatList)for(var h=r.TableStyleBorderFromatList,c=h.length,s=0;s<c;++s)if(o=h[s],o.Style)switch(o.Position){case 0:n&&r.Type!==12&&r.Type!==11&&r.Type!==2&&r.Type!==5&&r.Type!==6||_Ewa.bE.a(0,i,o,u,f,e);break;case 1:(n===4||r.Type===1||r.Type===10||r.Type===9||r.Type===5||r.Type===6)&&_Ewa.bE.a(1,i,o,u,f,e);break;case 2:t&&r.Type!==12&&r.Type!==10&&r.Type!==7&&r.Type!==8&&r.Type!==4||_Ewa.bE.a(2,i,o,u,f,e);break;case 3:(t===4||r.Type===9||r.Type===11||r.Type===3||r.Type===7||r.Type===8)&&_Ewa.bE.a(3,i,o,u,f,e);break;case 5:t===4||r.Type===3||r.Type===4||r.Type===7||r.Type===8||_Ewa.bE.a(3,i,o,u,f,e);break;case 6:n===4||r.Type===2||r.Type===1||r.Type===5||r.Type===6||_Ewa.bE.a(1,i,o,u,f,e)}};_Ewa.bE.s=function(){var n=new Array(12);return n[0]=0,n[7]=1,n[8]=2,n[5]=3,n[6]=4,n[4]=5,n[3]=6,n[1]=7,n[2]=8,n[9]=9,n[10]=10,n[11]=11,n[12]=13,n};_Ewa.bE.n=function(n,t,i,r,u,f){this.a=n;this.c=t;this.d=i;this.e=r;this.b=u;this.f=f};_Ewa.bE.n.prototype={a:!1,c:!1,d:!1,e:!1,f:!1,b:!1,g:function(n){return n?this.a===n.a&&this.c===n.c&&this.d===n.d&&this.e===n.e&&this.f===n.f&&this.b===n.b:!1}};_Ewa.Zw=function(n,t,i){this.M=Function.createDelegate(this,this.T);this.C=Function.createDelegate(this,this.O);this.D=Function.createDelegate(this,this.W);this.E=Function.createDelegate(this,this.X);this.Q={height:"100%"};this.K={};this.v=new Date;this.k=-1;this.w={};this.h={};this.m={};_Ewa.Zw.initializeBase(this,[!1]);this.j=n;this.p=t;this.l=i;this.j.a().b(_Ewa.kI,329,this);this.t=this.u();this.j.i().e(this.E)};_Ewa.Zw.prototype={p:null,j:null,l:null,B:0,n:0,o:null,i:null,t:null,x:null,J:!1,I:!1,q:!1,r:!1,y:null,G:!1,s:!1,z:!1,f:function(n){var t=this.l.a(),i,r;if(!t||(i=n.MenuItemId,!i||!i.length))return!1;r=Number.parseInvariant(i);switch(r){case 0:return _Ewa.bz.b(t);case 1:return _Ewa.bz.f(t);case 2:return _Ewa.bz.c(t);case 3:return _Ewa.bz.g(t);case 4:return _Ewa.bz.h(t);case 5:return _Ewa.bz.e(t);case 6:return t.bb}return!1},c:function(n,t,i){var w,c,l,a,b,r,e;if(Common.D.a(this.h))return!0;if(t!=="PopulateTableMoreStylesMenu"&&t!=="PopulateTableAccessibleStylesMenu")return!1;if(_Ewa.a.c("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&t==="PopulateTableAccessibleStylesMenu"&&!this.z)return this.s||(this.s=!0,this.b("accessibilityTab")),!0;this.r=!0;var o=this.p.c("TableStylesMenu"),s="Size48by48",v=this.p.e("Ribbon.TableTools.TableStyles.Gallery.Custom",7,s,null),y=this.p.e("Ribbon.TableTools.TableStyles.Gallery.Dark",7,s,null),p=this.p.e("Ribbon.TableTools.TableStyles.Gallery.Medium",7,s,null),h=this.p.e("Ribbon.TableTools.TableStyles.Gallery.Light",7,s,null),f=-123538519,u;!i.MenuId||!i.MenuId.length||(_Ewa.f.c(i.MenuId,"FormatAsTable",!0)?(f=753331043,this.q=!0):(u=_Ewa.ClientStringManager.a().a(1871),w=_Ewa.bE.b(null,1,"-1"),_Ewa.a.a("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?h.a("-1",f,"QueryTableStyle",0,"-1",w,null,null,u,null):h.a("-1",f,"QueryTableStyle",0,"-1",null,null,null,u,null),this.q=!1));c=0;l=this.h;for(a in l)if((b={key:a,value:l[a]},r=b.value,!_Ewa.a.c("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||t!=="PopulateTableAccessibleStylesMenu"||!r.HasStyleViolations)&&(e="",u=_Ewa.bE.j(r,this.u()),e=_Ewa.bE.b(r,this.n,""),r))switch(r.Category){case 0:v.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),e,null,null,u,null);c++;break;case 3:y.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),e,null,null,u,null);break;case 2:p.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),e,null,null,u,null);break;case 1:h.a(r.Index.toString(),f,"QueryTableStyle",0,r.Index.toString(),e,null,null,u,null)}return c>0&&this.A(o,v,1839),this.A(o,h,1840),this.A(o,p,1841),this.A(o,y,1842),i.MenuItems=o.b(),this.I||(this.I=!0),!0},g:function(n){var f=_Ewa.q.a().b().m,r=0,e=0,t,i,u;return(n[CommandUI.Controls.a.On]=!1,t=n.MenuItemId,!t||!t.length)?!0:Common.D.a(this.h)?!0:(this.q=_Ewa.f.c(n.ParentMenuId,"FormatAsTable",!0)?!0:!1,this.q||this.S(),_Ewa.bE.k(n)&&(t=this.e(t).toString()),i=this.u(),n.Alt=t==="-1"?_Ewa.ClientStringManager.a().a(1871):_Ewa.bE.j(this.H(t),i),t in this.m&&i.g(this.t))?(this.P(n,t,i,!0),r=_Ewa.q.a().b().m,e=r-f,!0):(this.x&&(!this.x||this.x.c())||(this.w={},u=this,this.x=_Ewa.B.a().a(function(){u.R(!1);u.t=u.u()},0,_Ewa.o.cT,!0,!0)),this.Y(i,n,t),r=_Ewa.q.a().b().m,e=r-f,!0)},N:function(n){var t=-1;return!n||!n.length||Common.D.a(this.h)?t:n in this.h?this.h[n].Index:(this.b("getTableStyleIndexFromName"),t)},a:function(){return!!this.i},e:function(n){return(this.o||this.F(),!(n in this.o))?-1:this.o[n]},b:function(n){var t,u,i,f,r,e;this.j.j()&&(_Ewa.a.c("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)?(i=new Date,(_Ewa.bn.b(this.v,i)>30||Common.D.a(this.h)||this.s)&&(f=this.j.c().a().b(!1),this.v=i,r=this.s&&n==="accessibilityTab"||n==="galleryMenuClosed",e=r?"accessibility":"normal",_Ewa.k.O(this.j.c().a(),r,this.D,this.C,null,e,f))):(t=new Date,(_Ewa.bn.b(this.v,t)>30||Common.D.a(this.h))&&(u=this.j.c().a().b(!1),this.v=t,_Ewa.k.N(this.j.c().a(),this.D,this.C,null,null,u))))},T:function(){this.i?this.j.b().bw(this.M):this.b("tableStyleManagerInitialization")},dispose:function(){this.h=null;this.i=null;this.m=null;this.o=null;this.j.i().g(this.E);_Ewa.bV.prototype.dispose.call(this)},d:function(n){this.et("RefreshTableStyleGallery",n)},W:function(n,t,i){var u=!1,y=_Ewa.a.c("Microsoft.Office.Excel.AccessibleAuthoringTab",!1),k,r,s,h,l,w,f,tt,it,a,b,v,e,c,o;if(_Ewa.O.a(n)){k=n.Errors[0].MessageId;k!==-315732528&&(Diag.a.a(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",_Ewa.i.a(n.Errors,",")),this.O(null,t,i));return}if(Diag.a.a(42821708,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),r=n.Result,r&&r.TableStyleItems.length){var rt=r.TableStyleItems.length>60,d=!1,g=!1;if(this.i)for(h=0;h<60;++h){if(l=r.TableStyleItems[h],w=this.i.TableStyleItems[h],y&&l.HasStyleViolations!==w.HasStyleViolations){g=!0;u=!0;break}for(f=0;f<9;f++){if(f>=l.TableStyleElementsList.length)break;if(tt=l.TableStyleElementsList[f],it=w.TableStyleElementsList[f],!_Ewa.f.b(tt.BackgroundColor,it.BackgroundColor,!1)){d=!0;u=!0;break}}}else{this.n=0;for(var nt=r.TableStyleItems,ut=nt.length,p=0;p<ut;++p)s=nt[p],s.TableStyleElementsList&&s.TableStyleElementsList.sort(_Ewa.bE.m),this.h[s.Name]=s}if(d||g)for(a=0;a<60;++a)b=r.TableStyleItems[a],this.h[b.Name]=b;if(rt&&this.i)for(Diag.a.a(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",r.TableStyleItems.length-60),u=!0,v=60;v<r.TableStyleItems.length;++v)e=r.TableStyleItems[v],e.Name in this.h||e.TableStyleElementsList&&e.TableStyleElementsList.sort(_Ewa.bE.m),this.h[e.Name]=e;if($$sc.j.a(this.h).length!==r.TableStyleItems.length)for(u=!0,c=60,o=60;o<this.i.TableStyleItems.length;)c>=r.TableStyleItems.length?delete this.h[this.i.TableStyleItems[o].Name]:c>=r.TableStyleItems.length||!_Ewa.f.b(r.TableStyleItems[c].Name,this.i.TableStyleItems[o].Name,!1)?delete this.h[this.i.TableStyleItems[o].Name]:++c,++o;this.i=r;this.R(u);u&&this.F();y&&t&&(t==="accessibility"?(this.s=!1,this.z=!0):this.z=!1);this.J||(this.V()&&this.j.t(),this.J=!0);this.B=0;this.r||this.G?y&&this.z&&this.es("RefreshTableStyleGallery",null,null):(this.es("RefreshTableStyleGallery",null,null),this.G=!0)}},O:function(){if(Diag.a.a(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed"),this.B++,this.B<5){var n=this;_Ewa.B.a().a(function(){n.b("getTableStylesFailed")},1e3,_Ewa.o.o,!0,!0)}},F:function(){var t={},n,i;for(this.l.a()&&(this.k=this.N(this.l.a().ba)),n=1;n<=7;n++)i="preview"+n,t[i]=this.U(n);this.o=t},U:function(n){var t=n,r=this.i.TableStyleItems.length,i=Math.ceil(7/2);return t=this.k<=i?this.k+n-1:this.k>i&&this.k<r-i?n===i?this.k:Math.floor(this.k+n-i):this.k+n-1,t===-1||t.toString()in this.m||(t=n-3),t},S:function(){var t,n,i,r,u;if(this.l.a()){if(t=!1,n=this.N(this.l.a().ba),n===this.k)return;if(this.o){i=this.o;for(r in i)u={key:r,value:i[r]},u.value===n&&(t=!0)}this.k=n;t||Common.D.a(this.m)||this.F()}},A:function(n,t,i){var r=this.p.b();r.b("Thin");r.c(_Ewa.ClientStringManager.a().a(i));r.a().push(t);n.a().push(r)},u:function(){var n=this.l.a();return this.q||!n?new _Ewa.bE.n(!0,!1,!1,!1,!0,!1):new _Ewa.bE.n(_Ewa.bz.b(n),_Ewa.bz.c(n),_Ewa.bz.f(n),_Ewa.bz.g(n),_Ewa.bz.h(n),_Ewa.bz.e(n))},R:function(n){var t={},i={},u=this.u(),f,e,o;if(!Common.D.a(this.h)&&(this.l.a()&&this.S(),!u.g(this.t)||n||Common.D.a(this.m))){this.n=(this.n+1)%5;f=this.h;for(e in f){var h={key:e,value:f[e]},r=h.value,s=_Ewa.bE.b(r,this.n,"");t[r.Index.toString()]=_Ewa.bE.f(_Ewa.bE.c(_Ewa.bE.d(r,u)),s);i[s]=t[r.Index.toString()];this.L(i)}o=_Ewa.bE.b(null,this.n,"-1");t["-1"]=_Ewa.bE.f(_Ewa.bE.c(_Ewa.bE.d(null,u)),o);i[o]=t["-1"];this.L(i);_Ewa.dG.a(this.m,t,!1)}},V:function(){var n=_Ewa.bP.a(this.j);return n?n.a().a()==="Table":!1},Y:function(n,t,i){var r=Number.parseInvariant(i);i==="-1"&&_Ewa.f.c(t.ParentMenuId,"FormatAsTable",!0)||this.P(t,i,n,!1)},P:function(n,t,i,r){var f=_Ewa.bE.b(null,this.n,t),o,u,e,s,c,h;_Ewa.bE.k(n)?(o=[],f in this.w?o=this.w[f]:(o=_Ewa.bE.c(_Ewa.bE.d(this.H(t),i)),this.w[f]=o),n[CommandUI.Controls.a.GalleryButtonProps]=(u=new Common.gn,u.Command="-123538519",u.QueryCommand="QueryTableStyle",u.Id=f,u.Alt=n.Alt,u.MenuItemId=t,u.TableCellStyles=o,u.TableStyles=this.Q,u)):(n[CommandUI.m.Icon]=f,n[CommandUI.Controls.a.GalleryButtonProps]=(e=new Common.dH,e.Command="-123538519",e.QueryCommand="QueryTableStyle",e.Id=f,e.Alt=n.Alt,e.MenuItemId=t,e),r||(s=[],c=this.H(t),t==="-1"||_Ewa.f.c(n.ParentMenuId,"FormatAsTable",!0)||(s=_Ewa.bE.d(this.i.TableStyleItems[Number.parseInvariant(t)],i)),this.m[t]=_Ewa.bE.f(_Ewa.bE.c(s),f),h={},h[f]=this.m[t]))},L:function(n){var f,t,r,u,i,e;if(this.r){f=this;this.y=function(){f.L(n)};return}this.y=null;t=[];r=n;for(u in r)i={key:u,value:r[u]},i.key in this.K?t.push(i.key):this.K[i.key]=!0;try{t.length>0&&appChrome.api.unregisterIcons(t);Common.D.a(n)||(e=this,appChrome.api.registerIconProvider(function(){return n}))}catch(o){}},H:function(n){var t=Number.parseInvariant(n),i,r;if(t===-1||!this.i)return null;if(t>60)for(i=60;i<this.i.TableStyleItems.length;++i)if(r=this.i.TableStyleItems[i],r.Index===t)return r;return this.i.TableStyleItems[t]},X:function(){if(this.r){this.r=!1;this.y&&this.y();var n=this;_Ewa.B.a().a(function(){n.b("galleryMenuClosed")},1e3,_Ewa.o.o,!0,!0)}}};_Ewa.Zv=function(n){_Ewa.Zv.initializeBase(this);this.i=n;this.l()};_Ewa.Zv.prototype={m:null,i:null,a:function(){this.k(this.m||(this.m=new _Ewa.Zu(this.i)))}};_Ewa.Zx=function(n){_Ewa.Zx.initializeBase(this);this.i=n;this.l()};_Ewa.Zx.prototype={m:null,i:null,a:function(){var t=_Ewa.l.a(_Ewa.dS,this.i.a(),102,this.h(),this.j,null),i=_Ewa.l.b(_Ewa.dA,this.i.a(),66,134,this.j,null),n=this;_Ewa.g.a($$sc.a.WAA(t,i),function(){n.k(n.m||(n.m=new _Ewa.Zw(n.i,t.a(),i.a())))},this.i.g(),8,null,null)}};_Ewa.eq=function(n){this.l=Function.createDelegate(this,this.F);this.r=Function.createDelegate(this,this.N);this.o=Function.createDelegate(this,this.K);this.p=Function.createDelegate(this,this.L);this.q=Function.createDelegate(this,this.M);this.m=Function.createDelegate(this,this.I);this.n=Function.createDelegate(this,this.J);_Ewa.eq.initializeBase(this,[document.createElement("div"),null]);this.b=n;this.a=_Ewa.c.a(this.b);this.d=this.cx();this.d.className="ewa-ttrd-buttonarea";this.g=this.a.D();this.e=!0;this.G();this.x();this.f(!1);Diag.a.a(595195099,0,50,"TableTotalRowOptions - React Component Created ")};_Ewa.eq.prototype={h:!1,s:!1,e:!1,j:!1,i:!1,b:null,a:null,k:null,g:null,c:function(n){return this.j!==n&&(this.cB(n),this.j=n),n},d:null,B:function(){return!!(this.b.s()&16)},A:function(){var n=this.a.a().a().a();return n.d===n.r},t:function(){var n=this.a.g(null);return!n||!this.a.bg(n.b())?(n&&Diag.a.a(594890818,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null):this.D(n)},dispose:function(){this.b&&this.z();this.g=null;this.d=null;this.a=null;this.b=null;_Ewa.bdU.prototype.dispose.call(this)},C:function(n){var t=this.E(this.a.g(null).b());return t?String.format("=SUBTOTAL({0},{1})",n,t):null},E:function(n){var i=_Ewa.c.a(this.b).e().a(n,!1),t;return i?(t=_Ewa.bz.a(i,!1),t.d=t.b=n.b,t.toString()):null},G:function(){_Ewa.eq.a={};_Ewa.eq.a["100"]=_Ewa.ClientStringManager.a().a(1024);_Ewa.eq.a["101"]=_Ewa.ClientStringManager.a().a(1027);_Ewa.eq.a["102"]=_Ewa.ClientStringManager.a().a(1026);_Ewa.eq.a["103"]=_Ewa.ClientStringManager.a().a(1031);_Ewa.eq.a["104"]=_Ewa.ClientStringManager.a().a(1028);_Ewa.eq.a["105"]=_Ewa.ClientStringManager.a().a(1029);_Ewa.eq.a["109"]=_Ewa.ClientStringManager.a().a(1025);_Ewa.eq.a["107"]=_Ewa.ClientStringManager.a().a(1032);_Ewa.eq.a["110"]=_Ewa.ClientStringManager.a().a(1034);_Ewa.eq.a["111"]=_Ewa.ClientStringManager.a().a(1085)},O:function(){var t=this.a.g(null),n,r,i;if(t){if(n=t.n()?t.f():null,n)if(r=n.substring(0,10),r==="=SUBTOTAL("){if(i=n.substring(10,13),i in _Ewa.eq.a)return i}else return"111";return"100"}return"100"},x:function(){this.a.b().g(this.n);this.a.a().e(this.m);this.a.B(this.q);this.a.k().d(this.p);this.a.k().h(this.o)},z:function(){this.a&&(this.a.a()&&(this.a.a().i(this.m),this.a.b().c(this.n)),this.a.I(this.q),this.a.k()&&(this.a.k().c(this.p),this.a.k().f(this.o)),this.w())},f:function(n){if(this.Q(n),this.B()){if(this.P(),!this.t()){Diag.a.a(51513356,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined");this.c(!1);return}this.s||this.y();this.i?this.c(!1):(this.c(!0),this.u())}},u:function(){var n=this;appChrome.renderTableTotalRowOptions(this.d,_Ewa.eq.a,_Ewa.eq.a[this.O()].toString(),Math.round(_Ewa.u.a(this.b).b(17)),function(t){Diag.a.a(51513357,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",t);var i=null;if(i=_Ewa.a.a("OfficeVSO:5347991_AddComponentNamesToReport")?{SelectedOption:_Ewa.eq.a[t],FunctionKeyCode:t,Location:Common.n.toString(30)}:{SelectedOption:_Ewa.eq.a[t],FunctionKeyCode:t},_Ewa.Z.a(n.b).a(_Ewa.w.bO,i,null,!0),t==="111")return n.H(),!0;if(t!=="100"){if(n.k=n.C(t),!n.k)return Diag.a.a(594113797,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;n.v(n.k)}else n.v("");return _Ewa.b.c(n.a.f().a().cx(),!1),!0})},H:function(){Diag.a.a(594056920,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var n=new _Ewa.L(753860909,0,this.b.j()?2:1,19,null);this.b.i().a(n,null,null)},D:function(n){var t,i,u,r,f,e,o,s;if(!n)return null;if(i=this.a.k().a().cx(),u=_Ewa.b.ba(i)>0&&_Ewa.b.G(i)>0&&i.offsetTop>=0&&i.offsetLeft>=0,u?t=_Ewa.b.bj(i,this.a.D()):(r=this.a.Q(n.a()),f=_Ewa.b.h(this.a.D()),t=new Sys.UI.Bounds(r.x-f.x,r.y-f.y,r.width,r.height)),t)if(u)t.height>2&&t.height>2&&(t.x+=1,t.y+=1,t.height-=2,t.width-=2);else if(e=_Ewa.c.a(this.b).Z(n.a()),e)o=e.c(),s=_Ewa.f.b(_Ewa.ch.b(n.a(),this.a.d()),"right",!0),this.a.d()&&s&&(t.x=t.x+t.width-o),n.p()&&this.a.d()===s&&(t.width=o);else return null;return t},Q:function(n){var t=this.t(),i,r,u;if(!t){this.c(!1);return}i=t.height<=17?t.y:t.y+t.height-19;r=this.A()?this.a.d()?t.x:t.x+t.width-(t.height>17?17:t.height):this.a.d()?t.x-(t.height>17?17:t.height):t.x+t.width;u=_Ewa.u.a(this.b).f(new Sys.UI.Point(r,i));this.d.style.top=u.y+"px";this.d.style.left=u.x+"px";_Ewa.u.a(this.b).w(this.d);n&&this.c(this.a.bP(new _Ewa.T(r,i)))},y:function(){this.g.insertBefore(this.d,this.g.firstChild);this.s=!0},P:function(){this.h||(this.a.j().d(this.r),this.h=!0)},w:function(){this.h&&this.a.j()&&(this.a.j().c(this.r),this.h=!1)},v:function(n){var f=this.a.f(),i=this.a.g(null),t,r,u;i&&(r=(t=new _Ewa.dL,t.Text=n,t),u=127,this.a.bh(r,i.b(),0,u,null,0,null),f.i(!0,"TableTotalRowOptions.SetCellContent",0,null))},I:function(){_Ewa.eD.c(this.b,this.a.a().a().a())?(this.e=!0,this.f(!1)):(this.e=!1,this.c(!1),this.w())},N:function(){this.e?this.f(!0):this.c(!1)},L:function(){this.i=!0;this.e&&this.c(!1)},M:function(){this.b.j()?_Ewa.eD.c(this.b,this.a.a().a().a())&&(this.e=!0,this.f(!1)):this.c(!1)},K:function(){this.i=!1;this.e?this.f(!1):this.c(!1)},J:function(n,t){if(this.e){var i=this.a.cE(t.a.a.q.Information.BlockCachePosition.PaneType).U(t.a.b);i&&(i.k(this.l),i.h(this.l))}},F:function(){this.u()}};_Ewa.Tn.registerClass("_Ewa.Tn");_Ewa.Tp.registerClass("_Ewa.Tp");_Ewa.To.registerClass("_Ewa.To");_Ewa.Tr.registerClass("_Ewa.Tr");_Ewa.zw.registerClass("_Ewa.zw",_Ewa.Tr);_Ewa.Ts.registerClass("_Ewa.Ts");_Ewa.Zu.registerClass("_Ewa.Zu",_Ewa.boS,_Ewa.dA,Sys.IDisposable);_Ewa.nR.registerClass("_Ewa.nR",_Ewa.jY);_Ewa.Zw.registerClass("_Ewa.Zw",_Ewa.bV,_Ewa.kI,Sys.IDisposable);_Ewa.Zv.registerClass("_Ewa.Zv",_Ewa.sY.$$(_Ewa.dA));_Ewa.Zx.registerClass("_Ewa.Zx",_Ewa.sY.$$(_Ewa.kI));_Ewa.eq.registerClass("_Ewa.eq",_Ewa.bdU,Sys.IDisposable);_Ewa.nR.a=[27];_Ewa.bE.l=[null,"solid","dashed","dotted","dashed","dotted","dashed","double"];_Ewa.bE.h=["border-top","border-bottom","border-left","border-right"];_Ewa.bE.g=_Ewa.bE.s();_Ewa.bE.e=null;_Ewa.eq.a=null;_Ewa.boT.a();Type.registerNamespace("_Ewa");_Ewa.Zq=function(n,t,i){this.d=t;this.a=n;this.b=this.a.o().b("UserAction","ConvertToRangeManager");this.e=i};_Ewa.Zq.prototype={a:null,d:null,b:null,e:null,c:!1,j:function(){var n,t,i;return this.b.d(),n=this.a.c().a().b(!1),_Ewa.a.a("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?(t=this,_Ewa.eZ.c(this.a.c().a(),this.d,function(n){t.k(n)},null,null,null,n)):(i=this,_Ewa.eZ.c(this.a.c().a(),this.d,function(n){i.l(n)},null,null,null,n))},k:function(n){if(Diag.a.a(41714579,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.b.b()),n&&!_Ewa.O.a(n))if(this.c=n.Result,this.c){var i=_Ewa.i.b(3,2,0,706,0,-66108047,"ConvertToRange"),t=this;_Ewa.g.a(_Ewa.A.a(this.a).e(i),function(n){Diag.a.a(41714580,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",t.b.b());n.a()||t.g()},this.a.g(),11,null,null)}else this.h();this.b.a();Diag.a.a(41714581,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.b.b())},l:function(n){return new _Ewa.Zq.a(this,n)},f:function(){var n={};return n.IsQueryTable=this.c,n.Range=this.d,n},g:function(){var t=this.a.c().a(),n;Diag.a.a(41461400,0,50,"Convert To Range initiated for Query Table");n=this;this.i(194,function(i,r,u){return _Ewa.eZ.h(t,n.f(),i,r,u,null,null)},null);Diag.a.a(41461401,0,50,"Convert To Range completed for Query Table")},h:function(){var n=this.a.c().a();Diag.a.a(41461402,0,50,"Convert To Range initiated for Normal Table");var t=this,i=function(){return new _Ewa.Tn(t.e)},r=this;this.i(193,function(t,i,u){return _Ewa.eZ.g(n,r.f(),t,i,u,null,null)},i);Diag.a.a(41461403,0,50,"Convert To Range completed for Normal Table")},i:function(n,t,i){var u=this,r=function(t){return new _Ewa.t(n,0,t,0,i)};return _Ewa.F.a(this.a.f(),t,r,null)}};_Ewa.Zq.a=function(n,t){this.h=Function.createDelegate(this,this.moveNext);this.a=n;this.i=t;this.c=t;this.e=this.l;this.moveNext()};_Ewa.Zq.a.prototype={c:null,i:null,a:null,f:null,g:0,d:null,e:null,b:0,l:function(){return(Diag.a.a(554997633,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.a.b.b()),this.c&&!_Ewa.O.a(this.c))?(this.a.c=this.c.Result,this.a.c)?(this.f=_Ewa.i.b(3,2,0,706,0,-66108047,"ConvertToRange"),this.d=_Ewa.A.a(this.a.a).e(this.f).G(),this.d.b.b>3||(this.b=2,this.d.a(this.h)),this.m):(this.a.h(),this.k):this.j},j:function(){this.a.b.a();Diag.a.a(554997603,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.a.b.b());this.b=3},k:function(){return this.j},m:function(){return this.g=this.d.c(),Diag.a.a(554997632,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.a.b.b()),this.g||this.a.g(),this.k},dispose:function(){},moveNext:function(){try{for(this.b=1;this.b===1;)this.e=this.e()}catch(n){this.b=3}}};_Ewa.boP=function(n,t){_Ewa.boP.initializeBase(this,[n,t,!0,3,_Ewa.a.b(424),!1]);this.B=!0};_Ewa.boP.prototype={b:null,C:null,A:null,B:!1,dispose:function(){this.C=null;this.A=null;this.b=null;_Ewa.bas.prototype.dispose.call(this)},F:function(){var t=this.u()?"ewa-dlg-checkbox-wrapper-div":"",n="<div id = 'ctd'class='ewa-dlg-body-sectionlabel' aria-live='polite' aria-atomic='true'>\r\n\t<span>{0}<\/span>\r\n\t<span id='tableDataRange' class='ewa-dlg-columnName'>{1}<\/span>\r\n<\/div>\r\n<div  class='ewa-dlg-body-sectionbreak "+t+"'>\r\n\t<input type='checkbox' id='{2}' disabled='true' class='ewa-dlg-input' />\r\n\t<label for='{2}' class='ewa-dlg-label'>{3}<\/label>\r\n<\/div>";n=String.format(n,_Ewa.ClientStringManager.a().a(703),_Ewa.ClientStringManager.a().a(704),"hasHeaders",_Ewa.ClientStringManager.a().a(702));this.E.innerHTML=n;this.u()||(this.I(),this.bc(),this.er.setAttribute("aria-describedby","ctd"));_Ewa.bas.prototype.F.call(this)},I:function(){this.C=_Ewa.b.a(this.E,"tableDataRange");this.A=_Ewa.b.a(this.E,"hasHeaders")},bJ:function(){var n=this.D,i=_Ewa.h.a(_Ewa.c.a(n).a().a().c(),n),r=n.c().a().b(!1),t=this;return function(u,f,e){return _Ewa.k.A(n.c().a(),i,t.bK(u),t.bA(f),e,null,r)}},Q:function(){var i=this.b.TableRange,n=_Ewa.h.b(i),t,r,u;if(this.A.checked){if(t=n.f(),t.K(2,n.a),r=_Ewa.c.a(this.D).bc(t),_Ewa.c.a(this.D).e().g(t)&&!_Ewa.c.a(this.D).e().y(t))return u=new _Ewa.Zt(this.D,i,this.b.HasTotalRow),!0}else n.c=n.c+1;return _Ewa.c.a(this.D).a().d(n,n,0,0,!0,"",!1,!0,!0),_Ewa.bas.prototype.Q.call(this)},bg:function(){var n=this;return function(){return new _Ewa.zC(n.A.checked,n.b.TableRange)}},H:function(){var n=this.n(1),t;n&&(this.B?n.get_element().focus():(t=this.n(0),t.get_element().focus()))},R:function(n,t,i){var u=this.b=n.Result,f=this.A,r;(f.checked=u.HasHeaders,f.disabled=!1,this.C.innerText=u.StringTableRange,_Ewa.bpz.prototype.R.call(this,n,t,i),r=this.n(0),r)&&(r.get_element().disabled&&(r.get_element().disabled=!1),this.B=!1)}};_Ewa.CJ=function(n){this.M=Function.createDelegate(this,this.T);_Ewa.CJ.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(699)])};_Ewa.CJ.prototype={f:function(){return"CreateTableDialog"},W:function(){return 206},U:function(){var n=this;return function(t,i,r){return _Ewa.eZ.a(n.D.c().a(),n.b.TableRange,n.A.checked,!1,n.b.HasTotalRow,_Ewa.n.a(t,n.M),i,r,null,null)}},R:function(n,t,i){_Ewa.boP.prototype.R.call(this,n,t,i)},T:function(){_Ewa.bP.a(this.D).g(1);var n=_Ewa.c.a(this.D).a().a().c();this.Y(n)},Y:function(n){if(_Ewa.a.c("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)){var t=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fM,this.D.a(),430,431,1,null),function(t){var i=t.a();i.a(n);Diag.a.a(541131086,306,50,"CreateTableDialog:TriggerPivotTableHandRaise Trigger hand raise from create table.")},this.D.g(),3,null,null)}}};_Ewa.Zr=function(n,t){this.M=-1;_Ewa.Zr.initializeBase(this,[n,_Ewa.ClientStringManager.a().a(700)]);this.M=t};_Ewa.Zr.prototype={f:function(){return"FormatAsTableDialog"},W:function(){return 215},bg:function(){var t=_Ewa.h.i(this.b.TableRange),n=this;return function(){return new _Ewa.zw(t,n.A.checked,n.M,!0)}},U:function(){var t=_Ewa.h.i(this.b.TableRange),n=this;return function(i,r,u){return _Ewa.eZ.b(n.D.c().a(),t,n.A.checked,!1,n.b.HasTotalRow,n.M,i,r,u,null,null)}},R:function(n,t,i){_Ewa.boP.prototype.R.call(this,n,t,i)}};_Ewa.Zs=function(n){this.bp=Function.createDelegate(this,this.bD);this.bA=Function.createDelegate(this,this.bW);_Ewa.Zs.initializeBase(this,[n,null,!1,!1,!1]);this.W=_Ewa.c.a(n);this.bg=this.W.a().a();this.H=this.W.e().a(this.bg.a(),!1).O;var t=this.H.toString(),i=this.bL(t);this.A(_Ewa.ClientStringManager.a().a(701),this.bA,i)};_Ewa.Zs.prototype={bg:null,W:null,H:null,f:function(){return"ResizeTableDialog"},bW:function(n,t){if(n===1){var i=t.range;this.bX(_Ewa.h.b(this.bB(i)))}},bB:function(n){var t,u,i,f,e,o,s,r;return(n=n.startsWith("=")?n.substring(1,n.length):n,(s=_Ewa.h.g(n,this.b.d(),f={val:t},e={val:u},o={val:i}),t=f.val,u=e.val,i=o.val,s)&&i)?(r=_Ewa.h.a(i,this.b),r.SheetName=_Ewa.f.b(t,"",!0)?this.b.h().a():t,r):null},bL:function(n){return{id:"ResizeTableDialog",range:n,getInputErrorIfInvalid:this.bp}},bK:function(n){var t=this.bB(n),i;return t?(i=_Ewa.h.b(t),!_Ewa.f.b(t.SheetName,this.b.h().b(),!0)||this.H.a!==i.a||!this.H.h(i))?2:0:1},bD:function(n){var t=this.bK(n);return this.bC(t)},bC:function(n){var t="";switch(n){case 1:t=_Ewa.ClientStringManager.a().a(72);break;case 2:t=_Ewa.bW.a(_Ewa.ClientStringManager.a().a(71))}return t},bX:function(n){var t={ResizeTableRange:n,OriginalTableRange:this.H};this.b.v(-1400250766,_Ewa.K.a,8,t)}};_Ewa.to=function(n,t,i,r){this.n=Function.createDelegate(this,this.F);this.o=Function.createDelegate(this,this.G);this.j=Function.createDelegate(this,this.J);this.p=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.I);this.a=n;this.b=t;this.h=i;this.k=this.a.r();this.m=_Ewa.c.a(this.a).a();this.c=this.m.a();this.i=_Ewa.a.c("Microsoft.Office.Excel.CanvasHitTest",!1);this.d=r;this.d.d(this.q)};_Ewa.to.a=function(n,t){t.SheetName=n.h().a();t.NamedObjectView=n.b().b()};_Ewa.to.prototype={a:null,d:null,k:null,f:null,m:null,c:null,e:-1,i:!1,b:null,h:null,z:function(n,t){switch(t){case-544558380:return!(this.b&&this.c.g()&&!this.g()&&_Ewa.bz.b(this.b.a()));case 1544516694:return!(this.b&&(this.c.g()?!this.g():this.c.m()));case-697806646:case 323142015:return!this.c.g();case 341449783:case 2128797448:return!(this.b&&this.b.f(this.c.a()));case-123538519:return!(this.c.g()&&this.d&&this.d.a());case 756677940:return!(_Ewa.a.b(437)&&this.C());case 753331043:case 2105103744:case-585683120:return!(this.d&&this.D());case 844144422:return!this.c.g()}return!1},x:function(n,t,i){var k=_Ewa.g.c(),f=this.a.c().a(),r=null,u=1,s=t.a,h=this.a.c().a().b(!1),e=null,c,y,wt,bt,p,w,d,ht,ct,kt,g,nt,b,tt,it,lt,rt,ut,ft,l,dt,at,o,ui,fi,a,v,ei,oi,ot,si,hi,st,pt;switch(s){case-2058042992:y=_Ewa.E.b(i.CommandValueId);_Ewa.to.a(this.a,y);wt=this;r=function(n,t,i){return _Ewa.eZ.e(f,y,null,null,!1,!1,!1,_Ewa.dh.b(_Ewa.boV.a.a,_Ewa.dh.a.a,n),t,i,null,null)};u=176;bt=this;e=function(){return new _Ewa.SX(y)};break;case 504133448:case-798968736:case 477776686:if(p=_Ewa.E.b(i.CommandValueId),w=i.TopCellAddress,_Ewa.to.a(this.a,p),d=t.a===504133448?1:t.a===-798968736?2:3,_Ewa.a.c("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&w&&this.a.j()&&(ht=this.b.b(w),!this.a.R([ht],!0,1,0)))break;ct=this;r=function(n,t,i){return _Ewa.k.E(f,p,d,_Ewa.n.a(n,ct.p),t,i,w,h)};u=177;kt=this;e=function(){return new _Ewa.SH(p,d)};break;case 341449783:case 2128797448:this.e=s===341449783?0:2;c=this.l();g=this;r=function(n,t,i){return _Ewa.eZ.d(f,c,g.e,_Ewa.n.a(n,g.j),t,i,null,h)};u=196;break;case-712419744:this.i?this.s(i.event):this.s(null);break;case 1868184698:nt=new _Ewa.CJ(this.a);nt.F();nt.z(!1);break;case 844144422:new _Ewa.Zs(this.a);break;case 1544516694:case-544558380:b=i.MenuItemId;!b||!b.length||(this.e=this.B(b),tt=this.c.m(),this.e!==-1&&(Diag.a.a(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",tt?"PivotTable":"table",this.e),c=this.l(),it=this,r=function(n,t,i){return _Ewa.eZ.d(f,c,it.e,_Ewa.n.a(n,it.j),t,i,null,h)},u=196,lt=this,e=function(){return new _Ewa.Ts(c,lt.e,tt)}));break;case 756677940:if(this.g()&&this.t()){Diag.a.a(594130064,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}if(rt=i.Text,ut=this.u(),ut)ft=this,r=function(n,t,i){return _Ewa.eZ.i(f,rt,ut,_Ewa.n.a(n,ft.o),_Ewa.n.b(t,ft.n),i,h,null)},u=217,l=null,this.b.a()?l=this.b.a().N:this.b.e()?l=this.b.e().N:Diag.a.a(594130063,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command"),l&&(dt=this,e=function(){return new _Ewa.To(l,rt)});else return Diag.a.a(50679901,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),$$sc.a.a(Boolean,!1);break;case 323142015:if(this.g())break;return c=this.l(),at=new _Ewa.Zq(this.a,c,this.b.a().N),at.j();case-1400250766:u=211;r=this.L(i,f,h);var gt=i.OriginalTableRange,ni=_Ewa.h.t(gt,this.a.d().a()),ci=this;e=function(){return new _Ewa.Tp(ni)};break;case 1872288872:this.b.t();break;case-123538519:var et=this.A(i),ti=i.MenuItemId,ii=_Ewa.f.c(ti,"preview",!0)||_Ewa.f.c(i.SourceControlId,"TableStyleIcon",!0),ri=ii?"Preview Gallery":"Pop-out Gallery";Diag.a.a(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",ri,et.toString());o=this.r();o&&(ui=this,r=function(n,t,i){return _Ewa.eZ.f(f,o,et,n,t,i,null,h)},fi=this,e=function(){return new _Ewa.Tr(o,et)},u=212);break;case 753331043:if(a=i.MenuItemId,!a||!a.length)break;v=Number.parseInvariant(a);this.c.g()?(Diag.a.a(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",v),o=this.r(),o&&(ei=this,r=function(n,t,i){return _Ewa.eZ.b(f,o,!1,!1,!1,v,n,t,i,null,h)},oi=this,e=function(){return new _Ewa.zw(o,!1,v,!1)},u=215)):(Diag.a.a(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",v),ot=new _Ewa.Zr(this.a,Number.parseInvariant(a)),ot.F(),ot.z(!1));break;case 71074531:var vt=i.HasHeader,yt=i.TableRange,li=this;r=function(n,t,i){return _Ewa.eZ.a(f,yt,vt,!1,!1,n,t,i,null,null)};si=this;e=function(){return new _Ewa.zC(vt,yt)};u=206;break;default:return _Ewa.Y.a(s)}return r&&(hi=this,st=function(n){return new _Ewa.t(u,0,n,0,e)},this.h&&(s===-2058042992||s===504133448||s===-798968736||s===477776686)?(pt=this,k=this.h.a().CW(function(n){var i=n.a();i&&_Ewa.F.a(pt.a.f(),r,st,t)})):k=_Ewa.F.a(this.a.f(),r,st,t)),k},L:function(n,t,i){var u=n.ResizeTableRange,r=n.OriginalTableRange,f=_Ewa.h.t(u,this.a.d().a()),e=this,o=function(){e.b.h(r)},s=this,h=function(n){n.Errors&&s.b.h(r)},c=this;return function(n,r,u){return _Ewa.eZ.j(t,f,_Ewa.n.a(n,h),_Ewa.n.b(r,o),u,null,i)}},A:function(n){var i=-1,t;return _Ewa.f.a(n.MenuItemId)||(t=n.MenuItemId,i=_Ewa.f.c(t,"preview",!0)?this.d.e(t):Number.parseInvariant(n.MenuItemId)),i},w:function(n,t){var i=!1;switch(t.a){case-2058042992:case 504133448:case-798968736:case 477776686:case 341449783:case 2128797448:case-712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case-544558380:case-1400250766:case-123538519:case 753331043:case 844144422:case 71074531:i=!0;break;case 756677940:i=_Ewa.a.b(437)}return i},y:function(n,t,i){var r=!1;switch(t){case"PopulateTableMoreStylesMenu":this.f=i.MenuId;this.d.a()||this.d.b("formatAsTableMenu");r=this.d.c(n,t,i);break;case"PopulateTableAccessibleStylesMenu":this.f=i.MenuId;this.d.a()||this.d.b("accessibilityTab");r=this.d.c(n,t,i)}return r},I:function(){this.K()},K:function(){(_Ewa.f.c(this.f,"Format",!0)||_Ewa.f.c(this.f,"Accessible",!0))&&this.f&&this.k.p(this.f)},l:function(){var n=this.c.a();return _Ewa.h.a(n,this.a)},u:function(){var n=this.b.n();return n?_Ewa.h.a(n,this.a):null},s:function(n){var f,l,e,o,r,s,h,a,v;if(this.b){var c=_Ewa.c.a(this.a),t=this.c.a(),u=this.b.b(t),i=null;if(!u||u.t)for(f=c.bs().$$ge();f.$$mn();)for(l=f.$$cu(),e=l.$$ge();e.$$mn();)o=e.$$cu(),r=o.a(),t.b>=r[0]&&t.b<=r[r.length-1]&&(s=o.m(t,!1,!1).b(!1),i=s?_Ewa.b.f(s,"af-img",!1):null);else{if(h=c.g(_Ewa.p.a(u.a,t.b,!1)),this.i){a=this;_Ewa.B.a().a(function(){h.H(8,n)},0,_Ewa.o.m,!0,!0);return}i=h.o(56,"click").a}i&&(v=this,_Ewa.B.a().a(function(){_Ewa.b.P(i,null)},0,_Ewa.o.m,!0,!0))}},B:function(n){var t=Number.parseInvariant(n);return t>-1&&t<=8?t:-1},J:function(n){var r,u;if(!this.c.m()&&(_Ewa.a.a("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")&&!(_Ewa.O.a(n)||this.g())||!(_Ewa.O.a(n)&&this.g()))){var i=this.c.a(),t=this.c.e(),f=this.b.a().O;this.e===2&&_Ewa.bz.c(this.b.a())&&i.c===f.c&&(r=t.I()?new _Ewa.p(t.a-1,t.b,t.c-1,t.d,!1,!0):new _Ewa.p(t.a,t.b,t.c-1,t.d,!1,!0),u=r.i(i)?i:_Ewa.p.a(r.c,i.b,!1),_Ewa.c.a(this.a).a().d(r,u,0,3,!0,"",!1,!0,!0))}},G:function(n){if(_Ewa.O.a(n)){Diag.a.a(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input");this.a.t();return}Diag.a.a(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")},F:function(){Diag.a.a(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.a.t()},g:function(){return!this.b.a()},t:function(){var n=this.b.e();return n?!1:(Diag.a.a(594130059,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)},D:function(){var n=this.c.g(),t=this.c.d()&&!_Ewa.c.a(this.a).e().f(this.c.c());return n||t},C:function(){return this.c.g()||!this.t()},v:function(n){for(var o,t,i,r=[],e=n,h=e.length,u=0;u<h;++u)if(o=e[u],t=_Ewa.eD.a(this.a,o,!1,!1),t&&t.length)for(var s=t,c=s.length,f=0;f<c;++f)i=s[f],i.O&&!Array.contains(r,i.O)&&Array.add(r,i.O);return r},r:function(){var r=this.c.b(),n=[],i;if(_Ewa.a.a("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))n=this.v(r);else for(var u=r,f=u.length,t=0;t<f;++t)i=u[t],_Ewa.c.a(this.a).e().f(i)&&Array.add(n,i);return!n||!n.length?null:_Ewa.h.d(n,this.a)},H:function(n,t){if(t){var i=t;this.M(i)}_Ewa.a.c("Microsoft.Office.Excel.SortActionMergeCellRange",!1)&&_Ewa.O.b(n,-569193796)&&(_Ewa.R.a(this.a).a().e(-569193796),this.E(n.Errors[0]))},M:function(n){if(_Ewa.a.c("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)){var t=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fM,this.a.a(),430,431,1,null),function(t){var i=t.a();i.a(n);Diag.a.a(541131085,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.a.g(),3,null,null)}},E:function(n){var t=this;_Ewa.g.a(_Ewa.l.b(_Ewa.kF,this.a.a(),446,447,0,null),function(i){var r=i.a();r.a(t.a,n)},this.a.g(),3,null,null)}};_Ewa.CK=function(n){_Ewa.CK.initializeBase(this,[n])};_Ewa.CK.a=function(n){_Ewa.bh.a(86,new _Ewa.CK(n))};_Ewa.CK.prototype={dispose:function(){_Ewa.bh.prototype.dispose.call(this)},m:function(){var n=_Ewa.l.a(_Ewa.dA,this.i.a(),134,this.h(),this.j,null),t=_Ewa.l.a(_Ewa.kI,this.i.a(),330,this.h(),this.j,null),i=_Ewa.l.b(_Ewa.hu,this.i.a(),309,310,this.j,null),r=this;_Ewa.g.a($$sc.a.WAA(n,i,t),function(){r.n([new _Ewa.to(r.i,n.a(),i.a(),t.a())],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.i.g(),3,null,null)}};_Ewa.Zt=function(n,t,i){this.bg=Function.createDelegate(this,this.bA);_Ewa.Zt.initializeBase(this,[n,null,!1,!1,!1,!1]);this.W=t;this.H=i;this.L=_Ewa.tp.b();this.A(_Ewa.ClientStringManager.a().a(963),this.bg,null)};_Ewa.Zt.prototype={W:null,H:!1,f:function(){return"TableHeaderTextDialog"},bA:function(n){this.E();n===1&&this.bp()},bp:function(){var n=this,t=function(t,i,r){return _Ewa.eZ.a(n.b.c().a(),n.W,!0,!0,n.H,t,i,r,null,null)},i=new _Ewa.t(1001,0,t,0,null);this.b.f().a(i,null)}};_Ewa.eZ=function(){};_Ewa.eZ.e=function(n,t,i,r,u,f,e,o,s,h,c,l){var a=n.a(41,l);return a.autoFilterOptions=t,a.items=i,a.dateItems=r,a.showBlanks=u,a.hideBlanks=f,a.noData=e,_Ewa.k.a(n,"ApplyItemFilter",a,o,s,h,c,0,null,null)};_Ewa.eZ.a=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(41,h);return c.tableRange=t,c.hasHeaders=i,c.convertHeader=r,c.hasTotalRow=u,_Ewa.k.a(n,"CreateTable",c,f,e,o,s,0,null,null)};_Ewa.eZ.j=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.targetRange=t,_Ewa.k.a(n,"ResizeTable",o,i,r,u,f,0,null,null)};_Ewa.eZ.g=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.convertToRangeInput=t,_Ewa.k.a(n,"ConvertToRange",o,i,r,u,f,0,null,null)};_Ewa.eZ.h=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.convertToRangeInput=t,_Ewa.k.a(n,"ConvertToRangeForQueryTable",o,i,r,u,f,0,null,null)};_Ewa.eZ.d=function(n,t,i,r,u,f,e,o){var s=n.a(41,o);return s.tableRange=t,s.optionType=i,_Ewa.k.a(n,"ToggleTableStyleOption",s,r,u,f,e,4,null,null)};_Ewa.eZ.c=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRange=t,_Ewa.k.a(n,"IsRangeQueryTable",o,i,r,u,f,4,null,null)};_Ewa.eZ.f=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.tableRanges=t,s.styleIndex=i,_Ewa.k.a(n,"ApplyTableStyle",s,r,u,f,e,4,null,null)};_Ewa.eZ.b=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(1,c);return l.tableRanges=t,l.hasHeaders=i,l.convertHeader=r,l.hasTotalRow=u,l.styleIndex=f,_Ewa.k.a(n,"FormatAsTable",l,e,o,s,h,0,null,null)};_Ewa.eZ.i=function(n,t,i,r,u,f,e,o){var s=n.a(41,o);return s.newName=t,s.selectedRange=i,_Ewa.k.a(n,"RenameTable",s,r,u,f,e,4,null,null)};_Ewa.boP.registerClass("_Ewa.boP",_Ewa.bas);_Ewa.CJ.registerClass("_Ewa.CJ",_Ewa.boP);_Ewa.Zr.registerClass("_Ewa.Zr",_Ewa.boP);_Ewa.Zs.registerClass("_Ewa.Zs",_Ewa.bfV);_Ewa.to.registerClass("_Ewa.to",null,_Ewa.lK);_Ewa.CK.registerClass("_Ewa.CK",_Ewa.bh);_Ewa.Zt.registerClass("_Ewa.Zt",_Ewa.wD);Type.registerNamespace("_Ewa");_Ewa.boQ=function(){};_Ewa.boQ.a=function(){_Ewa.m.a(_Ewa.CK.a)};_Ewa.boQ.a();Type.registerNamespace("_Ewa");_Ewa.bdg=function(){};_Ewa.bdg.a=function(){_Ewa.m.a(_Ewa.ug.a)};_Ewa.ug=function(n){_Ewa.ug.initializeBase(this);this.i=n;this.l()};_Ewa.ug.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.fH),157,new _Ewa.ug(n))};_Ewa.ug.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.fH,15,!1,null)||new _Ewa.Em(this.i))}};_Ewa.Em=function(n){var t,i;this.o=["CCB","NK","HUI","TM","RM","BB","FB","GHC","BE","TPP","SCP","GK","CVK","FOK","STB","CUF","SB","BM"];this.r=["HUI","VHP","VHH","VHV"];this.q=["HUI","PPH","PP","PSTP"];this.p=["FBE","GE","FAAC"];_Ewa.Em.initializeBase(this,[document.documentElement,n]);t=_Ewa.ClientStringManager.a().b(250);this.k=this.d.K().g(t);this.a(0);n.a().b(_Ewa.fH,15,this);i=this;_Ewa.g.a(_Ewa.l.b(Common.T,n.a(),21,137,1,null),function(n){var t=n.a();t.c("App_AccessibilityLoopComplete");t.b("App_AccessibilityLoopComplete",i.m)},n.g(),3,null,null)};_Ewa.Em.prototype={k:null,f:0,g:function(){return this.f},a:function(n){this.f=n;switch(n){case 0:this.h(this.o);break;case 2:this.h(this.r);break;case 3:this.h(this.q);break;case 4:this.h(this.p);break;default:Diag.a.b(41980873,0,!0,"Accessibility Mode value is not in allowed values")}return n},b:function(n){this.d.s()&65536&&_Ewa.oi.prototype.b.call(this,n)},n:function(n){if(_Ewa.f.b(this.k,this.d.K().f(n,0),!1)){var t=_Ewa.cp.b(this.d);t&&t.bG()&&(_Ewa.M.a(n,!0),t.L(!0,!1))}}};_Ewa.ug.registerClass("_Ewa.ug",_Ewa.sY.$$(_Ewa.fH));_Ewa.Em.registerClass("_Ewa.Em",_Ewa.oi);_Ewa.bdg.a();Type.registerNamespace("_Ewa");_Ewa.ul=function(n){_Ewa.ul.initializeBase(this);this.i=n;this.l()};_Ewa.ul.a=function(n){n.a().b(_Ewa.bkt.$$(Sys.IDisposable),39,new _Ewa.ul(n))};_Ewa.ul.prototype={i:null,a:function(){Common.a.G("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");Common.a.a.a("RefreshAccessTokenSilently")?this.k(this.m()):this.k(this.i.a().a(Sys.IDisposable,38,!1,null)||new _Ewa.Eu(this.i))},m:function(){var n=this.i.a().a(Sys.IDisposable,38,!1,null),t;return n?n:(t=new Common.App.SessionExpiration.g(Common.a.k(),Common.a.J(),new Common.App.SessionExpiration.h,null),new _Ewa.Ev(this.i,t))}};_Ewa.Eu=function(n){this.l=new _Ewa.bV(!1);_Ewa.Eu.initializeBase(this);this.k=n;this.k.a().b(_Ewa.qu,38,this)};_Ewa.Eu.prototype={k:null,h:function(n){this.l.et("SessionExpired",n)},d:function(n){this.l.et("TokenRefreshed",n)},f:function(n){this.l.ev("TokenRefreshed",n)},B:function(){var n=new Date(this.m),t=n.format(this.k.e().ShortTimeFormat);return String.format(_Ewa.ClientStringManager.a().c(77),t)},s:!1,i:function(){return this.s},r:!1,b:function(){return this.r},j:function(n){return this.r=n,n},e:function(){return!1},a:function(){return!1},g:function(){return!1},c:function(){return!1},dispose:function(){System.a.a(this.l);this.k=null},u:function(){this.k.j()&&this.v(!1)},t:function(){this.s=!0;this.v(!0);this.l.es("SessionExpired",null,null)},v:function(n){var t;Diag.a.a(19981001,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",n,this.k.b().br());t=this.k.n().b();n&&t&&t.h()&&t.b().MessageId===1299163859&&this.k.n().b().e();var r=this.z(n),i=this,u=function(){var t=_Ewa.R.a(i.k),n=t.a().a();n.NPAnu=i.k.bD(i.k.j(),!0);n.NPAnum="ntw";n.PUOAudna="cw50";t.a().d([r])};_Ewa.A.a(this.k).c(new _Ewa.cZ("cw8",5,u))},z:function(n){return n?_Ewa.i.E():this.A()},A:function(){var n=_Ewa.i.b(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");return n.Description=this.B(),n}};_Ewa.Ev=function(n,t){var i,r,u;this.y=Function.createDelegate(this,this.ba);this.F=Function.createDelegate(this,this.Y);this.G=Function.createDelegate(this,this.Z);this.D=Function.createDelegate(this,this.T);this.E=Function.createDelegate(this,this.W);this.o=new _Ewa.bV(!1);this.k=n;this.x=t;this.v=n.o().b("WebServiceCall","refreshToken");this.r=_Ewa.a.a("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");Common.be.a().j(this.E);Common.be.a().i(this.D);i=this.k.b();i.g(this.G);i.ba(this.F);this.J=this.k.e().MinTokenLifetimeForRegularExpirationPromptInMin;this.C=this.k.e().ShortAccessTokenExpirationPromptSeconds;this.B=this.k.e().RefreshAccessTokenDurationLimitInSec;this.O(n.b().bP(),Common.a.o);r=new Date;Diag.a.a(39929153,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",{AccessTokenTtl:Common.a.o,NowGetTime:r.getTime(),BootTime:Common.a.N,WopiTokenExpiresAfterMinutes:Common.a.bR,WopiTokenTaskItemPriority:Common.a.bT});this.k.a().b(_Ewa.qu,38,this);u=this;this.k.a().c(_Ewa.dD,291,function(n){u.u=n},null)};_Ewa.Ev.prototype={k:null,u:null,x:null,n:null,s:!1,r:!1,p:!1,v:null,w:null,t:!1,A:!0,B:0,J:0,C:0,h:function(n){this.o.et("SessionExpired",n)},d:function(n){this.o.et("TokenRefreshed",n)},f:function(n){this.o.ev("TokenRefreshed",n)},H:!1,i:function(){return this.H},m:!1,b:function(){return this.m},j:function(n){return this.m=n,n},z:!1,a:function(){return this.z},q:!1,c:function(){return this.q},l:null,e:function(){return this.q?!1:this.k.b().i().a()?_Ewa.cg.a<1:_Ewa.cg.b<6},g:function(){return this.s},I:function(){var n=Common.a.o;return Common.be.a().a(n)},dispose:function(){Common.be.a().n(this.E);Common.be.a().m(this.D);var n=this.k.b();n&&(n.j(this.G),n.bi(this.F));System.a.a(this.o);this.k=null;this.u=null},N:function(){return this.I()?0:(Common.a.o-(new Date).getTime())/6e4},O:function(n,t){if(t>0&&!this.I()){var r=Common.a.a.c("AccessTokenExpirationPromptSeconds",Common.a.D),i=(t-n.getTime())/6e4;Diag.a.b(591687890,0,i>=0,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",t,n.getTime(),i);i<this.J?(Diag.a.a(591687889,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.C,i),Common.a.D=this.C):Common.a.D!==r&&(Diag.a.a(591687888,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",r,i),Common.a.D=r)}},R:function(n){if(!this.l||this.l.b||this.l.d!==n){var t=new _Ewa.Ew(Common.v.a().a,n);return this.l&&!this.l.c&&Diag.a.a(594596952,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",t.a,this.l.a,this.l.b),this.l=t,!0}return!1},T:function(){if(!this.r||this.r&&this.k.b().a())this.L(!1);else if(this.A){this.A=!1;var n=_Ewa.R.a(this.k);Diag.a.a(572019857,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",n.b()?n.b().a():"None",this.N())}},Z:function(n,t){var u,r,f,i,e;this.l&&(u=this.k.b(),t.a&&this.l.b&&!this.l.c?(this.l.c=!0,r={},r.Name="EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect",r.IsUserActive=u.i().a(),r.RefreshAccessTokenCorrelationID=this.l.a,f=_Ewa.E.a(r),Diag.a.a(594596951,0,50,f)):this.r&&this.s&&!u.a()&&!this.l.d&&(i={},i.Name="EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen",this.n&&(this.n.C(),i.Aborted=!0,_Ewa.a.a("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(i.ResetStopRefreshRetriesUntilTokenExpired=!0,this.p=!1)),i.TimeUntilTokenExpirationInMin=this.N(),i.RefreshAccessTokenCorrelationID=this.l.a,e=_Ewa.E.a(i),Diag.a.a(572019856,0,50,e)))},Y:function(){var n,t;this.l&&this.l.b&&!this.l.c&&(n={},n.Name="EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed",n.CreatedForExpired=this.l.d,n.RefreshAccessTokenCorrelationID=this.l.a,n.OpenWorkbookErrors=_Ewa.i.a(this.k.b().y(),","),n.ExecutionContextErrors=_Ewa.i.a(_Ewa.R.a(this.k).a().c(),","),n.accesstokenTTL=Common.a.o,t=_Ewa.E.a(n),Diag.a.a(594596950,0,15,t))},W:function(){this.p=!1;this.L(!0)},bc:function(n){n&&this.m&&!this.z&&this.k.b().i().a()&&!this.q&&(this.m=!1)},L:function(n){var f,e,u,t,o,r,i;(this.bc(n),this.s||this.p&&!n||this.m||!this.e())||(this.s=!0,f=this.l?this.l.e:null,e=this.R(n),this.A=!0,u=this.k.b(),t={},t.Name="EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",t.newContextCreated=e,t.IsUserActive=u.i().a(),t.IsSessionActive=u.a(),t.ContainsChangesWorkbookOperations=this.k.f().h(),t.isSessionExpired=n,t.stopRefreshRetriesUntilTokenExpired=this.p,t.FailedToRefreshExpiredToken=this.m,t.numOfFailuresWhileUserIsActive=_Ewa.cg.a,t.numOfFailuresWhileUserIsInActive=_Ewa.cg.b,t.numOfFailuresWhileOffline=_Ewa.cg.c,t.RefreshAccessTokenCorrelationID=this.l.a,e&&f&&(t.TimeInMinFromPreviosContextCreation=Math.round(_Ewa.bX.b(_Ewa.q.a(),f)/60)),o=_Ewa.E.a(t),Diag.a.a(40416199,0,50,o),this.v.d(),this.z=u.i().a(),this.n=new $$sc.k,this.X(n),r=this.x.c(!n,this.n?this.n.a:null),i=this,r.CWo(function(){var t,u,f;i.Q();t=i.x.b(r);i.v.a();u=i.I();!t||_Ewa.a.a("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&u?(f=r.a().a(),t&&u&&i.P(f),i.U(f,n)):(i.p=!1,i.V(r.a().b(),n));i.s=!1},this.r?8:0))},P:function(n){var t,r=(t=new Common.App.SessionExpiration.d,t.Id="200",t.Details="Expired accesstoken recieved on successful token request.",t),u=[r],i;n.b((i=new Common.App.SessionExpiration.a,i.Name="ExpiredTokenAfterSuccessfulRefresh",i.Errors=u,i))},X:function(n){n&&(this.k.b().i().a()?this.M():(this.k.b().i().b(this.y),this.t=!0))},M:function(){var n=this;this.w=_Ewa.da.a(function(){n.bb()},this.B*1e3,_Ewa.o.co,this.w)},ba:function(){this.t&&(this.k.b().i().c(this.y),this.t=!1);this.M()},Q:function(){this.w&&this.w.a();this.t&&(this.k.b().i().c(this.y),this.t=!1);this.n=null},bb:function(){Diag.a.a(589137505,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.B);this.n.C()},U:function(n,t){var r,u,f;this.p=!0;t&&(this.m||(this.m=!0,this.H=!0),this.x.a(n)&&(this.q=!0));var e=t&&(!this.e()||_Ewa.cg.d),o=e?39982555:40380379,i=this.K(t);i.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";i.FailedToRefreshExpiredToken=this.m;i.LastErrorIsPermanent=this.q;n.f.length>0&&(r=n.a(0),i.errorName=r.Name,r.Errors.length>0&&(i.ErrorId=r.Errors[0].Id,u=r.Errors[0].Details,i.ErrorDetails=this.S(u.toString())?"PiiScrubbed":u));f=_Ewa.E.a(i);Diag.a.a(o,0,15,f);this.o.es("TokenRefreshed",new Common.App.SessionExpiration.b(null,n),null)},S:function(n){return _Ewa.f.c(n,"makes the internet safe for businesses",!0)},K:function(n){var t={},i=this.k.b();return t.Name="",t.IsUserActive=i.i().a(),t.IsSessionActive=i.a(),t.GotDeploymentOrTimedOutError=i.br(),t.TimeInSecFromLastStatefulSuccessfulRequest=i.bd(),t.TimeFromLastUserActivityInMs=i.i().d(),t.calledFromSessionExpiredFlow=n,t.RefreshTokenDurationInMS=this.v.b(),t.numOfFailuresWhileUserIsActive=_Ewa.cg.a,t.numOfFailuresWhileUserIsInActive=_Ewa.cg.b,t.numOfFailuresWhileOffline=_Ewa.cg.c,t.RefreshAccessTokenCorrelationID=this.l.a,t.accessTokenTTL=Common.a.o,t.ContainsChangesWorkbookOperations=this.k.f().h(),t.IsDocumentHidden=this.u?this.u.a().toString():"Unknown",t.TimeFromFirstOpenInHr=Math.floor(_Ewa.bX.b(_Ewa.q.a(),_Ewa.bn.d(i.bP()))/3600),t},V:function(n,t){var o,u;this.m=!1;this.bd();this.O(new Date,Common.a.o);var i=this.k.b(),f=!t&&i.i().a(),e=!this.k.j()&&i.Y(),r=this.K(t);return(r.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess",r.shouldTriggerSilentReloadAfterExpiring=f,r.WopiTokenTaskItemPriority=Common.a.bT,r.isDirtyViewSession=e,o=_Ewa.E.a(r),Diag.a.a(39982556,0,15,o),this.o.es("TokenRefreshed",new Common.App.SessionExpiration.b(n,null),null),e)?(i.i().a()&&(Diag.a.a(594596949,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),i.bp()),!0):(i.i().a()?f&&(u=_Ewa.R.a(this.k).a().a(),u.RATAtsratr=!0,u.CWMfsc=!0,u.OWMem=this.k.j(),_Ewa.A.a(this.k).c(new _Ewa.cZ("cw4",2,null))):i.a()&&_Ewa.k.k(this.k.c().a(),!0,!1,!1,null,null,null,null,null),!0)},bd:function(){isNullOrUndefined(this.k.b().h().WorkbookUri)?Diag.a.a(594596948,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null"):(this.k.b().h().WorkbookUri=Common.k.d(this.k.b().h().WorkbookUri,Common.a.v,Common.a.t,!1),this.k.b().h().WorkbookUri=Common.k.d(this.k.b().h().WorkbookUri,"access_token_ttl",Common.a.o.toString(),!1),this.k.b().bh());this.k.e().AccessToken=Common.a.t;this.k.e().AccessTokenValidTo=Common.a.o;isNullOrUndefined(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion)||(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion=Common.k.d(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion,Common.a.v,Common.a.t,!1),this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion=Common.k.d(this.k.e().DocumentHostInfo.QuerySignatureWithoutVersion,"access_token_ttl",Common.a.o.toString(),!1));isNullOrUndefined(this.k.e().EmbedConfiguratorUrl)||(this.k.e().EmbedConfiguratorUrl=Common.k.d(this.k.e().EmbedConfiguratorUrl,Common.a.v,Common.a.t,!1),this.k.e().EmbedConfiguratorUrl=Common.k.d(this.k.e().EmbedConfiguratorUrl,"access_token_ttl",Common.a.o.toString(),!1));this.l.b=!0}};_Ewa.ul.registerClass("_Ewa.ul",_Ewa.sY.$$(Sys.IDisposable));_Ewa.Eu.registerClass("_Ewa.Eu",Common.App.SessionExpiration.i,_Ewa.qu,Common.fT,Sys.IDisposable);_Ewa.Ev.registerClass("_Ewa.Ev",null,_Ewa.qu,Common.fT,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bdl=function(){};_Ewa.bdl.a=function(){_Ewa.m.a(_Ewa.ul.a)};_Ewa.bdl.a();var WacAnimation={},WacCurveType={Instant:0,Hold:1,Linear:2,CubicBezier:3},WacCurveID={Instant:0,Hold:1,Linear:2,ShotgunToPillowLanding:3,ReverseShotgunToPillowLanding:4,ShotgunToLinear:5,EaseIn:6,EaseOut:7,EaseInOut:8,Exponential:9,ShotgunToPillowLanding_VisualRefresh:10,Cxe_ShowHintBar:11,Cxe_HideHintBar:12,Cxe_ColorWheel:13,Cxe_SpinnerDot1:14,Cxe_SpinnerDot2:15,Cxe_SpinnerDot4:16,Cxe_SpinnerDot5:17,Cxe_SpinnerDot7:18,InOutSine:19,PresenceUI_Standard:20},g_AnimationCurves=new Array(21),g_numAnimationAttributes,AnimRelativeTo,WacKeyframeType,g_AnimationContextVariables,g_WacAnimations,g_WacRadix,g_WacAnimationTelemetry,g_LastAnimationData;g_AnimationCurves[WacCurveID.Instant]=new WacCurve(WacCurveID.Instant,WacCurveType.Instant,0,0,0,0);g_AnimationCurves[WacCurveID.Hold]=new WacCurve(WacCurveID.Hold,WacCurveType.Hold,0,0,0,0);g_AnimationCurves[WacCurveID.Linear]=new WacCurve(WacCurveID.Linear,WacCurveType.Linear,0,0,0,0);g_AnimationCurves[WacCurveID.ShotgunToPillowLanding]=new WacCurve(WacCurveID.ShotgunToPillowLanding,WacCurveType.CubicBezier,0,0,0,1);g_AnimationCurves[WacCurveID.ReverseShotgunToPillowLanding]=new WacCurve(WacCurveID.ReverseShotgunToPillowLanding,WacCurveType.CubicBezier,1,0,1,1);g_AnimationCurves[WacCurveID.ShotgunToLinear]=new WacCurve(WacCurveID.ShotgunToLinear,WacCurveType.CubicBezier,0,0,.42,1);g_AnimationCurves[WacCurveID.EaseIn]=new WacCurve(WacCurveID.EaseIn,WacCurveType.CubicBezier,.83,0,1,1);g_AnimationCurves[WacCurveID.EaseOut]=new WacCurve(WacCurveID.EaseOut,WacCurveType.CubicBezier,0,0,.58,1);g_AnimationCurves[WacCurveID.EaseInOut]=new WacCurve(WacCurveID.EaseInOut,WacCurveType.CubicBezier,.42,0,.58,1);g_AnimationCurves[WacCurveID.Exponential]=new WacCurve(WacCurveID.Exponential,WacCurveType.CubicBezier,.1,.25,.75,.9);g_AnimationCurves[WacCurveID.ShotgunToPillowLanding_VisualRefresh]=new WacCurve(WacCurveID.ShotgunToPillowLanding_VisualRefresh,WacCurveType.CubicBezier,.1,.9,.2,1);g_AnimationCurves[WacCurveID.Cxe_ShowHintBar]=new WacCurve(WacCurveID.Cxe_ShowHintBar,WacCurveType.CubicBezier,.1,.9,.2,1);g_AnimationCurves[WacCurveID.Cxe_HideHintBar]=new WacCurve(WacCurveID.Cxe_HideHintBar,WacCurveType.CubicBezier,.9,.1,.2,1);g_AnimationCurves[WacCurveID.Cxe_ColorWheel]=new WacCurve(WacCurveID.Cxe_ColorWheel,WacCurveType.CubicBezier,.4,0,0,1);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot1]=new WacCurve(WacCurveID.Cxe_SpinnerDot1,WacCurveType.CubicBezier,.13,.21,.1,.7);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot2]=new WacCurve(WacCurveID.Cxe_SpinnerDot2,WacCurveType.CubicBezier,.02,.33,.38,.77);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot4]=new WacCurve(WacCurveID.Cxe_SpinnerDot4,WacCurveType.CubicBezier,.57,.17,.95,.75);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot5]=new WacCurve(WacCurveID.Cxe_SpinnerDot5,WacCurveType.CubicBezier,0,.19,.07,.72);g_AnimationCurves[WacCurveID.Cxe_SpinnerDot7]=new WacCurve(WacCurveID.Cxe_SpinnerDot7,WacCurveType.CubicBezier,0,0,.95,.37);g_AnimationCurves[WacCurveID.InOutSine]=new WacCurve(WacCurveID.InOutSine,WacCurveType.CubicBezier,.66,0,.34,1);g_AnimationCurves[WacCurveID.PresenceUI_Standard]=new WacCurve(WacCurveID.PresenceUI_Standard,WacCurveType.CubicBezier,.8,0,.2,1);WacKeyFrame.prototype={type:0,curveID:0,startTime:new WacIntWrapper(0,null),endTime:new WacIntWrapper(0,null),startValue:new WacIntWrapper(0,null),endValue:new WacIntWrapper(0,null),relativeTo:0,operationType:0};g_numAnimationAttributes=8;WacAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5,ScrollTop:6,ScrollLeft:7,RotateZ:8};AnimRelativeTo={Initial:0,Final:1,Absolute:2};WacKeyframeType={Mult:0,Add:1};WacAnimation.ContextID={};g_AnimationContextVariables=new Array(0);WacAnimation.ContextVariableManager=WacAnimation_ContextVariableManager;WacAnimation_ContextVariableManager.prototype={};WacAnimation_ContextVariableManager.prototype.SetContextVariable=function(n,t){var i=WacAnimation.ContextID[n];g_AnimationContextVariables[i].value=t};WacAnimation.ID={BASIC_INSTANTFADE:0,BASIC_QUICKESTSHOW:1,BASIC_QUICKMOVE:2,BASIC_QUICKSIZE:3,BASIC_QUICKSHOW:4,BASIC_QUICKHIDE:5,BASIC_QUICKERMOVE:6,BASIC_QUICKERSIZE:7,BASIC_QUICKERFADE:8,BASIC_QUICKERSHOW:9,BASIC_QUICKERHIDE:10,BASIC_MOVE:11,BASIC_SIZE:12,BASIC_FADE:13,BASIC_SHOW:14,BASIC_HIDE:15,BASIC_SCROLL:16,BASIC_SLOWMOVE:17,BASIC_SLOWSIZE:18,BASIC_SLOWFADE:19,BASIC_SLOWSHOW:20,BASIC_SLOWERSCROLL:21,ONENOTEBASIC_MOVE:22,ONENOTEBASIC_SIZE:23,ONENOTEBASIC_FADE:24,ONENOTEBASIC_SHOW:25,ONENOTEBASIC_HIDE:26,SHARED_QUICKHIDE:27,TAB_MOVE:28,TAB_SLIDEINFADEINBOTTOM:29,TAB_SLIDEINBOTTOMVISUALREFRESH:30,TAB_SLIDEOUTBOTTOMVISUALREFRESH:31,SHARED_INSERTSHOW:32,BASIC_MOVEVISUALREFRESH:33,BASIC_SIZEVISUALREFRESH:34,MSOHELP_FOLLOWTHEDOTMOVE:35,DELAY_SHOW:36,DELAY_MOVE:37,WAC_RIBBONMOVE:38,WAC_RIBBONSHOW:39,WAC_RIBBONHIDE:40};g_WacAnimations=new Array(41);g_WacAnimations[WacAnimation.ID.BASIC_INSTANTFADE]=new WacAnim(WacAnimation.ID.BASIC_INSTANTFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKESTSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKESTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,167,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERFADE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKERSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKERHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKERHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_MOVE]=new WacAnim(WacAnimation.ID.BASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SIZE]=new WacAnim(WacAnimation.ID.BASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_FADE]=new WacAnim(WacAnimation.ID.BASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SHOW]=new WacAnim(WacAnimation.ID.BASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_HIDE]=new WacAnim(WacAnimation.ID.BASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SCROLL]=new WacAnim(WacAnimation.ID.BASIC_SCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWMOVE]=new WacAnim(WacAnimation.ID.BASIC_SLOWMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSIZE]=new WacAnim(WacAnimation.ID.BASIC_SLOWSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWFADE]=new WacAnim(WacAnimation.ID.BASIC_SLOWFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSHOW]=new WacAnim(WacAnimation.ID.BASIC_SLOWSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWERSCROLL]=new WacAnim(WacAnimation.ID.BASIC_SLOWERSCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,1e3,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_MOVE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SIZE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_FADE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_SHOW]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.ONENOTEBASIC_HIDE]=new WacAnim(WacAnimation.ID.ONENOTEBASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,367,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.SHARED_QUICKHIDE]=new WacAnim(WacAnimation.ID.SHARED_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.TAB_MOVE]=new WacAnim(WacAnimation.ID.TAB_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM]=new WacAnim(WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,0,null,40,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEINBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,0,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Instant,0,100,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.Instant,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,101,350,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH]=new WacAnim(WacAnimation.ID.TAB_SLIDEOUTBOTTOMVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,32,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,1,AnimRelativeTo.Initial,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.SHARED_INSERTSHOW]=new WacAnim(WacAnimation.ID.SHARED_INSERTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,101,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_MOVEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_MOVEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SIZEVISUALREFRESH]=new WacAnim(WacAnimation.ID.BASIC_SIZEVISUALREFRESH,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding_VisualRefresh,0,300,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE]=new WacAnim(WacAnimation.ID.MSOHELP_FOLLOWTHEDOTMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.EaseInOut,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.DELAY_SHOW]=new WacAnim(WacAnimation.ID.DELAY_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.ShotgunToPillowLanding,201,500,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.DELAY_MOVE]=new WacAnim(WacAnimation.ID.DELAY_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONMOVE]=new WacAnim(WacAnimation.ID.WAC_RIBBONMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONSHOW]=new WacAnim(WacAnimation.ID.WAC_RIBBONSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONHIDE]=new WacAnim(WacAnimation.ID.WAC_RIBBONHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);var g_WacAnimationEngine=null,g_WacAnimationLogging=window.location.search.indexOf("AnimationLogging=1")!=-1,g_WacAnimationThrottleFPS=0,g_WacAnimationThrottleNumInstance=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,16)}}();WacAnimation.State=WacAnimation_State;WacAnimation.Object=WacAnimation_Object;WacAnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,resetInterval:5e3,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};WacAnimationEngine.prototype.LocalStepper=function(){g_WacAnimationEngine.StepAllAnimations()};WacAnimationEngine.prototype.LocalStopper=function(){g_WacAnimationEngine.StepAllAnimations();g_WacAnimationEngine.StopEngine()};WacAnimationEngine.prototype.StartEngine=function(){this.sharedTimer==null&&this.sharedCancelTimer==null&&this.sharedTimerRefs==0&&(this.sharedTimer=window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper),g_WacAnimationEngine.StartCancelTimer(),this.sharedTimerRefs=0,g_WacAnimationTelemetry.Start())};WacAnimationEngine.prototype.StopEngine=function(){g_WacAnimationTelemetry.Stop();g_WacAnimationEngine.StopCancelTimer();this.sharedTimer!=null&&(this.sharedTimer=null);this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.AnimationQueue=new Array(0)};WacAnimationEngine.prototype.StartAnimation=function(n){this.AnimationQueue[this.sharedTimerRefs++]=n};WacAnimationEngine.prototype.StopAnimation=function(n){for(var t=0;t<this.AnimationQueue.length;t++)this.AnimationQueue[t]==n&&(this.RemoveTemporaryIds(n),this.AnimationQueue[t]=null)};WacAnimationEngine.prototype.StepAllAnimations=function(){var i=!1,t=null,n;for(g_WacAnimationEngine.StopCancelTimer(),n=0;n<this.AnimationQueue.length;n++)this.AnimationQueue[n]!=null&&(IsNullOrUndef(t)&&(t=this.AnimationQueue[n].currentTime),this.currentAnimationIndex=n,this.AnimationQueue[n].StepAnimation(),i=!0);this.currentAnimationIndex=-1;i&&!IsNullOrUndef(t)&&g_WacAnimationTelemetry.AddPerfData(new Date-t);i?(g_WacAnimationEngine.StartCancelTimer(),window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper)):this.StopEngine()};WacAnimationEngine.prototype.CheckForConflictingAnimations=function(n,t){var e,f,r,i;if((n.id==null||n.id=="")&&(e="tempAnimID_"+String(this.temporaryIDGenerator),this.temporaryIDGenerator++,n.id=e),f=n.id+"_"+String(t),r=this.conflictTable[f],IsNullOrUndef(r)||r==this.currentAnimationIndex||this.AnimationQueue[r]==null)this.conflictTable[f]=this.currentAnimationIndex;else if(i=this.AnimationQueue[r],i.curveID.SetAttribute(t,null),i.finishFunc!=null){var u=this.AnimationQueue[this.currentAnimationIndex],o=i.finishFunc,s=i.extraData,h=u.finishFunc,c=u.extraData;u.finishFunc=h==null?function(){o(s)}:function(){o(s);h(c)};u.extraData=null;i.finishFunc=null}};WacAnimationEngine.prototype.RemoveTemporaryIds=function(n){var t,r,i;if(IsArrayCheck(n.element))for(r=n.element.length,i=0;i<r;i++)t=n.element[i],t.id.indexOf("tempAnimID_")==0&&t.id==null;else t=n.element,t.id.indexOf("tempAnimID_")==0&&t.id==null};WacAnimationEngine.prototype.StopCancelTimer=function(){this.sharedCancelTimer!=null&&(window.clearTimeout(this.sharedCancelTimer),this.sharedCancelTimer=null)};WacAnimationEngine.prototype.StartCancelTimer=function(){this.sharedCancelTimer=window.setTimeout(WacAnimationEngine.prototype.LocalStopper,this.resetInterval)};g_WacRadix=10;WacAnimation_State.prototype={Index:0,Data:new Array(0),AnimateRight:!1};WacAnimation_State.prototype.SetAttribute=function(n,t){var r=this.GetDataIndex(n),i;r==-1?(i=this.Data.length,this.Index+=n*Math.pow(g_WacRadix,i),this.Data[i]=t):this.Data[r]=t};WacAnimation_State.prototype.GetAttribute=function(n){var t=this.GetDataIndex(n);return t==-1?null:this.Data[t]};WacAnimation_State.prototype.GetDataIndex=function(n){for(var i=0,t=this.Index,r;t!=0;){if(r=t%g_WacRadix,r==n)return i;t=Math.floor(t/g_WacRadix);i++}return-1};WacAnimation_State.prototype.SetAnimateRight=function(n){this.AnimateRight=n};WacAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0,cachedContextVariables:null};WacAnimation_Object.prototype.Initialize=function(n,t,i,r,u,f){this.animationID=n;this.delay=t;this.element=i;this.finalState=r;this.finishFunc=u;this.extraData=f;this.arrAnimationUnits=new Array(0);this.idxAnimUnit=0;this.cachedContextVariables=g_AnimationContextVariables};WacAnimation_Object.prototype.GetIntWrapperValue=function(n){return n.contextId==null?n.value:this.cachedContextVariables[n.contextId].value};WacAnimation_Object.prototype.RunAnimation=function(){var t,n;if(this.animationID!=-1&&this.element!=null)for(this.GenerateAnimationUnits(),t=this.arrAnimationUnits.length,n=0;n<t;n++)this.arrAnimationUnits[n].StartAnimation()};WacAnimation_Object.prototype.AdvanceToFinalState=function(n,t){for(var r,o,u,i,f,s,h=new WacAnimation_State,c=t.keyFrames.length,e=0;e<c;e++)r=t.keyFrames[e],h.SetAttribute(r.type,this.GetFinalValue(r,n));for(o=g_numAnimationAttributes,u=IsArrayCheck(this.element)?this.element[n]:this.element,i=1;i<=o;i++)f=h.GetAttribute(i),f!=null&&(s=new WacAnimationUnit(u,0,0,null,null,this.finalState.AnimateRight),s.SetStyle(i,u,f))};WacAnimation_Object.prototype.GenerateAnimationUnits=function(){for(var n,u,i,e,t,s=g_WacAnimations[this.animationID],f=null,h=s.keyFrames.length,r=null,o=0;o<h;o++)if(n=s.keyFrames[o],u=this.FindMatchingAnimationUnit(n),u!=null)if(u.startValue.SetAttribute(n.type,this.GetIntWrapperValue(n.startValue)),u.curveID.SetAttribute(n.type,n.curveID),IsArrayCheck(this.element))for(e=this.element.length,i=0;i<e;i++)if(r=this.GetFinalValue(n,i),IsNullOrUndef(r)){u.curveID.SetAttribute(n.type,null);break}else u.targetValue[i].SetAttribute(n.type,r);else r=this.GetFinalValue(n,-1),IsNullOrUndef(r)?u.curveID.SetAttribute(n.type,null):u.targetValue.SetAttribute(n.type,r);else{if(t=new WacAnimationUnit(this.element,this.GetIntWrapperValue(n.startTime)+this.delay,this.GetIntWrapperValue(n.endTime)-this.GetIntWrapperValue(n.startTime),null,null,this.finalState.AnimateRight),t.startValue.SetAttribute(n.type,this.GetIntWrapperValue(n.startValue)),t.curveID.SetAttribute(n.type,n.curveID),IsArrayCheck(this.element))for(e=this.element.length,i=0;i<e;i++)if(t.targetValue==null&&(t.targetValue=new Array(this.element.length)),t.targetValue[i]==null&&(t.targetValue[i]=new WacAnimation_State),r=this.GetFinalValue(n,i),IsNullOrUndef(r)){t.curveID.SetAttribute(n.type,null);break}else t.targetValue[i].SetAttribute(n.type,r);else t.targetValue==null&&(t.targetValue=new WacAnimation_State),r=this.GetFinalValue(n,-1),IsNullOrUndef(r)?t.curveID.SetAttribute(n.type,null):t.targetValue.SetAttribute(n.type,r);(f==null||f.delay+f.duration<=t.delay+t.duration)&&(f=t);this.arrAnimationUnits[this.idxAnimUnit++]=t}f!=null&&(f.finishFunc=this.finishFunc,f.extraData=this.extraData)};WacAnimation_Object.prototype.FindMatchingAnimationUnit=function(n){for(var t,r=this.arrAnimationUnits.length,i=0;i<r;i++)if(t=this.arrAnimationUnits[i],t.delay==this.GetIntWrapperValue(n.startTime)+this.delay&&t.duration==this.GetIntWrapperValue(n.endTime)-this.GetIntWrapperValue(n.startTime))return t;return null};WacAnimation_Object.prototype.GetFinalValue=function(n,t){var i=null,f,u,e,r;if(!IsNullOrUndef(this.GetIntWrapperValue(n.endValue)))switch(n.relativeTo){case 0:f=IsArrayCheck(this.element)?this.element[t]:this.element;u=this.GetIntWrapperValue(n.startValue)==null?GetCurrentAttributeCssValue(f,n.type,this.finalState.AnimateRight):this.GetIntWrapperValue(n.startValue);i=n.operationType==0?this.GetIntWrapperValue(n.endValue)*u:this.GetIntWrapperValue(n.endValue)+u;break;case 1:e=IsArrayCheck(this.element)?this.finalState[t]:this.finalState;r=e.GetAttribute(n.type);IsNullOrUndef(r)||(i=n.operationType==0?this.GetIntWrapperValue(n.endValue)*r:this.GetIntWrapperValue(n.endValue)+r);break;case 2:i=this.GetIntWrapperValue(n.endValue)}return i};WacAnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:!1,animateRight:!1,relativePosition:!1};WacAnimationUnit.prototype.Initialize=function(n,t,i,r,u,f){this.element=n;this.delay=t;this.duration=i;this.finishFunc=r;this.extraData=u;this.startValue=new WacAnimation_State;this.perElementStartValue=null;this.targetValue=null;this.curveID=new WacAnimation_State;this.startTime=null;this.fIsExecuting=!1;this.animateRight=f;this.relativePosition=!1};WacAnimationUnit.prototype.StartAnimation=function(){g_WacAnimationEngine==null&&(g_WacAnimationEngine=new WacAnimationEngine);g_WacAnimationEngine.sharedTimer==null&&g_WacAnimationEngine.StartEngine();this.element.style.position=="relative"&&(this.relativePosition=!0);this.startTime=new Date;this.currentTime=new Date;g_WacAnimationEngine.StartAnimation(this)};WacAnimationUnit.prototype.StopAnimation=function(){g_WacAnimationEngine.StopAnimation(this)};WacAnimationUnit.prototype.StepAnimation=function(){var r,n,h,e,t,u,f,o,s,l,i;if(this.currentTime=new Date,r=Number(this.currentTime)-Number(this.startTime),!(r<this.delay)){r-=this.delay;var c=!0,a=!this.fIsExecuting,v=g_numAnimationAttributes;for(n=1;n<=v;n++)if(h=this.curveID.GetAttribute(n),!IsNullOrUndef(h))if(e=this.PositionFunction(r,this.duration,h),IsArrayCheck(this.element))for(l=this.element.length,i=0;i<l;i++)o=this.element[i],t=this.startValue.GetAttribute(n),s=this.targetValue[i],u=s.GetAttribute(n),IsNullOrUndef(t)&&(this.perElementStartValue==null&&(this.perElementStartValue=new Array(this.element.length)),IsNullOrUndef(this.perElementStartValue[i])&&(this.perElementStartValue[i]=new WacAnimation_State),t=this.perElementStartValue[i].GetAttribute(n),IsNullOrUndef(t)&&(t=GetCurrentAttributeCssValue(o,n,this.animateRight,this.relativePosition),this.perElementStartValue[i].SetAttribute(n,t))),f=t+e*(u-t),r>=this.duration||e>1?f=u:c=!1,a&&g_WacAnimationEngine.CheckForConflictingAnimations(o,n),this.SetStyle(n,o,f);else o=this.element,t=this.startValue.GetAttribute(n),s=this.targetValue,u=s.GetAttribute(n),IsNullOrUndef(t)&&(t=GetCurrentAttributeCssValue(this.element,n,this.animateRight,this.relativePosition),this.startValue.SetAttribute(n,t)),f=t+e*(u-t),r>=this.duration||e>1?f=u:c=!1,a&&g_WacAnimationEngine.CheckForConflictingAnimations(this.element,n),this.SetStyle(n,this.element,f);this.fIsExecuting=!0;c&&(this.StopAnimation(),this.finishFunc!=null&&(g_WacAnimationTelemetry.LogData("calling fnishfunc"),this.finishFunc(this.extraData)))}};WacAnimationUnit.prototype.PositionFunction=function(n,t,i){var r=0,u=g_AnimationCurves[i];switch(u.type){case 0:r=1;break;case 1:r=n<t?0:1;break;case 2:r=n/t;break;case 3:r=CalculateBezier(u.x1,u.y1,u.x2,u.y2,n/t)}return r};WacAnimationUnit.prototype.SetStyle=function(n,t,i){g_WacAnimationTelemetry.elementIds[t.id]=!0;switch(n){case 1:this.StyleLeftSetter(t,i);break;case 2:this.StyleTopSetter(t,i);break;case 3:this.StyleHeightSetter(t,i);break;case 4:this.StyleWidthSetter(t,i);break;case 5:this.StyleOpacitySetter(t,i);break;case 6:this.StyleScrollTopSetter(t,i);break;case 7:this.StyleScrollLeftSetter(t,i);break;case 8:this.StyleRotateZSetter(t,i)}};WacAnimationUnit.prototype.StyleLeftSetter=function(n,t){this.animateRight?this.relativePosition?n.style.marginRight=String(t)+"px":n.style.right=String(t)+"px":this.relativePosition?n.style.marginLeft=String(t)+"px":n.style.left=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", "+(this.animateRight?"right":"left")+": "+String(t)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleTopSetter=function(n,t){this.relativePosition?n.style.marginTop=String(t)+"px":n.style.top=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", top: "+String(n.style.top)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleHeightSetter=function(n,t){n.style.height=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", height: "+String(n.style.height)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleWidthSetter=function(n,t){n.style.width=String(t)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", width: "+String(n.style.width)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleOpacitySetter=function(n,t){SetCssOpacity(n,t);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", opacity: "+String(t)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollTopSetter=function(n,t){n.scrollTop=t;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", scrollTop: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollLeftSetter=function(n,t){n.scrollLeft=t;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", scrollLeft: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleRotateZSetter=function(n,t){SetCssRotation(n,t);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+n.id+", rotateZ: "+t+", timestamp: "+String(Number(new Date)))};WacAnimationTelemetry.prototype={perfData:null,logData:null,animationStatsLength:5,animationStats:null,animationStatsIndex:0,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0,elementIds:null,avgSessionFps:-1,countSessionFps:0,minSessionFps:-1,maxSessionFps:-1};WacAnimationTelemetry.prototype.Start=function(){this.startTime=new Date;this.perfDataIndex=0;this.logDataIndex=0;this.elementIds={}};WacAnimationTelemetry.prototype.Stop=function(){this.duration=Number(new Date)-Number(this.startTime);this.numUnits=g_WacAnimationEngine.sharedTimerRefs;this.CalculateAndShowStatistics();this.perfDataIndex=0;this.logDataIndex=0};WacAnimationTelemetry.prototype.AddPerfData=function(n){this.perfData[this.perfDataIndex++]=n};WacAnimationTelemetry.prototype.LogData=function(n){this.logData[this.logDataIndex++]=n};WacAnimationTelemetry.prototype.CalculateStatistics=function(){var i=0,h=Number.MAX_VALUE,c=Number.MIN_VALUE,f=0,r=0,l="",a="",y=new Date,v="",o=this.duration,p,n,u,e,w,s,t;if(IsNullOrUndef(o)&&(o=Number(y)-Number(this.startTime)),g_WacAnimationLogging&&this.logDataIndex>0)for(p=this.logDataIndex,n=0;n<p;n++)n!=0&&(l+="<br/>"),l+=this.logData[n];if(this.perfDataIndex>0){for(u=this.perfDataIndex,n=0;n<u;n++)this.perfData[n]<h&&(h=this.perfData[n]),this.perfData[n]>c&&(c=this.perfData[n]),f+=this.perfData[n],n!=0&&(a+=", "),a+=this.perfData[n];for(u>1&&(f/=u-1),f=Math.round(f*100)/100,n=0;n<u;n++)e=this.perfData[n]-f,e=e*e,r+=e;u>1&&(r/=u-1);r=Math.sqrt(r);r=Math.round(r*100)/100;i=this.perfDataIndex/o*1e3;i=Math.round(i)}for(w in this.elementIds)v+=w,v+=",";return(this.minSessionFps==-1||i<this.minSessionFps)&&(this.minSessionFps=i),(this.maxSessionFps==-1||i>this.maxSessionFps)&&(this.maxSessionFps=i),this.countSessionFps==0?(this.countSessionFps++,this.avgSessionFps=i):(s=this.avgSessionFps*this.countSessionFps,s=s+i,this.countSessionFps++,this.avgSessionFps=s/this.countSessionFps),t=new Array(12),t[0]=o,t[1]=i,t[2]=h,t[3]=c,t[4]=f,t[5]=r,t[6]=a,t[7]=l,t[8]=this.numUnits,t[9]=Number(this.startTime),t[10]=Number(y),t[11]=v,t};WacAnimationTelemetry.prototype.CalculateAndShowStatistics=function(){var n=this.CalculateStatistics();g_LastAnimationData=n;this.StoreAnimationStats(n)};WacAnimationTelemetry.prototype.StoreAnimationStats=function(n){this.animationStats[this.animationStatsIndex]=n;this.animationStatsIndex++;this.animationStatsIndex=this.animationStatsIndex%this.animationStatsLength};WacAnimationTelemetry.prototype.GetRecentAnimationStats=function(){for(var n,r=[],t=0,i=g_WacAnimationTelemetry.animationStatsIndex;i<g_WacAnimationTelemetry.animationStatsLength;i++)g_WacAnimationTelemetry.animationStats[i]!=null&&(r[t]=g_WacAnimationTelemetry.animationStats[i],t++);for(n=0;n<g_WacAnimationTelemetry.animationStatsIndex;n++)g_WacAnimationTelemetry.animationStats[n]!=null&&(r[t]=g_WacAnimationTelemetry.animationStats[n],t++);return r};WacAnimationTelemetry.prototype.GetAnimationSqmStats=function(){var n=[];return n[0]=g_WacAnimationTelemetry.avgSessionFps<0?0:g_WacAnimationTelemetry.avgSessionFps,n[1]=g_WacAnimationTelemetry.minSessionFps<0?0:g_WacAnimationTelemetry.minSessionFps,n[2]=g_WacAnimationTelemetry.maxSessionFps<0?0:g_WacAnimationTelemetry.maxSessionFps,n};g_WacAnimationTelemetry=new WacAnimationTelemetry;g_LastAnimationData=null;WacAnimation.Telemetry=g_WacAnimationTelemetry;Type.registerNamespace("_Ewa");_Ewa.bdz=function(){};_Ewa.bdz.a=function(){_Ewa.bB.a().b(_Ewa.mz,141,new _Ewa.Fm)};_Ewa.Fm=function(){_Ewa.Fm.initializeBase(this)};_Ewa.Fm.prototype={dispose:function(){Common.B.g()&&Common.B.f()},a:function(n,t,i,r,u){!t||!t.length||Common.B.b(n.a,t);Common.B.a(n,r,u);!i||!i.length||Common.B.o(n.a,i)}};_Ewa.Fm.registerClass("_Ewa.Fm",_Ewa.mz,Sys.IDisposable);_Ewa.bdz.a();Type.registerNamespace("_Ewa");_Ewa.Tq=function(n,t){this.sourceRange=n;this.destinationRange=t};_Ewa.Tq.prototype={sourceRange:null,destinationRange:null};_Ewa.MQ=function(n){this.e=[3];_Ewa.MQ.initializeBase(this,[!1]);this.a=n};_Ewa.MQ.prototype={a:null,c:function(){var n=this.a.c().a().a(_Ewa.gw,281,!1,null);return n||Diag.a.a(590751831,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes)."),n},l:function(n){this.et("mrek",n)},f:function(n,t,i){for(var f,u=this.a.G(),e=u.length,r=0;r<e;++r)f=u[r],Common.f.a().a("msospPointerMove",f.l(),n);Common.f.a().a("msospPointerUp",document.documentElement,t);this.a.k().o(!0);i&&Common.f.a().a("msospPointerLeave",this.a.D(),t)},g:function(n,t,i){for(var f,u=this.a.G(),e=u.length,r=0;r<e;++r)f=u[r],Common.f.a().b("msospPointerMove",f.l(),n);Common.f.a().b("msospPointerUp",document.documentElement,t);this.a.k().o(!1);i&&Common.f.a().b("msospPointerLeave",this.a.D(),t)},m:function(n,t){for(var u,r=this.a.G(),f=r.length,i=0;i<f;++i)u=r[i],Common.l.a().a("touchmove",u.l(),n);Common.l.a().a("touchend",document.documentElement,t)},n:function(n,t){for(var u,r=this.a.G(),f=r.length,i=0;i<f;++i)u=r[i],Common.l.a().b("touchmove",u.l(),n);Common.l.a().b("touchend",document.documentElement,t)},h:function(n,t,i,r){var u=document.createElement("div"),o;u.className=t;for(var e=i,s=e.length,f=0;f<s;++f)o=e[f],Sys.UI.DomElement.addCssClass(u,o);return n.appendChild(u),Common.f.a().a("msospPointerDown",u,r),u},i:function(n){var i=n.c.parentNode,t;return i?(t=parseInt(i.getAttribute("IndexInMarqueeCollection")),isNaN(t))?(Diag.a.b(590751829,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.a.i().f(3,1,t):(Diag.a.b(590751830,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null)},b:function(n,t,i){for(var f,e=i&&!!this.c()&&this.c().d(n),u=t,o=u.length,r=0;r<o;++r)f=u[r],_Ewa.b.b(f,e,!0)},d:function(){return this.a.O()?_Ewa.cG.a(this.a.c()):this.a.f()},k:function(){var n=this.d();n&&this.c()?this.c().c(n,null):(Diag.a.a(590751828,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.a.i().a(this.e),this.a.i().b(null,this.e,!0))},j:function(n,t){this.es("mrek",new _Ewa.MZ(n,t),null)}};_Ewa.MR=function(n,t,i,r){_Ewa.MR.initializeBase(this,[n,t,i,r])};_Ewa.MR.prototype={q:function(){return 19},i:function(){return this.a.a().a().e()},j:function(){var n=!this.a.a().a().d(),t=this.a.u()||this.a.m();return n&&!t&&_Ewa.bih.prototype.j.call(this)}};_Ewa.MS=function(n,t,i,r,u,f){var o;this.n=Function.createDelegate(this,this.s);_Ewa.MS.initializeBase(this,[n,t,i,u]);this.k=_Ewa.c.a(this.b);this.h=r;this.j=this.b.a().a(_Ewa.gw,281,!1,null);Diag.a.b(590751827,0,!!this.j,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");for(var s=this.i,h=s.length,e=0;e<h;++e)o=s[e],Common.f.a().a("msospPointerEnter",o,this.h.i),Common.f.a().a("msospPointerLeave",o,this.h.j);this.H(f)};_Ewa.MS.prototype={g:null,e:null,k:null,j:null,h:null,H:function(n){this.u.b(n,this.i,!0);this.h.n()},bn:function(n){Diag.a.a(590751826,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.k.bT(!0);this.e.l(!1);this.l(4);this.h.l(n.c);this.e.a().co();this.e.q(this.n);this.D(this.q,this.r);this.o=this.c.l()?1:this.c.p()?2:0},bo:function(){var n=this.p();return this.l(-1),this.m(this.q,this.r,!0),n},bl:function(){this.k.bT(!1);this.h.m(this.i[0]);this.e.a().v();this.e.s(this.n);this.u.k()},s:function(){this.M(!0)},M:function(n){Diag.a.a(590751825,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");n&&this.m(this.q,this.r,!0)},bm:function(n){return(this.e=this.u.d(),this.g=this.u.i(n),!this.e||!this.g||!this.g.a)?(Diag.a.b(590751824,0,!!this.e,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Diag.a.b(590751823,0,!!this.g,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Diag.a.b(590751822,0,!!this.g.a,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null):this.g.a},p:function(){return this.g?this.j.b(this.e,this.g,this.a):(Diag.a.b(590751821,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)},G:function(){return this.p()},Z:function(){return!0}};_Ewa.gH=function(n,t,i,r,u){this.N=Function.createDelegate(this,this.bA);this.F=Function.createDelegate(this,this.bD);this.E=Function.createDelegate(this,this.bB);this.K=Function.createDelegate(this,this.bE);this.I=Function.createDelegate(this,this.bC);this.v=Function.createDelegate(this,this.bz);this.bb=Function.createDelegate(this,this.bG);this.ba=Function.createDelegate(this,this.bF);this.bc=Function.createDelegate(this,this.bH);this.bd=Function.createDelegate(this,this.bI);this.s=_Ewa.a.c("Microsoft.Office.Excel.DragDropEnhancementsEnabled",!1);_Ewa.gH.initializeBase(this,[n,t,i,u]);this.be=r;this.h=null;this.k={};this.j=!1;this.n=!1;this.x=!1;this.L=!1;this.d.s(this.bd);this.d.m(this.bc);this.d.G(this.ba);this.d.f(this.bb)};_Ewa.gH.prototype={k:null,g:null,be:null,h:null,p:!1,e:!1,w:!1,j:!1,n:!1,x:!1,L:!1,O:0,t:0,dispose:function(){if(this.d&&(this.d.u(this.bd),this.d.l(this.bc),this.d.O(this.ba),this.d.j(this.bb)),this.k)for(var n=1;n<=4;n++)_Ewa.b.g(this.k[n.toString()]);this.g=null;this.k=null;this.n&&this.U(0);this.s&&this.x&&this.U(1);_Ewa.bid.prototype.dispose.call(this)},bn:function(n){this.j=!0;this.h=this.by(this.be.b(this.c.e()));this.s&&(this.y=n,Common.h.a().a("keydown",this.er.ownerDocument.body,this.v));var t=_Ewa.c.a(this.b);this.h&&!this.h.g(this.c)?(this.e=this.h.b===this.c.b&&this.h.d===this.c.d,this.g=this.e?[11]:[12],this.l(5),this.D(this.I,this.K),this.z(n.get_clientPoint(),n.c,this.e?11:12,!0)):(this.h=null,this.s?(this.e=this.c.l(),this.w=this.c.p(),this.e||this.w?(this.t=3,this.o=this.e?1:2,this.D(this.E,this.F),this.z(n.get_clientPoint(),n.c,this.e?11:12,!0),this.l(5),this.g=this.e?[11]:[12]):(this.t=2,this.o=0,this.D(this.q,this.r),this.z(n.get_clientPoint(),n.c,6,!1))):(this.D(this.q,this.r),Common.h.a().a("keydown",this.er.ownerDocument.body,this.v),this.o=this.c.l()?1:this.c.p()?2:0,this.z(n.get_clientPoint(),n.c,6,!1)));this.G()},bz:function(n){if(this.s){if(this.bf(n)||n.a.keyCode===16)return this.L||(Common.h.a().a("keyup",this.er.ownerDocument.body,this.N),this.L=!0),!this.n&&this.bf(n)&&(_Ewa.c.a(this.b).r().a("copy"),this.n=!0),this.x||n.a.keyCode!==16||(this.x=!0,this.t===2?(this.Q(),this.j=!0,Common.h.a().a("keydown",this.er.ownerDocument.body,this.v),this.o=0,this.g=this.e?[11]:[12],this.bs(),this.bu()):this.t===3&&(this.P(),this.j=!0,Common.h.a().a("keydown",this.er.ownerDocument.body,this.v),this.o=this.e?1:2,this.bt(),this.G())),!0}else if(!this.n&&(n.a.keyCode===17||Common.c.d()&&n.a.keyCode===18))return Common.h.a().a("keyup",this.er.ownerDocument.body,this.N),_Ewa.c.a(this.b).r().a("copy"),this.n=!0,!0;return!1},bA:function(n){return this.s?(this.bf(n)?(this.O=0,this.j&&_Ewa.c.a(this.b).r().a("move")):n.a.keyCode===16&&(this.O=1,this.t===2?(this.P(),this.j=!0,Common.h.a().a("keydown",this.er.ownerDocument.body,this.v),this.o=0,this.bt(),this.G()):this.t===3&&(this.Q(),this.j=!0,Common.h.a().a("keydown",this.er.ownerDocument.body,this.v),this.o=this.e?1:2,this.g=this.e?[11]:[12],this.bs(),this.bu())),this.U(this.O),!0):n.a.keyCode===17||Common.c.d()&&n.a.keyCode===18?(this.U(0),this.j&&_Ewa.c.a(this.b).r().a("move"),!0):!1},bo:function(){if(this.j=!1,this.s&&(this.t=0),this.f().a(_Ewa.gH.a),!this.b.R([this.a],!1,1,0))return this.m(this.q,this.r,!0),this.l(-1),!0;if(this.d.a().c().g(this.a)||this.R(this.a)||this.R(this.c))this.l(-1);else{this.S();this.d.z(this.c.f());var n=this.d.p(),t=this.d.a().c();this.b.v(-694765314,2,30,{DragDropForceIsCopy:this.n,DragDropSourceRange:n,DragDropDestinationRange:t})}return this.h||this.m(this.q,this.r,!0),!0},bl:function(){var n,t;for(Common.h.a().b("keydown",this.er.ownerDocument.body,this.v),n=1;n<=4;n++)t=this.k[n.toString()],t&&t.parentNode.removeChild(t),this.k[n.toString()]=null;this.g=null;this.j=!1},bE:function(n){var t,i;return n=_Ewa.u.a(this.b).a(n),this.C()===4?this.bx(n):(this.j=!1,this.f().a(this.g),!this.b.R([this.a],!1,1,0)||this.bK()||this.br()||(this.d.z(this.c.f()),this.bJ(),this.e?this.a.a>this.c.a&&(t=this.a.j(),this.a.a=this.a.a-t,this.a.c=this.a.c-t):this.a.b>this.c.b&&(i=this.a.k(),this.a.b=this.a.b-i,this.a.d=this.a.d-i),this.S())),this.m(this.I,this.K,!0),this.h=null,this.l(-1),!0},bD:function(){var i,r,n,t;return(this.j=!1,this.t=0,this.f().a(this.g),!this.b.R([this.a],!1,1,0))?(this.m(this.E,this.F,!0),this.l(-1),!0):(this.d.a().c().g(this.a)||this.R(this.a)||this.R(this.c)||this.br()||(this.S(),this.d.z(this.c.f()),i=this.d.p(),r=this.d.a().c(),this.b.v(-694765314,2,30,{DragDropForceIsCopy:this.n,DragDropForceIsInsert:!0,DragInsertIsVertical:this.p,DragDropSourceRange:i,DragDropDestinationRange:r}),this.n||(this.a.a>this.c.a&&(this.e||this.a.b===this.c.b&&this.p)?(n=this.a.j(),this.a.a=this.a.a-n,this.a.c=this.a.c-n):this.a.b>this.c.b&&(this.w||this.a.a===this.c.a&&!this.p)&&(t=this.a.k(),this.a.b=this.a.b-t,this.a.d=this.a.d-t),this.S())),this.m(this.E,this.F,!0),this.h=null,this.l(-1),this.p=!1,!0)},bC:function(n){var c=n.get_clientPoint(),t,i,u,o,f,s;if(n=_Ewa.u.a(this.b).a(n),t=this.d.h(c,n.c,4,!1,!0,!0),t){if(this.h.i(t.e())){var r=_Ewa.c.a(this.b),e=r.x(t,1,!1,!1),v=r.n(this.W),l=_Ewa.bT.b(v.j().b(),this.er.parentNode,c,r.d()),h=!1,a=2;if(this.e&&l.b-e.a.b>e.d()/2?(h=!0,a=1):!this.e&&l.a-e.a.a>e.c()/2&&(h=!0),h){i=r.s("DragSelectionClickBehavior.OnPointerMoveRearrange",r.R(),a,!0);try{i.b(t,!0);i.$$mn();t=i.$$cu().b()}finally{i&&i.dispose()}}if(this.a=this.bq(t),this.d.z(this.a),this.f().b(this.a,this.g,!0),this.f().d(this.g,null,null),this.f().a(_Ewa.gH.a),this.C()!==5){for(u=1;u<=4;u++)o=this.k[u.toString()],o.parentNode.removeChild(o),this.f().f(this.e?11:12,u,0).b.appendChild(o);this.l(5)}}else if(this.a=this.bk(t),this.f().b(this.a,_Ewa.gH.a,!0),this.f().d(_Ewa.gH.a,null,null),this.f().a(this.g),this.C()!==4){for(f=1;f<=4;f++)s=this.k[f.toString()],s.parentNode.removeChild(s),this.f().f(6,f,0).b.appendChild(s);this.l(4)}this.T()}return!0},bB:function(n){var v=n.get_clientPoint(),t,f,e,o,l,s,a;if(n=_Ewa.u.a(this.b).a(n),this.y=n,t=this.d.h(v,n.c,4,!1,!0,!0),t){var r=_Ewa.c.a(this.b),i=r.x(t,1,!1,!1),y=r.n(this.W),h=_Ewa.bT.b(y.j().b(),this.er.parentNode,v,r.d()),u=!1,c=2;if(this.p=!1,this.e||this.w){if(this.e&&h.b-i.a.b>i.d()/2?(u=!0,c=1):this.w&&h.a-i.a.a>i.c()/2&&(u=!0),u){f=r.s("DragSelectionClickBehavior.OnPointerMoveDragInsert",r.R(),c,!0);try{f.b(t,!0);f.$$mn();t=f.$$cu().b()}finally{f&&f.dispose()}}this.a=this.bk(t)}else{if(h.a-i.a.a===i.c()?(this.p=!1,u=!0):h.b-i.a.b>i.d()/2&&(u=!0,this.p=!0,c=1),u){e=r.s("DragSelectionClickBehavior.OnPointerMoveDragInsert",r.R(),c,!0);try{e.b(t,!0);e.$$mn();t=e.$$cu().b()}finally{e&&e.dispose()}}for(this.f().a(this.g),this.g=this.p?[11]:[12],o=1;o<=4;o++)l=this.k[o.toString()],l&&l.parentNode.removeChild(l),this.k[o.toString()]=null;this.z(n.get_clientPoint(),n.c,this.p?11:12,!0);this.a=this.bq(t)}if(this.d.z(this.a),this.f().b(this.a,this.g,!0),this.f().d(this.g,null,null),this.f().a(_Ewa.gH.a),this.C()!==5){for(s=1;s<=4;s++)a=this.k[s.toString()],a.parentNode.removeChild(a),this.f().f(this.e||this.p?11:12,s,0).b.appendChild(a);this.l(5)}this.T()}return!0},bm:function(){return this.d.a().c()},S:function(){return this.d.d(this.a,this.a.e(),0,0,!0,"",!1,!0,!0),!0},G:function(){return this.f().b(this.a,_Ewa.gH.a,!0),this.f().d(_Ewa.gH.a,null,null),this.T(),!0},bu:function(){this.f().b(this.a,this.g,!0);this.f().d(this.g,null,null);this.T()},bH:function(){Sys.UI.DomElement.removeCssClass(this.er,"selecting")},bI:function(){Sys.UI.DomElement.addCssClass(this.er,"selecting")},bG:function(){if(this.b.j()){var n=this.bL();this.bp(n)}},bF:function(){this.s?this.j&&this.C()>=4&&(this.h?(this.f().a(this.g),this.m(this.I,this.K,!0)):this.x?this.e||this.w?this.Q():this.P():this.e||this.w?this.P():this.Q()):this.j&&this.C()>=4&&(this.h?(this.f().a(this.g),this.m(this.I,this.K,!0)):(this.f().a(_Ewa.gH.a),this.m(this.q,this.r,!0)))},M:function(){Diag.a.a(590751820,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")},Z:function(){return!1},bL:function(){var t,r;if(!_Ewa.c.a(this.b).a().a().d())return!1;t=_Ewa.c.a(this.b).C(this.d.a().c());for(var i=t,u=i.length,n=0;n<u;++n)if(r=i[n],_Ewa.cB.isInstanceOfType(r))return!1;return!0},by:function(n){if(n&&n.i(this.c)&&!n.g(this.c)){if(n.q&&this.c.c===this.c.a&&this.c.a===n.a){var t=new _Ewa.p(this.c.a,this.c.b,n.c,this.c.d,!1,!1);if(!t.g(n))return this.c=t,this.d.d(this.c,this.c.e(),0,0,!0,"",!1,!0,!0),n}if(this.e=n.b===this.c.b&&n.d===this.c.d,n.a===this.c.a&&n.c===this.c.c||this.e)return n}return null},bq:function(n){var t=n.f();return this.e?t.b=Math.max(n.b-this.V,1):t.a=Math.max(n.a-this.X,1),t.d=t.b+this.c.k()-1,t.c=t.a+this.c.j()-1,this.bv(t)},br:function(){var n=this.a.e().h(this.c);return(n||this.s&&!this.h)?n:this.e?this.a.a===this.c.c+1:this.a.b===this.c.d+1},bK:function(){if(this.e&&this.a.b!==this.h.b||!this.e&&this.a.a!==this.h.a){var n=_Ewa.i.b(1,1,0,859,0,2065438552,"RearrangeInvalidDest");return _Ewa.A.a(this.b).d([n]),!0}return!1},bJ:function(){var n={};this.e?(n.FirstRow=this.a.a-1,n.FirstColumn=0,n.DeltaColumn=0,n.DeltaRow=this.a.c-this.a.a+1):(n.FirstRow=0,n.FirstColumn=this.a.b-1,n.DeltaColumn=this.a.d-this.a.b+1,n.DeltaRow=0);n.LastRow=1048575;n.LastColumn=16383;n.SheetName=this.b.d().a()?this.b.d().a().a():this.b.m().b(this.b.m().a().a()).P;var t=_Ewa.h.a(this.c,this.b),u=this,i=function(i,r,f){return _Ewa.MX.a(u.b.c().a(),t,n,i,r,f,null,null)},f=this,r=function(){return new _Ewa.Tq(t,n)};_Ewa.a.d()?this.b.f().a(new _Ewa.t(514,0,i,64,r),null):this.b.f().a(new _Ewa.ba(514,0,i,0,r),null)},R:function(n){for(var r,u,i=_Ewa.c.a(this.b).C(n),t=0,f=i.length;t<f;++t)if(r=i[t],_Ewa.cB.isInstanceOfType(r))return u=_Ewa.i.b(1,0,0,854,0,2105176604,"InsDelCellsPivotTable"),_Ewa.A.a(this.b).d([u]),!0;return!1},z:function(n,t,i,r){for(var o,s,e=_Ewa.b.h(t),u=t===this.i[0]||t===this.i[1],h=u?e.width:e.height,c=(u?-25:-50)+"px",l=u?t===this.i[0]?"top":"bottom":t===this.i[3]||r?"right":"left",a=(u?r?0:n.x-e.x:n.y-e.y)*100/h,f=1;f<=4;f++)o=document.createElement("div"),o.className="ewr-selection-dragtooltip",this.k[f.toString()]=o,this.f().f(i,f,0).b.appendChild(o),s=this.k[f.toString()],s.style[l]=c,s.style[u?"left":"top"]=a+"%"},T:function(){for(var t=this.a.toString(),n=1;n<=4;n++)this.k[n.toString()].innerText=t},U:function(n){n?n===1&&(this.x=!1):this.n=!1;this.s&&(this.n||this.x)||(Common.h.a().b("keyup",this.er.ownerDocument.body,this.N),this.L=!1)},Q:function(){this.f().a(_Ewa.gH.a);this.m(this.q,this.r,!0)},P:function(){this.f().a(this.g);this.m(this.E,this.F,!0)},bt:function(){this.l(4);this.D(this.q,this.r);this.z(this.y.get_clientPoint(),this.y.c,6,!1)},bs:function(){this.l(5);this.D(this.E,this.F);this.z(this.y.get_clientPoint(),this.y.c,this.e?11:12,!0)},bf:function(n){return n.a.keyCode===17||Common.c.d()&&n.a.keyCode===18}};_Ewa.bid=function(n,t,i,r){var e,o;this.bh=Function.createDelegate(this,this.bQ);this.bg=Function.createDelegate(this,this.bN);this.r=Function.createDelegate(this,this.bP);this.q=Function.createDelegate(this,this.bO);this.bw=_Ewa.a.c("Microsoft.Office.Excel.DragDropEnhancementsEnabled",!1);_Ewa.bid.initializeBase(this,[n]);this.i=[];this.b=t;this.d=_Ewa.c.a(this.b).a();this.W=i;this.u=r;for(var s=_Ewa.a.c("Microsoft.Office.Excel.CanvasHitTest",!1),h=Common.c.a(),c=s&&!h?["ewr-selection-draghandle-top","ewr-selection-draghandle-bottom","ewr-selection-draghandle-left","ewr-selection-draghandle-right"]:["ewr-selection-draghandle-top-ie","ewr-selection-draghandle-bottom-ie","ewr-selection-draghandle-left-ie","ewr-selection-draghandle-right-ie"],f=c,l=f.length,u=0;u<l;++u)e=f[u],o=this.u.h(n,e,["ewr-selection-draghandle"],this.bg),Array.add(this.i,o);this.b.B(this.bh);this.bp(this.b.j())};_Ewa.bid.prototype={Y:!1,bj:null,bi:null,A:0,b:null,d:null,u:null,o:0,W:0,V:0,X:0,B:null,i:null,c:null,a:null,y:null,f:function(){return _Ewa.c.a(this.b).i()},C:function(){return this.d.v()},l:function(n){return this.d.r(n),n},dispose:function(){var n=this;Array.forEach(this.i,function(t){Common.f.a().b("msospPointerDown",t,n.bg)});Array.clear(this.i);this.a=null;this.c=null;this.B=null;Diag.a.a(590751819,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.A,!this.b);this.b&&(this.b.C(this.bh),this.A===1&&(Diag.a.a(590751818,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.m(this.bi,this.bj,!1)));_Ewa.jY.prototype.dispose.call(this)},bP:function(n){return n=_Ewa.u.a(this.b).a(n),this.bx(n)},bx:function(n){if(this.C()!==4)return!1;var t=this.bo(n);return t||this.M(!1),_Ewa.bH.b(this.b,!1),t},bN:function(n){var i,t;if(n=_Ewa.u.a(this.b).a(n),n.b===2&&!n.f&&!this.Y){if(i=this.bm(n),!i)return Diag.a.b(590751817,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.a=i.f();this.c=this.a.f();this.B=this.a;t=this.bM(n);t&&(this.l(4),this.X=t.a-this.c.a,this.V=t.b-this.c.b,_Ewa.c.a(this.b).r().a("move"),this.bn(n),this.Y=!0,_Ewa.bH.b(this.b,!0))}return!1},bO:function(n){var t,i,r;if(this.bw&&(this.y=n),n=_Ewa.u.a(this.b).a(n),t=this.d.h(n.get_clientPoint(),n.c,4,!1,!0,!0),t){if(i=this.bk(t),this.a.g(i))return!0;if(this.a=i,r=this.G(),!r)return Diag.a.b(590751816,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.M(!0),!1}return!0},D:function(n,t){Diag.a.b(590751815,0,!this.A,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.A+=1;this.bi=n;this.bj=t;this.u.f(n,t,this.Z())},bk:function(n){if(!n||!this.a)return Diag.a.b(590751814,0,!!n,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Diag.a.b(590751813,0,!!this.a,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var t=this.a.f();return this.o!==1&&(t.b=Math.max(n.b-this.V,1),t.d=t.b+this.c.k()-1),this.o!==2&&(t.a=Math.max(n.a-this.X,1),t.c=t.a+this.c.j()-1),this.bv(t)},m:function(n,t,i){Diag.a.b(590751812,0,this.A===1,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");this.A-=1;_Ewa.c.a(this.b).r().a(null);this.u.g(n,t,this.Z());i&&this.bl();this.o=0;this.Y=!1},bv:function(n){var r=_Ewa.c.a(this.b),t=n,u,f,i;if(r.h().l()){if(u=r.g(n.e()),!u){f=this.B.a!==n.a?1:2;i=r.s("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",r.R(),f,!0);try{i.c(this.B.a<n.a||this.B.b<n.b);i.b(n.e(),!0);t=i.$$cu().b()}finally{i&&i.dispose()}}t.d=t.b+n.k()-1;t.c=t.a+n.j()-1}return this.B=t,t},bp:function(n){var t=this;Array.forEach(this.i,function(t){_Ewa.b.b(t,n,!0)})},bQ:function(n,t){t.b||this.bp(this.b.j())},bM:function(n){var t=n.c,i=n.get_clientPoint();return!t||!i?(Diag.a.b(590751811,0,!!t,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Diag.a.b(590751810,0,!!i,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null):(i.y+=t===this.i[0]?2:t===this.i[1]?-2:0,i.x+=t===this.i[2]?2:t===this.i[3]?-2:0,this.d.h(i,t,4,!1,!0,!0))}};_Ewa.MT=function(n,t){this.e=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.q);this.c=Function.createDelegate(this,this.n);this.j=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.v);this.l=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.s);this.i=Function.createDelegate(this,this.t);this.d=Function.createDelegate(this,this.o);this.g=Function.createDelegate(this,this.r);_Ewa.MT.initializeBase(this,[n]);this.a=t;var i=document.createElement("div");i.className="ewr-selection-fillhandle";this.b=i;this.m(null,null);n.appendChild(i);Common.f.a().a("msospPointerDown",this.b,this.g);Common.j.a().a("dblclick",this.b,this.d);this.a.a().s(this.i);this.a.a().m(this.h);this.a.c().B(this.l);this.a.c().n().l(this.k);this.a.c().n().k(this.j);_Ewa.a.a("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(this.a.cr(this.c),this.a.k().d(this.f),this.a.k().h(this.e))};_Ewa.MT.prototype={a:null,b:null,dispose:function(){Common.f.a().b("msospPointerDown",this.b,this.g);Common.j.a().b("dblclick",this.b,this.d);this.a.c()&&(this.a.a().u(this.i),this.a.a().l(this.h),this.a.c().C(this.l),this.a.c().n().q(this.k),this.a.c().n().p(this.j),_Ewa.a.a("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(this.a.cF(this.c),this.a.k().c(this.f),this.a.k().f(this.e)));_Ewa.jY.prototype.dispose.call(this)},s:function(){Sys.UI.DomElement.removeCssClass(this.er,"selecting");_Ewa.cO.b(this.a.c(),!0,"FillHandleClickBehavior:OnSelectionEnded")},t:function(){Sys.UI.DomElement.addCssClass(this.er,"selecting")},r:function(n){return n.b!==2||n.f||(this.a.a().r(3),this.a.a().z(this.a.a().a().c()),_Ewa.cO.b(this.a.c(),!1,"FillHandleClickBehavior:OnSelectionStarted")),!1},o:function(){return this.a.c().v(1983983164,2,30,null),!0},m:function(){_Ewa.b.b(this.b,this.a.c().j(),!0)},v:function(){_Ewa.b.b(this.b,!1,!0)},u:function(){_Ewa.b.b(this.b,!0,!0)},q:function(){_Ewa.b.b(this.b,!1,!0)},p:function(){_Ewa.b.b(this.b,!0,!0)},n:function(n,t){var i=t.a;_Ewa.b.b(this.b,!i,!0)}};_Ewa.MW=function(n,t){this.d=Function.createDelegate(this,this.g);_Ewa.MW.initializeBase(this,[!1]);this.f=n;this.a=_Ewa.c.a(n);this.e=t;this.b=new _Ewa.MY(this.a);this.c=new _Ewa.MQ(this.a);this.a.i()&&(this.a.i().n(this.d),this.a.i().e(!1,!0));n.a().b(Sys.IDisposable,64,this)};_Ewa.MW.prototype={a:null,e:null,f:null,b:null,c:null,dispose:function(){this.a.i().r(this.d);this.b&&(this.b.o(),this.b=null);_Ewa.bgJ.prototype.dispose.call(this)},g:function(n,t){var e=t.a,f=this.a,i=t.d,r=i.b,u=i.e;Common.c.c()&&Array.add(u,new _Ewa.pf(r,f));switch(e){case 24:Array.add(i.e,new _Ewa.Na(r,i));break;case 0:Array.add(i.e,new _Ewa.MT(r,f));Common.c.f()||Array.add(u,new _Ewa.gH(r,this.a.c(),i.d,this.e,this.c));Array.add(u,new _Ewa.Ng(i,r,f,i.d));break;case 3:Array.add(u,new _Ewa.rI(r));Common.c.f()||(Array.add(u,new _Ewa.MS(r,this.a.c(),i.d,this.b,this.c,i)),Array.add(u,new _Ewa.Nd(r,this.a,this.b,this.c,i)),Array.add(u,new _Ewa.Ne(r,this.a,this.b,this.c,i)));break;case 4:case 5:Array.add(u,new _Ewa.lG(r));break;case 30:Array.add(u,new _Ewa.Nf(r));break;case 16:Array.add(u,new _Ewa.lH(r));Array.add(u,new _Ewa.Nb(i,r,f,i.d));break;case 11:case 12:Array.add(u,new _Ewa.Nc(r,e===11));break;case 17:Array.add(u,new _Ewa.rI(r));break;case 19:Array.add(u,new _Ewa.rI(r));Array.add(u,new _Ewa.MR(i,r,f,i.d))}i.j=!0}};_Ewa.pf=function(n,t){this.b=Function.createDelegate(this,this.c);_Ewa.pf.initializeBase(this,[n,null]);this.a=t;Common.j.a().a("click",n,this.b)};_Ewa.pf.prototype={a:null,c:function(n){var v=n.a,i=this.a.co(n.get_clientPoint()),r,l,t,u;if(!i)return!1;var f=i.b,y=this.a.b().r(f.b()),s=y.l(i.a);if(!s)return!1;var b=n.d,h=f.f().l(),p=_Ewa.j.O(_Ewa.j.n(f.d(),h),i.a),e=0,c=this.a.g(s.a());for(r=0,l=_Ewa.pf.a.length;r<l;++r)if((t=_Ewa.pf.a[r],t!==128&&t!==64||!this.a.c().j())&&(u=c.o(t,"click"),u&&u.a.style.display!=="none")){var o=u.a,a=_Ewa.j.n(o,h),w=new Sys.UI.Bounds(a.x,a.y,o.offsetWidth,o.offsetHeight);if(Common.g.d(w,p)){e=t;break}}return e?(c.H(e,v),!0):!1}};_Ewa.MY=function(n){this.e=Function.createDelegate(this,this.r);this.k=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.q);this.i=Function.createDelegate(this,this.p);this.b=n;this.c=0;this.d=!1;this.f=!1;this.a=Number.NaN;this.b.a().s(this.k);this.b.a().m(this.e);this.b.a().G(this.e)};_Ewa.MY.prototype={b:null,c:0,d:!1,f:!1,a:0,o:function(){this.b.a().u(this.k);this.b.a().l(this.e);this.b.a().O(this.e)},n:function(){this.c=0;this.d=!1;this.a=Number.NaN},p:function(n){var t=n.c;return this.g(t,1),!0},q:function(n){var t=n.c;return this.g(t,-1),!0},l:function(n){this.d=!0;this.g(n,1)},m:function(n){this.d=!1;this.g(n,-1)},g:function(n,t){if(!n){Diag.a.b(590751778,0,!!n,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.");return}if(!n.parentNode){Diag.a.b(590751777,0,!!n.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");return}if(this.f){isNaN(this.a)||(this.h(this.a,!1),this.a=Number.NaN);return}var r=n.parentNode,i=parseInt(r.getAttribute("IndexInMarqueeCollection"));if(isNaN(i)){Diag.a.b(590751776,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");return}if(!isNaN(this.a)&&i!==this.a){if(this.d)return;this.h(this.a,!1)}(isNaN(this.a)||i!==this.a)&&(this.a=i,this.c=0);!this.c&&t>0&&this.h(i,!0);this.c=Math.max(this.c+t,0);!this.c&&t<0&&(this.h(i,!1),this.a=Number.NaN)},h:function(n,t){for(var f,u,i,r=1;r<=4;r++)for(f=this.b.i().f(3,r,n),u=f.b,_Ewa.b.i(u,"ewr-marquee-thick",t),i=u.firstChild;i;i=i.nextSibling)_Ewa.f.c(i.className,"resizemarqueehandle",!0)&&_Ewa.b.i(i,"ewr-resizemarqueehandle-thick",t)},r:function(){this.f=!1},s:function(){this.f=!0}};_Ewa.MZ=function(n,t){_Ewa.MZ.initializeBase(this);this.b=n;this.a=t};_Ewa.MZ.prototype={b:!1,a:0};_Ewa.Na=function(n,t){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.l);_Ewa.Na.initializeBase(this,[n,null]);this.a=$$as(_Ewa.ou,t.h);this.b=document.createElement("div");this.b.id=String.format("{0}-{1}",n.id,"HighlightContainer");this.b.className="CatchUpDotOuterDiv";this.c=document.createElement("div");this.c.id=String.format("{0}-{1}",n.id,"HighlightDot");this.c.className="CatchUpActivityHighlightDot";this.b.appendChild(this.c);n.appendChild(this.b);Diag.a.a(590751775,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Common.f.a().a("msospPointerEnter",this.b,this.g);Common.f.a().a("msospPointerLeave",this.b,this.h);Common.f.a().a("msospPointerDown",this.b,this.f);Common.G.a().a("click",this.b,this.e);Common.G.a().a("dblclick",this.b,this.d)};_Ewa.Na.prototype={c:null,b:null,a:null,dispose:function(){Common.f.a().b("msospPointerEnter",this.b,this.g);Common.f.a().b("msospPointerLeave",this.b,this.h);Common.f.a().b("msospPointerDown",this.b,this.f);Common.G.a().b("click",this.b,this.e);Common.G.a().b("dblclick",this.b,this.d);_Ewa.b.g(this.c);this.c=null;_Ewa.b.g(this.b);this.b=null;this.a=null;_Ewa.jY.prototype.dispose.call(this)},H:function(n){this.a=$$as(_Ewa.ou,n.h)},l:function(){return this.a?(this.a.o(this.c,!1),this.a.m(this.c,!1),this.a.a.a===3)?!0:(this.a.n(!0),!0):(Diag.a.b(590751774,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1)},m:function(){return this.a?(this.a.s(!1),this.a.j(this.c,!1),this.a.a.a===3)?!0:(this.a.n(!1),!0):!1},k:function(n){return this.a?n.b===2&&!n.f?!0:!1:!1},j:function(){return this.a?(this.a.j(this.c,!0),this.a.o(this.c,!0),this.a.m(this.c,!0),this.a.g(!0),!0):!1},i:function(n){return n.a?(n.a.stopPropagation(),!0):(Diag.a.a(590751773,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill."),!0)}};_Ewa.Nb=function(n,t,i,r){_Ewa.Nb.initializeBase(this,[n,t,i,r])};_Ewa.Nb.prototype={q:function(){return 16},i:function(){return this.a.a().o().b(!1)},j:function(){return(this.a.F()||this.a.u())&&_Ewa.bih.prototype.j.call(this)}};_Ewa.Nc=function(n,t){_Ewa.Nc.initializeBase(this,[n,null]);var i=document.createElement("div"),r=document.createElement("div");i.className=t?"ewr_selection_rearrangeleft":"ewr_selection_rearrangetop";r.className=t?"ewr_selection_rearrangeright":"ewr_selection_rearrangebottom";n.appendChild(i);n.appendChild(r)};_Ewa.big=function(n,t,i,r,u){var h,c,o;this.j=Function.createDelegate(this,this.O);this.i=Function.createDelegate(this,this.N);this.t=Function.createDelegate(this,this.L);this.u=Function.createDelegate(this,this.M);_Ewa.big.initializeBase(this,[n,null]);this.n=t;this.g=t.c();this.b=[];this.m=this.n.a();this.k=i;this.a=r;this.f=u;this.p=this.g.a().a(_Ewa.gw,281,!1,null);Diag.a.b(590751772,0,!!this.p,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");for(var s=this.A(),a=s.length,f=0;f<a;++f)h=s[f],c=this.a.h(n,h,this.v(),this.u),Array.add(this.b,c);for(var l=this.b,v=l.length,e=0;e<v;++e)o=l[e],Common.f.a().a("msospPointerEnter",o,this.k.i),Common.f.a().a("msospPointerLeave",o,this.k.j);this.H(u)};_Ewa.big.prototype={h:null,e:null,g:null,m:null,c:0,k:null,d:null,l:null,s:!1,n:null,p:null,a:null,f:null,b:null,dispose:function(){var n=this;Array.forEach(this.b,function(t){Common.f.a().b("msospPointerDown",t,n.u)});Array.clear(this.b);_Ewa.jY.prototype.dispose.call(this)},H:function(n){this.f=n;this.w(n);this.a.b(n,this.b,this.r());this.k.n()},M:function(n){var t,i;if(n=_Ewa.u.a(this.g).a(n),this.B(n)&&!this.s){if(this.y(),this.e=this.a.d(),this.h=this.a.i(n),!this.e||!this.h||!this.h.a)return Diag.a.b(590751771,0,!!this.e,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Diag.a.b(590751770,0,!!this.h,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Diag.a.b(590751769,0,!!this.h.a,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;if(this.l=this.h.a.f(),this.d=this.l.f(),this.c=this.x(n),this.c===4)return Diag.a.b(590751768,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;if(t=this.F(n,!0),!t)return Diag.a.b(590751767,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(i=this.E(t),!i)return Diag.a.b(590751766,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.n.bT(!0);this.e.l(!1);this.k.l(n.c);this.a.j(!0,this.f.f);this.e.a().co();this.e.q(this.t);this.z();this.s=!0;_Ewa.bH.b(this.g,!0)}return!0},N:function(n){var i,t,r;return(n=_Ewa.u.a(this.g).a(n),i=this.F(n,!1),!i)?!0:(t=this.E(i),!t)?(Diag.a.b(590751765,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.q(!0),!1):this.l.g(t)?!0:(this.l=t,r=this.P(),r||(Diag.a.b(590751764,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.q(!0)),r)},O:function(n){var t,i;return n=_Ewa.u.a(this.g).a(n),t=this.I(),Diag.a.b(590751763,0,t,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed"),Common.c.i()&&(this.m.M(!0),i=this,window.setTimeout(function(){i.m.M(!1)},100)),this.q(!t),t},F:function(n,t){var r=n.c,i=n.get_clientPoint(),u;return!r||!i?(Diag.a.b(590751762,0,!!r,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Diag.a.b(590751761,0,!!i,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null):(t&&(i=this.G(i)),u=this.m.h(i,r,0,!0,!1,!0),u||(i=this.G(i),u=this.m.h(i,r,0,!0,!1,!0)),u)},G:function(n){return n.y+=!this.c||this.c===1?2:-2,n.x+=!this.c||this.c===2?2:-2,n},E:function(n){if(!n||!this.d)return Diag.a.b(590751760,0,!!n,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Diag.a.b(590751759,0,!!this.d,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(this.c){if(this.c===1)return new _Ewa.p(n.a,this.d.b,this.d.c,n.d,!0,!1);if(this.c===2)return new _Ewa.p(this.d.a,n.b,n.c,this.d.d,!0,!1);if(this.c===3)return new _Ewa.p(this.d.a,this.d.b,n.c,n.d,!0,!1)}else return new _Ewa.p(n.a,n.b,this.d.c,this.d.d,!0,!1);return Diag.a.b(590751758,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",_Ewa.big.a.toString(this.c)),null},I:function(){return this.p.b(this.e,this.h,this.l)},P:function(){return this.I()},L:function(){this.q(!0)},q:function(n){n&&Diag.a.a(590751757,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.k.m(this.b[0]);this.a.j(!1,this.f.f);this.e.a().v();this.e.s(this.t);this.C();this.n.bT(!1);this.s=!1;_Ewa.bH.b(this.g,!1);this.a.k()}};_Ewa.big.a=function(){};_Ewa.big.a.prototype={topLeft:0,topRight:1,bottomLeft:2,bottomRight:3,error:4};_Ewa.big.a.registerEnum("_Ewa.big.a",!1);_Ewa.Nd=function(n,t,i,r,u){_Ewa.Nd.initializeBase(this,[n,t,i,r,u])};_Ewa.Nd.prototype={A:function(){return["ewr-selection-resizemarqueehandle-topleft","ewr-selection-resizemarqueehandle-topright","ewr-selection-resizemarqueehandle-bottomleft","ewr-selection-resizemarqueehandle-bottomright"]},v:function(){return["ewr-selection-resizemarqueehandle"]},x:function(n){var t=n.c;return t===this.b[0]?0:t===this.b[1]?1:t===this.b[2]?2:t===this.b[3]?3:(Diag.a.b(590751756,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle."),4)},z:function(){this.a.f(this.i,this.j,!0)},C:function(){this.a.g(this.i,this.j,!0)},B:function(n){return _Ewa.K.b(n.b)===2&&!n.f},r:function(){return!0},y:function(){Diag.a.a(590751755,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")},w:function(n){for(var r,i=this.b,u=i.length,t=0;t<u;++t)r=i[t],r.style.backgroundColor=n.b.style.borderColor}};_Ewa.Ne=function(n,t,i,r,u){this.K=Function.createDelegate(this,this.R);this.D=Function.createDelegate(this,this.Q);_Ewa.Ne.initializeBase(this,[n,t,i,r,u]);_Ewa.K.f(this.D);this.o=_Ewa.K.a===3;this.a.l(this.K)};_Ewa.Ne.prototype={o:!1,dispose:function(){_Ewa.K.g(this.D);_Ewa.big.prototype.dispose.call(this)},A:function(){return["ewr-grippie-marquee-topleft","ewr-grippie-marquee-bottomright"]},v:function(){var t=_Ewa.a.c("Microsoft.Office.Excel.CanvasHitTest",!1),i=Common.c.a(),n=!t||i,r=n?"ewr-grippie-circle-ie":"ewr-grippie-circle",u=n?"ewr-grippie-ie":"ewr-grippie";return[u,"ewr-grippie-circle-container",r]},x:function(n){var t=n.c;return t===this.b[0]?0:t===this.b[1]?3:(Diag.a.b(590751754,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle."),4)},z:function(){Common.c.h()?this.a.f(this.i,this.j,!1):this.a.m(this.i,this.j)},C:function(){Common.c.h()?this.a.g(this.i,this.j,!1):this.a.n(this.i,this.j)},B:function(n){return _Ewa.K.b(n.b)===3},r:function(){return _Ewa.K.a===3},y:function(){Diag.a.a(590751753,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")},w:function(){},Q:function(){var n=_Ewa.K.a===3;this.o&&!n?this.a.b(this.f,this.b,!1):!this.o&&n&&this.a.b(this.f,this.b,!0);this.o=n},R:function(n,t){t.a===this.f.f&&this.a.b(this.f,this.b,!t.b&&this.r())}};_Ewa.rI=function(n){_Ewa.rI.initializeBase(this,[n,null]);var t=document.createElement("div");t.className="ewr-selection-inner-border";n.appendChild(t)};_Ewa.lG=function(n){_Ewa.lG.initializeBase(this,[n,null]);_Ewa.lG.a(n,"ewr-selection-ants-top ewr-ants");_Ewa.lG.a(n,"ewr-selection-ants-right ewr-ants");_Ewa.lG.a(n,"ewr-selection-ants-bottom ewr-ants");_Ewa.lG.a(n,"ewr-selection-ants-left ewr-ants");_Ewa.lG.a(n,"ewr-selection-ants-hc")};_Ewa.lG.a=function(n,t){var i=document.createElement("div");i.className=t;n.appendChild(i)};_Ewa.Nf=function(n){_Ewa.Nf.initializeBase(this,[n,null]);appChrome.renderSpinner(n)};_Ewa.lH=function(n){_Ewa.lH.initializeBase(this,[n,null]);_Ewa.lH.a(n,"ewr-selection-rangepicker-ants-top ewr-ants");_Ewa.lH.a(n,"ewr-selection-rangepicker-ants-right ewr-ants");_Ewa.lH.a(n,"ewr-selection-rangepicker-ants-bottom ewr-ants");_Ewa.lH.a(n,"ewr-selection-rangepicker-ants-left ewr-ants");_Ewa.lH.a(n,"ewr-selection-rangepicker-ants-hc")};_Ewa.lH.a=function(n,t){var i=document.createElement("div");i.className=t;n.appendChild(i)};_Ewa.Ng=function(n,t,i,r){_Ewa.Ng.initializeBase(this,[n,t,i,r])};_Ewa.Ng.prototype={q:function(){return 0},i:function(){return this.a.a().a().c()},j:function(){var n=this.a.a().a().d(),t=this.a.u()||this.a.m();return n&&!t&&_Ewa.bih.prototype.j.call(this)}};_Ewa.bih=function(n,t,i,r){var u,e,f,s,c;this.I=Function.createDelegate(this,this.bj);this.C=Function.createDelegate(this,this.be);this.z=Function.createDelegate(this,this.Z);this.y=Function.createDelegate(this,this.Y);this.F=Function.createDelegate(this,this.bh);this.D=Function.createDelegate(this,this.bf);this.n=Function.createDelegate(this,this.bl);this.w=Function.createDelegate(this,this.W);this.E=Function.createDelegate(this,this.bg);this.v=Function.createDelegate(this,this.Q);this.K=Function.createDelegate(this,this.bk);this.A=Function.createDelegate(this,this.ba);this.B=Function.createDelegate(this,this.bb);this.x=Function.createDelegate(this,this.X);this.m=Function.createDelegate(this,this.bd);this.l=Function.createDelegate(this,this.bc);this.G=Function.createDelegate(this,this.bi);_Ewa.bih.initializeBase(this,[t,null]);u=i.c();this.a=i;this.d=i.a();this.r=n;this.M=t;this.u=r;e=this.er.currentStyle;f="#000000";e&&(f=e.borderTopColor);this.c=new _Ewa.kd(this.L(),f,u);this.b=new _Ewa.kd(this.L(),f,u);this.p=u.b().b()&&u.k().NovMode===1;this.c.j(this.G);this.c.i(this.l);this.c.k(this.m);this.b.j(this.x);this.b.i(this.l);this.b.k(this.m);for(var h=this.a.G(),l=h.length,o=0;o<l;++o)s=h[o],Common.l.a().a("touchstart",s.l(),this.B),Common.l.a().a("touchend",s.l(),this.A);i.j().d(this.K);i.f().d(this.v);i.i().g(this.E);i.bI(this.w);u.S(this.n);i.B(this.n);this.d.m(this.D);this.d.s(this.F);i.M(this.y);this.d.A(this.z);_Ewa.K.f(this.C);c=this;_Ewa.g.a(_Ewa.l.b(_Ewa.iY,u.a(),376,377,0,null),function(n){n.a().a(c.I)},u.g(),3,null,null)};_Ewa.bih.prototype={r:null,M:null,c:null,b:null,d:null,k:!1,o:!1,t:!1,p:!1,h:null,u:0,s:!1,f:!1,a:null,dispose:function(){var t,i;System.a.b([this.c,this.b]);this.c.m(this.G);this.c.l(this.l);this.c.n(this.m);this.b.m(this.x);this.b.l(this.l);this.b.n(this.m);for(var r=this.a.G(),u=r.length,n=0;n<u;++n)t=r[n],Common.l.a().b("touchstart",t.l(),this.B),Common.l.a().b("touchend",t.l(),this.A);this.a.j().c(this.K);this.a.f().c(this.v);this.a.i().h(this.E);this.a.bQ(this.w);this.a.c().T(this.n);this.a.I(this.n);this.d.l(this.D);this.d.u(this.F);this.a.N(this.y);this.d.D(this.z);_Ewa.K.g(this.C);this.f&&Diag.a.a(590751752,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");i=this.a.c().a().a(_Ewa.iY,376,!1,null);i&&i.c(this.I);_Ewa.jY.prototype.dispose.call(this)},j:function(){if(!this.r.a||!this.r.a.g(this.i()))return!1;var n=!this.a.bF();return this.a.m()&&n&&(this.i().l()||this.i().p())?!1:this.f?!0:_Ewa.K.a===3},e:function(){this.k&&(this.c.set_visible(!1),this.b.set_visible(!1),this.k=!1)},g:function(){var i,c,l,s;if(this.j()){this.bn();i=_Ewa.b.h(this.h);i||Diag.a.b(576296321,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.a.c().b().b(),this.p,this.o,this.a.D(),this.a.h().b());var t=_Ewa.b.h(this.M),n=new Sys.UI.Bounds(t.x-i.x,t.y-i.y,t.width,t.height),r=this.i(),a=r.e(),v=r.m(),h=r.l()||r.p(),u,e,f,o;r.p()?(c=this.S(),u=n.x-2*_Ewa.kd.a(this.a),e=c,f=n.x+t.width,o=c):r.l()?(l=this.R(),u=l,e=n.y-2*_Ewa.kd.a(this.a),f=l,o=n.y+t.height):(e=n.y,o=n.y+t.height,this.a.d()?(u=n.x+t.width,f=n.x):(u=n.x,f=n.x+t.width));s=h?0:_Ewa.kd.a(this.a);this.c.cM().left=u-s+"px";this.c.cM().top=e-s+"px";this.b.cM().left=f-s+"px";this.b.cM().top=o-s+"px";this.c.set_visible(this.O(e,u,a,h,i));this.b.set_visible(this.O(o,f,v,h,i));this.k=!0}},O:function(n,t,i,r,u){var f=3,e=_Ewa.b.h(this.a.n(this.u).l()),o=new Sys.UI.Bounds(e.x-u.x-f,e.y-u.y-f,e.width+2*f,e.height+2*f);return(this.a.h().d(i)===this.u||r)&&Common.g.d(o,new Sys.UI.Point(t,n))},bn:function(){if(this.p!==this.o){this.h=null;var n=this.L();this.c.q(n);this.b.q(n)}},S:function(){return(this.a.j().a().d()+this.a.h().a.b-_Ewa.kd.a(this.a))/2},R:function(){return(this.a.j().a().c()+this.a.h().a.a-_Ewa.kd.a(this.a))/2},bk:function(){this.k&&this.s?this.g():this.e()},ba:function(n){return n.b===3&&(this.s=!0,this.g()),!1},bb:function(n){if(n.b===3){if(!n.c||this.T(n))return!1;this.s=!1;this.e()}return!1},T:function(n){return _Ewa.b.I(n.c,"ewa-scrollbars")&&(this.U(n)||this.V(n))},V:function(n){var t,i,r;return this.a.d()?t=n.get_clientPoint().x:(i=_Ewa.b.h(n.c),r=i.x+i.width-_Ewa.bg.a(),t=n.get_clientPoint().x-r),t>0&&t<=_Ewa.bg.a()},U:function(n){var t=_Ewa.b.h(n.c),r=t.y+t.height-_Ewa.bg.a(),i=n.get_clientPoint().y-r;return i>0&&i<=_Ewa.bg.a()},bf:function(){this.f&&this.N();this.g();this.t=!1},bh:function(){this.e();this.t=!0},bg:function(n,t){t.a===this.q()&&(t.c?this.t||this.g():this.e())},bi:function(){this.P(this.c.cx(),!1)},X:function(){this.P(this.b.cx(),!0)},bc:function(n,t){this.d.E(t)},P:function(n,t){this.f&&Diag.a.a(590751751,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.d.V(n,t,this.f);this.e()},bd:function(n,t){this.d.E(_Ewa.jO.b(t))},be:function(){_Ewa.K.a===3?this.g():this.e();this.f&&_Ewa.K.a===1&&this.N()},bj:function(){this.bm()},bm:function(){this.f||(Diag.a.a(590751750,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.f=!0,this.c.o(),this.b.o(),this.a.a().z(this.a.a().a().c()),this.g())},N:function(){this.f&&(Diag.a.a(590751749,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.f=!1,this.c.p(),this.b.p())},L:function(){if(!this.h){if(this.o=!1,this.p){var n=this.a.c().a().a(_Ewa.jc,22,!1,null);if(n)return this.o=!0,this.h=n.c()}this.h=this.a.D()}return this.h},Q:function(){this.e()},Y:function(){this.d.b().a()&&this.e()},W:function(){this.e()},Z:function(n,t){this.N();t.b===3?this.g():this.e()},bl:function(){this.k&&(this.e(),this.g())}};_Ewa.kd=function(n,t,i){var u;this.g=Function.createDelegate(this,this.s);this.e=Function.createDelegate(this,this.u);this.f=Function.createDelegate(this,this.v);this.h=Function.createDelegate(this,this.t);_Ewa.kd.initializeBase(this,[document.createElement("div"),null]);this.a=i;var f=_Ewa.a.c("Microsoft.Office.Excel.CanvasHitTest",!1),e=Common.c.a(),r=!f||e,o=r?"ewr-grippie-ie":"ewr-grippie";Sys.UI.DomElement.addCssClass(this.cx(),o);Sys.UI.DomElement.addCssClass(this.cx(),"ewr-grippie-circle-container");n.appendChild(this.cx());_Ewa.b.b(this.cx(),!1,!0);this.b=document.createElement("div");u=r?"ewr-grippie-circle":"ewr-grippie-circle";Sys.UI.DomElement.addCssClass(this.b,u);this.b.style.borderColor=t;this.cx().appendChild(this.b);Common.f.a().a("msospPointerDown",this.cx(),this.h);Common.f.a().a("msospPointerUp",this.cx(),this.f);Common.l.a().a("touchend",this.cx(),this.f);Common.f.a().a("msospPointerMove",this.cx(),this.e);Common.l.a().a("touchmove",this.cx(),this.e);Common.j.a().a("click",this.cx(),this.g)};_Ewa.kd.a=function(n){var r=_Ewa.a.c("Microsoft.Office.Excel.CanvasHitTest",!1),u=Common.c.a(),t,i;return r&&!u?(t=_Ewa.u.a(n.c())?_Ewa.u.a(n.c()).c():1,i=Math.max(t,1),Math.round(9/i)):9};_Ewa.kd.prototype={b:null,d:null,c:!1,a:null,j:function(n){this.cD("GrDrag",n)},m:function(n){this.cI("GrDrag",n)},i:function(n){this.cD("GrContxt",n)},l:function(n){this.cI("GrContxt",n)},k:function(n){this.cD("GrPointerUp",n)},n:function(n){this.cI("GrPointerUp",n)},dispose:function(){Common.m.e(this.cx());_Ewa.bdU.prototype.dispose.call(this)},q:function(n){this.cx().parentNode.removeChild(this.cx());n.appendChild(this.cx())},o:function(){Sys.UI.DomElement.removeCssClass(this.cx(),"ewr-grippie-circle-container");Sys.UI.DomElement.removeCssClass(this.b,"ewr-grippie-circle");Sys.UI.DomElement.addCssClass(this.b,"ewr-grippie-square")},p:function(){Sys.UI.DomElement.removeCssClass(this.b,"ewr-grippie-square");Sys.UI.DomElement.addCssClass(this.b,"ewr-grippie-circle");Sys.UI.DomElement.addCssClass(this.cx(),"ewr-grippie-circle-container")},t:function(n){if(n=_Ewa.u.a(this.a)?_Ewa.u.a(this.a).a(n):n,this.c=!1,_Ewa.K.b(n.b)===3){var t=n.a.rawEvent,i=t.srcElement||t.target;_Ewa.b.e(this.cx(),i)&&_Ewa.b.e(t.currentTarget,i)&&(this.c=!0,this.d=n.get_clientPoint())}return!1},v:function(n){return n=_Ewa.u.a(this.a)?_Ewa.u.a(this.a).a(n):n,this.cz("GrPointerUp",n),this.c=!1,!1},u:function(n){return n=_Ewa.u.a(this.a)?_Ewa.u.a(this.a).a(n):n,n.b===3&&this.c&&this.r(n.get_clientPoint())&&(this.cz("GrDrag",null),this.c=!1),!1},s:function(n){return n=_Ewa.u.a(this.a)?_Ewa.u.a(this.a).a(n):n,!0},r:function(n){return!!this.d&&(Math.abs(n.x-this.d.x)>3||Math.abs(n.y-this.d.y)>3)}};_Ewa.MU=function(n){_Ewa.MU.initializeBase(this,[!1]);n.a().b(_Ewa.iY,376,this)};_Ewa.MU.prototype={a:function(n){this.et("TAF",n)},c:function(n){this.ev("TAF",n)},b:function(){this.es("TAF",null,null)}};_Ewa.yx=function(n){_Ewa.yx.initializeBase(this);this.i=n;this.l()};_Ewa.yx.a=function(n){n.a().b(_Ewa.bkt.$$(_Ewa.iY),377,new _Ewa.yx(n))};_Ewa.yx.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.iY,376,!1,null)||new _Ewa.MU(this.i))}};_Ewa.yy=function(n){_Ewa.yy.initializeBase(this);this.i=n;this.l()};_Ewa.yy.a=function(n){n.a().b(_Ewa.bkt.$$(Sys.IDisposable),149,new _Ewa.yy(n))};_Ewa.yy.prototype={i:null,a:function(){var n=this;_Ewa.g.a(_Ewa.l.a(_Ewa.dA,this.i.a(),134,this.h(),this.j,null),function(t){n.k(n.i.a().a(Sys.IDisposable,64,!1,null)||new _Ewa.MW(n.i,t.a()))},this.h(),3,null,null)}};_Ewa.MX=function(){};_Ewa.MX.a=function(n,t,i,r,u,f,e,o){var s=n.a(41,o);return s.sourceRange=t,s.destinationRange=i,_Ewa.k.a(n,"RearrangeRowColumn",s,r,u,f,e,0,null,null)};_Ewa.Tq.registerClass("_Ewa.Tq");_Ewa.MQ.registerClass("_Ewa.MQ",_Ewa.bV);_Ewa.bih.registerClass("_Ewa.bih",_Ewa.biq);_Ewa.MR.registerClass("_Ewa.MR",_Ewa.bih);_Ewa.rI.registerClass("_Ewa.rI",_Ewa.biq);_Ewa.bid.registerClass("_Ewa.bid",_Ewa.rI);_Ewa.MS.registerClass("_Ewa.MS",_Ewa.bid);_Ewa.gH.registerClass("_Ewa.gH",_Ewa.bid);_Ewa.MT.registerClass("_Ewa.MT",_Ewa.rI);_Ewa.MW.registerClass("_Ewa.MW",_Ewa.bgJ);_Ewa.pf.registerClass("_Ewa.pf",_Ewa.biq);_Ewa.MY.registerClass("_Ewa.MY");_Ewa.MZ.registerClass("_Ewa.MZ",Sys.EventArgs);_Ewa.Na.registerClass("_Ewa.Na",_Ewa.biq);_Ewa.Nb.registerClass("_Ewa.Nb",_Ewa.bih);_Ewa.Nc.registerClass("_Ewa.Nc",_Ewa.biq);_Ewa.big.registerClass("_Ewa.big",_Ewa.biq);_Ewa.Nd.registerClass("_Ewa.Nd",_Ewa.big);_Ewa.Ne.registerClass("_Ewa.Ne",_Ewa.big);_Ewa.lG.registerClass("_Ewa.lG",_Ewa.biq);_Ewa.Nf.registerClass("_Ewa.Nf",_Ewa.biq);_Ewa.lH.registerClass("_Ewa.lH",_Ewa.biq);_Ewa.Ng.registerClass("_Ewa.Ng",_Ewa.bih);_Ewa.kd.registerClass("_Ewa.kd",_Ewa.bdU);_Ewa.MU.registerClass("_Ewa.MU",_Ewa.bV,_Ewa.iY,Sys.IDisposable);_Ewa.yx.registerClass("_Ewa.yx",_Ewa.sY.$$(_Ewa.iY));_Ewa.yy.registerClass("_Ewa.yy",_Ewa.sY.$$(Sys.IDisposable));_Ewa.gH.a=[6];_Ewa.pf.a=[1,2,32,256,128,64];Type.registerNamespace("_Ewa");_Ewa.bie=function(){};_Ewa.bie.a=function(){_Ewa.m.a(_Ewa.yy.a);_Ewa.m.a(_Ewa.yx.a)};_Ewa.bie.a();