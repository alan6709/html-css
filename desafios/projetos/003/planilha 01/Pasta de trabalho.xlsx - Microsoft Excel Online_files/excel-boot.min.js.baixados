var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=40)}({40:function(e,t,n){"use strict";var i,o,r;n.r(t),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=225]="msoulscat_MSOSP_OTelJS",e[e.O=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.R=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.P=301]="msoulscat_Wac_WordViewer",e[e.A=306]="msoulscat_Wac_BrowserGeneral",e[e.F=320]="msoulscat_Wac_TaskPane",e[e.U=339]="msoulscat_Wac_OneNoteGeneral",e[e.N=340]="msoulscat_Wac_Ribbon",e[e.H=379]="msoulscat_Wac_WopiPendingApplication",e[e.k=383]="msoulscat_Wac_Telemetry",e[e.J=391]="msoulscat_Wac_WacCatchUpActivities",e[e.B=394]="msoulscat_Wac_Dictation",e[e.j=395]="msoulscat_Wac_OneNoteSync",e[e.q=700]="msoulscat_Wac_VisioApp",e[e.K=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.Z=833]="msoulscat_Wac_PptLive",e[e.$=834]="msoulscat_Wac_PptMWeb",e[e.Y=815]="msoulscat_Wac_PptShape",e[e.ee=817]="msoulscat_Wac_PptSession",e[e.te=830]="msoulscat_Wac_PptSlideshow",e[e.ne=822]="msoulscat_Wac_PptView",e[e.ie=2300]="msoulscat_Wac_VersionHistory",e[e.oe=302]="msoulscat_Wac_WordPresence",e[e.re=3005]="msoulscat_Wac_WordVersionHistory",e[e.se=3006]="msoulscat_Wac_LivePersonaCard",e[e.ae=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ce=3016]="msoulscat_Wac_WordDesigner",e[e.ue=3021]="msoulscat_Wac_ModernFontPicker",e[e.fe=3027]="msoulscat_Wac_UnifiedUiHost",e[e.le=3033]="msoulscat_Wac_EquationTools"}(i||(i={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.Unknown=6]="Unknown"}(r||(r={}));var s=window.navigator,a=s?s.userAgent:void 0;function c(){if(a){if(a.indexOf("Firefox")>-1)return r.Firefox;if(a.indexOf("Opera")>-1||a.indexOf("OPR")>-1)return r.Opera;if(a.indexOf("Trident")>-1)return r.IE;if(a.indexOf("Edg")>-1)return r.Edge;if(a.indexOf("Chrome")>-1)return r.Chrome;if(a.indexOf("Safari")>-1)return r.Safari}return r.Unknown}function u(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function f(){try{return!!a&&a.indexOf("iPad")>=0||!!a&&a.indexOf("Macintosh")>=0&&v()&&!p()||!!a&&a.indexOf("Android")>=0||v()}catch(e){return!1}}function l(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function d(){return c()===r.IE&&!function(){if(c()!==r.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function h(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function p(){return!!a&&a.indexOf("iPhone")>=0}function v(){return!!s&&(s.maxTouchPoints>0||s.msMaxTouchPoints>0)}var m=["eurppc"];function w(e){return 8===e.toLowerCase().indexOf("ffc")}function g(e){return 8===e.toLowerCase().indexOf("ppc")}function S(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function I(e,t){if(!t||-1===m.indexOf(t.toLowerCase()))return e;var n=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return n?""+n[1]+t+"-"+n[3]:e}function b(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function y(e,t){var n=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!n)throw new Error("Invalid URL");var i=n[2];if(void 0===t)return i;if(t<0)throw new Error("subDomainParts should be at least 1");return i.split(".").slice(-(t+1)).join(".")}function _(e,t,n){n&&(e[t.toLowerCase()]=n)}function T(e,t){e[t.toLowerCase()]=""}function O(e,t){var n=e.toLowerCase(),i=t.toLowerCase(),o=n.indexOf("&"+i+"=");if(-1===o&&(o=n.indexOf("?"+i+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function E(e,t,n,i){if(!n)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,r);if("?"!==s&&c>=0){if(i){var u=o.indexOf("&",c);o=o.substring(0,c)+a+n+(-1===u?"":o.substring(u))}return o}return o.concat(s,a,n)}function C(e){var t={},n=e.indexOf("?");return-1===n||n===e.length-1||e.substring(n+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var n=e.indexOf("=");-1!==n&&n!==e.length-1&&(t[e.substring(0,n).toLowerCase()]=e.substring(n+1))}})),t}function R(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+"://".length)return"";n+=1;var i=e.indexOf("?");if(-1!==(i=i>=t?-1:i)&&n>i)return"";var o=-1===i?t:i;return n>=o?"":e.substring(n,o)}function P(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function A(e,t,n){var i=new RegExp("[?&]"+t+"=("+(n||"1")+")\\b","i"),o=e.match(i);return!!o&&(!n||o[1]===n)}function x(e,t){var n=O(e,t);return n?decodeURI(n):n}function F(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function U(e,t){return{shouldPreload:function(t){return e(t)},preload:function(e,n,r,s){t(e,n,s).forEach((function(e){!function(e,t,n,r,s){var a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=M,a.href=e,t){var c=n||R(e);t.ULS.he(561059910,i.H,o.Info,"Preloading resource: "+c);a.addEventListener("error",(function(){t.ULS.he(561059911,i.H,o.Error,"Resource failed to load: "+c)}))}a.setAttribute("as","script"),r&&a.setAttribute("integrity",r);document.head.appendChild(a),s&&a.addEventListener("load",s,{once:!0})}(e[0],r,void 0,e[1])}))}}}var W,M=(W=c())===r.Firefox||W===r.IE?"prefetch":"preload";var N,H={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};function k(e,t,n){if(t){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch(e){}!function(e,t,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}(e,t,n)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(N||(N={}));var D= "16.0.14822.35902";function J(){return D}var B;function L(e,t,n){!function(e,t,n,i){void 0===i&&(i=!0);var o={type:t,payloadJson:JSON.stringify(n)};k(JSON.stringify(o),e,i)}(e,"JSAPI_STATE",{application:t,build:J(),state:n})}function j(e,t,n,i){var o=[],r=e.map((function(e){return function(e,t,n){var i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){var o=n.findIndex((function(t){return t===e.correlationId}));o<0&&(o=n.push(e.correlationId)-1),i.I=o}var r=1e3*e.type+e.level;return i.D=r,i}(e,i,o)})),s=function(e,t,n,i,o){var r={};r.T=e,r.L=t,r.S=n,r.I=i,o&&o.length>0&&(r.W=o);return r.V=1,r}(i,r,t,n,o);return JSON.stringify(s)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(B||(B={}));var V,q=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function z(){return q?window.performance.now():Date.now()}function G(){if(!V){var e=window.performance;V=q&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return V()}var K,X,Z=function(){function e(e){var t=this;this.pe=3e4,this.ve=30,this.me=0,this.we=[],this.ge=G(),this.Se="",this.Ie=0,this.flushOnClose=function(){t.be(!1,!1)},this.flush=function(){t.ye()},this.ye=function(){window.setTimeout((function(){return t.be(!0,!0)}),0)},this.be=function(e,n){var i=z();if(window.clearTimeout(t._e),t.Te){if(t.we.length>0)t.me+=1,k(j(t.we.splice(0,e?t.ve:t.we.length),t.Se,t.me,t.ge),t.Te,n),t.ge=G();e&&(t._e=window.setTimeout(t.ye,t.we.length>t.ve?1e3:t.pe)),t.Ie+=z()-i}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Ie},e.prototype.addLoggingTime=function(e){this.Ie+=e},e.prototype.configure=function(e){var t=this,n=z();if(e.uploadCadenceInMs&&(this.pe=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.ve=e.uploadTriggerSize),e.sessionId&&(this.Se=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Te)throw new Error("Remote ULS endpoint is already set");this.Te=e.remoteUlsEndpoint+"?usid="+this.Se+"&officeserverversion="+J(),this.ge=G(),window.setTimeout((function(){return t.be(!0,!0)}),0)}this.Ie+=z()-n},e.prototype.handleTrace=function(e){var t=z();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.we.push(e),(this.we.length>this.ve||e.level===o.Error)&&this.ye(),this.Ie+=z()-t},e}(),$=[];!function(e){e.Oe="BootstrapperMaxUlsHeartbeatTime",e.Ee="BootstrapperNoCompleteWarning1Time",e.Ce="BootstrapperNoCompleteWarning2Time",e.Re="RemoteUlsETag",e.Pe="RemoteUlsSuppressions",e.Ae="BootstrapperSettingsFetchPeriod",e.xe="timestamp",e.Fe="BootstrapperUlsHeartbeatIntervalMs",e.Ue="BootstrapperUlsHeartBeatIsEnabled",e.We="BootstrapperUlsUploadCadenceMs",e.Me="WordConsumptionViewToEditRedirectIsEnabled",e.Ne="RequestedCallThrottlingDefaultToViewMinimumValue"}(X||(X={}));var Q;function Y(e){var t=new Z(e);function n(e,n,i,o){var r=z();if(!function(e){return 1===$[e]}(e)){var s={timestamp:G(),category:n,tag:e,level:i,type:B.Trace,message:o,correlationId:""};t.addLoggingTime(z()-r),t.handleTrace(s)}}return{ULS:{he:function(e,t,i,o){n(e,t,i,o)},shipAssertTag:function(e,t,i,r){i&&n(e,t,o.Error,r)},debugAssertTag:function(e,t,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var n,i;n=e.He.getValue(X.Pe,""),i=e.He.getValue(X.Re,""),K&&i===K||($=[],K=i,n&&n.split(",").forEach((function(e){var t=parseInt(e,10);t&&($[t]=1)}))),t.configure({uploadCadenceInMs:e.He.getValue(X.We,6e4)})},getTimeSpentLogging:function(){return t.getTimeSpentLogging()}}}function ee(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function te(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}function ne(e,t){return{isFeatureEnabled:function(n){return function(e,t,n){if(!t)return;try{return t(e)}catch(e){n&&n.ULS.he(594883024,i.H,o.Error,"IsFeatureEnabled callback error: "+te(e))}return}(n,e,t)}}}function ie(e,t){var n={};if(Object.keys(Q).forEach((function(t){var i=e.isFeatureEnabled(Q[t]);void 0!==i&&(n[Q[t]]=i?"1":"0")})),t&&t.wdFlights)for(var i=0,o=t.wdFlights.toLowerCase().split(",");i<o.length;i++){var r=o[i];"et-treatment"!==r&&"et-control"!==r||(n[Q.ke]="et-treatment"===r?"1":"0")}return JSON.stringify(n)}!function(e){e.ke="EnterpriseTemplates",e.De="ExcelAdaptiveLayoutDownload",e.Je="ExcelLandingPageOfflineTelemetry",e.Be="ExcelLandingPageObserverRetry",e.Le="H2StaticContent",e.je="HashedUrl",e.Ve="ODCShareLinkPreload",e.qe="OfficeComExcelJsApiV2",e.ze="OfficeComPptJsApiV2",e.Ge="OfficeComUiHost",e.Ke="OfficeComWordJsApiV2",e.Xe="OfficeHwaUiHost",e.Ze="OfficeUnifiedUiHostTeams",e.$e="WordViewToUnifiedRead"}(Q||(Q={}));var oe,re,se,ae,ce,ue,fe=function(){function e(){this.Qe=[]}return e.prototype.add=function(e){e&&this.Qe.push(e)},e.prototype.remove=function(e){if(e){var t=this.Qe.indexOf(e);t>-1&&this.Qe.splice(t,1)}},e.prototype.removeAll=function(){this.Qe=[]},e.prototype.dispatch=function(e,t){this.Qe.forEach((function(n){try{n(e)}catch(e){t&&t(e)}}))},e}(),le=function(){function e(e,t){var n=this;this.Ye=0,this.et=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(n.tt);if(!e)return;var t=JSON.parse(e);n.nt(t)}catch(e){n.ot.ULS.he(592836768,i.H,o.Warning,"Failed to get settings from localStorage: "+te(e))}},this.nt=function(e){return!!n.rt(e)&&(n.st=e,n.at.dispatch({He:n},(function(e){n.ot.ULS.he(592836769,i.H,o.Error,"Settings listener error: "+te(e))})),!0)},this.rt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(X.xe)&&!isNaN(e.timestamp))return!0;n.ot.ULS.he(592836770,i.H,o.Error,"Received invalid settings")}return!1},this.ct=function(){if(n.ut){var e=new XMLHttpRequest;e.open("GET",n.ut),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(n.ft(e.response),n.Ye=0):(n.ot.ULS.he(592836771,i.H,o.Error,"Fetch settings error. Status: "+e.status+", curErrors: "+n.Ye),n.Ye+=1),!(n.Ye>7)){var t=n.getValue(X.Ae,3e5);n.Ye>3&&(t+=(n.Ye-3+1)*(t/2)),n.lt=window.setTimeout(n.ct,t)}}}},this.ft=function(e){"requestIdleCallback"in window?(n.dt&&self.cancelIdleCallback(n.dt),n.dt=window.requestIdleCallback((function(){return n.ht(e)}),{timeout:1e4})):window.setTimeout((function(){return n.ht(e)}),0)},this.ht=function(e){if(n.nt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(n.tt,t)}catch(e){n.ot.ULS.he(592836800,i.H,o.Warning,"Failed to set localStorage: "+te(e))}}},this.pt=e,this.tt="Prod"+e+"Settings",this.ot=t,this.at=new fe,this.et()}return e.prototype.initializePeriodicFetch=function(e,t){this.tt=(w(e)?"FF":"Prod")+this.pt+"Settings",this.et(),this.ut=e+"AppSettingsHandler.ashx?app="+this.pt+"&usid="+t+"&build="+J(),this.lt||(this.lt=window.setTimeout(this.ct,3e4))},e.prototype.getValue=function(e,t){if(this.st||this.et(),!this.st||!this.st.hasOwnProperty(e))return t;var n=this.st[e],i=typeof t;if(typeof n===i)return n;if("string"==typeof n){if("number"===i)return parseInt(n,10);if("boolean"===i)return"true"===n}return t},e.prototype.addSettingsChangeListener=function(e){this.at.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.at.remove(e)},e.prototype.dispose=function(){this.lt&&window.clearTimeout(this.lt),this.dt&&self.cancelIdleCallback(this.dt),this.lt=void 0,this.dt=void 0,this.st=void 0,this.at.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete"}(oe||(oe={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(re||(re={})),function(e){e.vt="App_AccessibilityLoopComplete",e.wt="Wac_ActionComplete",e.gt="WacInitialize_Ready",e.St="Wac_AppFailed",e.It="Wac_AppBootState",e.bt="Wac_AppCompleted",e.yt="BrowserEvent",e._t="UI_Close",e.Tt="App_CloseTab",e.Ot="UI_Conversation",e.Et="UI_CopyAndEdit",e.Ct="App_CreateNewDocument",e.Rt="Wac_AppDataSavedStatus",e.Pt="UI_Download",e.At="UI_Edit",e.xt="Error",e.Ft="UI_FileEmbed",e.Ut="UI_FileProperties",e.Wt="File_Rename",e.Mt="File_RenameFailed",e.Nt="UI_FileVersions",e.Ht="StateChanged",e.kt="App_IsFrameTrusted",e.Dt="GetAccessToken",e.Jt="App_GetAuthToken",e.Bt="App_GetCustomAuthConfig",e.Lt="App_GetHostKeyValue",e.jt="App_WopiInfoFromUrl",e.Vt="App_DavUrlFromIds",e.qt="App_LoadingStatus",e.zt="App_SwitchMode",e.Gt="App_MoveToFolder",e.Kt="UI_OpenInBrowser",e.Xt="UI_OpenInClient",e.Zt="PageChanged",e.$t="App_PushCommentContext",e.Qt="App_PushState",e.Yt="App_DocReboot",e.tn="UI_RedeemForCommenting",e.nn="App_RefreshSessionInfo",e.in="UI_ReplyWithChanges",e.on="UI_ReportAbuse",e.rn="App_FilePicker",e.sn="UI_SaveStatus",e.an="WopiSession_Complete_Ack",e.cn="SetOverlayContent",e.un="UI_Sharing",e.fn="UI_ShareForm",e.ln="UI_SignIn",e.dn="App_StoreHostKeyValue",e.hn="App_Unloaded",e.pn="Wac_UnloadingApp",e.vn="App_UpdateBootComplete",e.mn="PageCount",e.wn="UI_CheckUserAccessAndGrantPermissions",e.gn="User_Activity",e.Sn="Edit_Notification",e.In="UI_Workflow",e.bn="ZoomChanged",e.yn="Excel_HostFrameCacheSave",e._n="Excel_HostFrameCacheEvict",e.Tn="Excel_RegenerateFileBundle",e.On="App_SwitchToWacFrame",e.En="App_SaveSSRData",e.Cn="App_PurgeDataInHostCache",e.Rn="App_SaveHostRenderingV2Data",e.Pn="App_SaveHostUtilsData"}(se||(se={})),function(e){e.An="Ack",e.xn="WacInitialize_Ready_Ack",e.Fn="Wac_BeforeUnloadApp",e.Un="Blur_Focus",e.Wn="Wac_AppFailed_Ack",e.Mn="Wac_AppCompleted_Ack",e.Nn="WopiStartSession_Complete",e.Hn="WopiPendingSession_Complete",e.kn="Host_AccessibilityLoopComplete",e.kt="Host_IsFrameTrusted",e.Dn="Grab_Focus",e.Jn="HostCacheDiagnostic",e.Bn="Host_KeyValue",e.Ln="JsApiDiagnostics",e.Gt="Host_MoveToFolder",e.jn="PageChanged_Ack",e.Vn="App_PopState",e.qn="File_Rename",e.rn="Host_FilePicker",e.zn="PostAccessToken",e.Gn="Host_SetAuthToken",e.Kn="Host_SetCustomAuthConfig",e.Xn="App_PushCommentContext",e.Zn="CanEmbed",e.$n="Host_RefreshSessionInfo",e.Qn="CheckUserAccessAndGrantPermissions_Result",e.Yn="Host_WopiInfoFromUrl",e.ei="Host_DavUrlFromIds",e.ti="SetCurrentPage",e.ni="SetZoomLevel",e.ii="WopiPendingSession_Fail",e.oi="SetOverlayContent",e.ri="WopiPendingApplicationComplete_Received",e.si="Host_SwitchMode",e.ai="Host_Unload",e.ci="PageCount_Ack",e.li="ZoomChanged_Ack",e.di="Host_ShareUI",e.hi="Host_Telemetry"}(ae||(ae={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged"}(ce||(ce={}));var de=((ue={})[re.boot]={pi:oe.boot},ue[re.createNew]={pi:oe.createNew},ue[re.dispose]={pi:oe.dispose},ue[re.rename]={pi:oe.rename},ue[re.switchMode]={pi:oe.switchMode},ue[se.It]={pi:oe.handleBootState},ue[se.Tt]={pi:oe.closeTab},ue[se.kt]={pi:oe.frameTrust},ue[se.Jt]={pi:oe.getAuthToken},ue[se.Lt]={pi:oe.getHostKeyValue},ue[se.Yt]={pi:oe.appReboot},ue[se.cn]={pi:oe.setOverlayContent},ue[se.dn]={pi:oe.storeHostKeyValue},ue[se.vn]={pi:oe.updateBootComplete},ue[re.blurFocus]={vi:ae.Un},ue[re.continueAccessibilityLoop]={vi:ae.kn},ue[re.grabFocus]={vi:ae.Dn},ue[re.moveToFolder]={vi:ae.Gt},ue[re.popState]={vi:ae.Vn},ue[re.completeSharedFilePicker]={vi:ae.rn},ue[se.vt]={mi:ce.AccessibilityLoopCompleted},ue[se.wt]={mi:ce.ActionCompleted},ue[se.yt]={mi:ce.BrowserEvent},ue[se._t]={mi:ce.Close},ue[se.Ot]={mi:ce.Conversation},ue[se.Et]={mi:ce.CopyAndEdit},ue[se.Ct]={mi:ce.CreateNewDocument},ue[se.Pt]={mi:ce.Download},ue[se.At]={mi:ce.Edit},ue[se.xt]={mi:ce.Error},ue[se.Ut]={mi:ce.FileProperties},ue[se.Wt]={mi:ce.FileRenamed},ue[se.Nt]={mi:ce.FileVersions},ue[se.Ht]={mi:ce.FrameStateChanged},ue[se.zt]={mi:ce.ModeSwitched},ue[se.Gt]={mi:ce.MoveToFolder},ue[se.Kt]={mi:ce.OpenInBrowser},ue[se.Xt]={mi:ce.OpenInClient},ue[se.Zt]={mi:ce.PageChanged},ue[se.Qt]={mi:ce.PushState},ue[se.tn]={mi:ce.RedeemForCommenting},ue[se.in]={mi:ce.ReplyWithChanges},ue[se.rn]={mi:ce.SharedFilePicker},ue[se.on]={mi:ce.ReportAbuse},ue[se.sn]={mi:ce.SaveStatus},ue[se.fn]={mi:ce.ShareForm},ue[se.ln]={mi:ce.SignIn},ue[se.gn]={mi:ce.UserActivity},ue[se.Sn]={mi:ce.UserEditActivity},ue[se.In]={mi:ce.Workflow},ue[se.bn]={mi:ce.ZoomChanged},ue[se.Ft]={wi:{mi:ce.FileEmbed,gi:re.sendEmbeddedViewUrl,Si:ae.Zn,Ii:5e3}},ue[se.Dt]={wi:{mi:ce.GetAccessToken,gi:re.sendAccessToken,Si:ae.zn}},ue[se.Bt]={wi:{mi:ce.GetCustomAuthConfig,gi:re.sendCustomAuthConfig,Si:ae.Kn,Ii:5e3}},ue[se.jt]={wi:{mi:ce.GetWopiInfoFromUrl,gi:re.sendWopiInfo,Si:ae.Yn,Ii:5e3}},ue[se.Vt]={wi:{mi:ce.GetDavUrlFromIds,gi:re.sendDavUrl,Si:ae.ei,Ii:5e3}},ue[se.nn]={wi:{mi:ce.RefreshSessionInfo,gi:re.sendSessionInfo,Si:ae.$n,Ii:5e3}},ue[se.wn]={wi:{mi:ce.UserAccessAndPermissions,gi:re.sendUserAccessAndPermissions,Si:ae.Qn,Ii:5e3}},ue[se.un]={wi:{mi:ce.Share,gi:re.signalShared,Si:ae.di,Ii:5e3}},ue),he=function(){function e(e){var t=this;this.bi=!1,this.yi=[],this.cancel=function(){t.bi||(t.bi=!0,t.yi.map((function(e){return e()})),t.yi=[])},this._i=e,window.setTimeout(this.cancel,e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.bi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Ii",{get:function(){return this._i},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){this.bi?e():this.yi.push(e)},e}();function pe(e){return new he(e)}function ve(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+te(e))}}t.perfNow=q;for(var i=0;i<e.length;i+=1){try{if(q){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+te(e))}e[i]=Math.floor(16*Math.random())}return t}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=15&e[n];return n+=1,("x"===t?i:3&i|8).toString(16)})),t]}var me=function(){return(me=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function we(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function ge(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}Object.create;Object.create;function Se(e,t){try{if(void 0===window.performance)return void t.ULS.he(595948609,i.H,o.Info,"Performance not supported");var n=window.performance.getEntriesByType("resource");if(void 0===n||n.length<=0)return void t.ULS.he(595948610,i.H,o.Info,"No resources under performance");for(var r=new RegExp(e+"(-boot.min|(.(app|preview))?.boot).js","i"),s=n.length-1;s>=0;s-=1){var a=n[s],c=a.name.match(r);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void t.ULS.he(595948616,i.H,o.Info,u)}}t.ULS.he(595948484,i.H,o.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.he(595948617,i.H,o.Info,"Could not trace the resource timing: "+te(e))}}function Ie(e){var t=me(me({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0}),n={};if(e.wdParams){var i=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){i[e]&&(n[e]=i[e])}))}var o=me({},e.rebootOverride);delete o.ackExpected,delete o["ui-language"],delete o.wdUserSession,delete o.rebootMode,delete o.documentUrl;var r=e.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",bootParams:e.bootParams,build:J(),host:t,intent:e.intent,jsApiVersion:"v2",rebootOverride:o,region:S(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,wdParams:n}}function be(e,t){return void 0===t&&(t=100),"transferSize"in e?0===e.transferSize?1:0:void 0!==e.responseEnd&&void 0!==e.fetchStart&&e.responseEnd-e.fetchStart<t?1:0}function ye(){var e={perfNowSupported:q,browser:r[c()],touchMode:f(),highContrast:l(),windows10x:h()};try{var t=window.navigator,n=t.connection||t.mozConnection||t.webkitConnection;n&&(e.netDownlink=n.downlink,e.netDownlinkMax=n.downlinkMax,e.netEffectiveType=n.effectiveType,e.netRtt=n.rtt,e.netSaveData=n.saveData,e.netType=n.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}var _e;!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(_e||(_e={}));var Te=function(){function e(e,t){this.Ti=function(){return Oe(e,"OnBeforeUnload",t)},this.Oi=function(){return Oe(e,"OnPageHide",t)},this.Ei=function(){return Oe(e,"VisibilityChange_"+document.visibilityState,t)},this.Ci=function(){return Oe(e,"OnUnload",t)},window.addEventListener("beforeunload",this.Ti,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Oi,{capture:!0}),window.addEventListener("visibilitychange",this.Ei,{capture:!0}),window.addEventListener("unload",this.Ci,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.Ti,{capture:!0}),window.removeEventListener("pagehide",this.Oi,{capture:!0}),window.removeEventListener("visibilitychange",this.Ei,{capture:!0}),window.removeEventListener("unload",this.Ci,{capture:!0})},e}();function Oe(e,t,n){e.ULS.he(595957843,i.H,o.Info,"Page lifecycle: "+t+" fired"+(n?", flushing logger":"")),n&&e.ULS.flush()}var Ee=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a"],Ce=function(){function e(e){var t=this;this.Ri={},this.Pi=[],this.Ai=function(e){if(e&&e.origin)try{var n=e.data;if("string"==typeof n&&n.includes("AddinTrustedOrigin")){var r=JSON.parse(n),s=r.AddinTrustId;s&&"AddinTrustedOrigin"===r.MessageId&&(t.ot.ULS.he(560754784,i.H,o.Info,"didReceiveMessage addinTrustId "+s),t.Ri[s]=e.origin,t.Pi.forEach((function(t){t(s,e.origin)})))}}catch(e){t.ot.ULS.he(560754785,i.H,o.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.ot=e,window.addEventListener("message",this.Ai)}return e.prototype.isResourceTrustedForMessage=function(e){return we(this,void 0,void 0,(function(){var t,n,r,s,a,c,u,f,l=this;return ge(this,(function(d){switch(d.label){case 0:return e&&e.Resource?(t=e.Resource,n=e.AddinTrustId,(r=function(e){if(!e)return!1;for(var t=e.toLowerCase(),n=0,i=Ee;n<i.length;n++){var o=i[n];if(o===t||o+"/"===t)return!0}return!1}(t))||!n?[2,r]:this.Ri[n]?[2,Re(t,this.Ri[n])]:(a=new Promise((function(e){s=function(i,o){n===i&&e(Re(t,o))},l.Pi.push(s)})),c=-1,2e3,u=new Promise((function(e){c=window.setTimeout((function(){l.ot.ULS.he(560754786,i.H,o.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: "+n),e(!1)}),2e3)})),[4,Promise.race([a,u])])):[2,!1];case 1:return f=d.sent(),this.Pi=this.Pi.filter((function(e){return e!==s})),window.clearTimeout(c),[2,f]}}))}))},e.prototype.dispose=function(){this.Ri={},this.Pi=[],window.removeEventListener("message",this.Ai)},e}();function Re(e,t){try{if(!e||!t)return!1;for(var n=/[?&#%\\]/,i=0;i<e.length;i+=1){var o=e.charCodeAt(i);if(o<33||o>126)return!1;var r=e.charAt(i);if(n.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="https:"+s.substring("api:".length));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var Pe=function(){function e(e,t,n,r,s,a,c){var u,f=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.useAdditionalDiv=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.xi={},this.onMessage=function(e){var t=e.MessageId,n=e.Values||{},r=f.xi[t];if(r&&r.length>0)f.Fi(t,n);else{var s=de[t];if(s){var a=s.pi,c=s.mi,u=s.wi;a?(f.logger.ULS.he(574654543,i.H,o.Info,"Running flow: "+a),f.Ui[a](t,n,f,f.Wi[a]).catch((function(e){f.Mi(a,e)}))):c?f.raiseEvent(c,n):u&&f.Ni(u,n)}}},this.Mi=function(e,t){f.logger.ULS.he(596459925,i.H,o.Error,e+" flow error: "+te(t)),f.remoteTelemetryUrl&&L(f.remoteTelemetryUrl,f.appInfo.name,"flowException")},this.Fi=function(e,t){f.logger.ULS.he(574654544,i.H,o.Info,"Dispatching action: "+e);for(var n=f.xi[e].slice().reverse(),r=n.length-1;r>-1;r-=1)try{n[r](e,t)}catch(t){f.logger.ULS.he(596444186,i.H,o.Error,e+" action handler error: "+te(t))}return Promise.resolve({completion:"success"})},this.Ni=function(e,t){var n=function(t,n){f.container&&f.container.postMessage(e.Si,n),i()},i=function(){f.removeActionHandler(e.gi,n)};(f.addActionHandler(e.gi,n),void 0!==e.Ii)&&new he(e.Ii).subscribe(i);f.raiseEvent(e.mi,t)},this.state=N.Unknown;var l=ve(),d=l[0],h=l[1];this.logger=Y(),this.logger.ULS.he(593506837,i.H,o.Info,JSON.stringify(h)),this.sessionId=d,this.hostSessionId=n.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=r,this.appInfo=t,this.session=s,this.featureManager=ne(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.He=new le(t.name,this.logger),this.preloader=t.preloader,u=a(this.featureManager),this.Ui=u[0],this.Wi=u[1],this.Hi=c,this.He.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=ye(),this.pageStateObserver=new Te(this.logger,!0),this.authTokenTrustValidator=new Ce(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.he(574654541,i.H,o.Info,"Raising event: "+e);try{this.Hi(e,t)}catch(e){this.logger.ULS.he(593506838,i.H,o.Error,"Event handler error: "+te(e))}},e.prototype.addActionHandler=function(e,t){this.xi[e]||(this.xi[e]=[]),this.xi[e].push(t)},e.prototype.removeActionHandler=function(e,t){var n=this.xi[e];if(n&&n.length>0){var i=n.indexOf(t);i>-1&&n.splice(i,1)}},e.prototype.run=function(e,t,n){var r=this,s=[],a=this.xi[e];if(a&&a.length>0)s.push(this.Fi(e,t));else{var c=de[e];if(c){var u=c.pi,f=c.vi;if(u){this.logger.ULS.he(574654542,i.H,o.Info,"Running flow: "+u);var l=this.Ui[u](e,t,this,this.Wi[u],n).catch((function(e){return r.Mi(u,e),{completion:"failure",error:e}}));s.push(l)}else f&&(this.container&&this.container.postMessage(f,t),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.he(593500189,i.H,o.Warning,"Unhandled command: "+e)}return Promise.race(s)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.He.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.xi={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var Ae,xe=function(){function e(e,t,n,i,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(n);this.ki=new Pe(e,t,n,i,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.ki.state=N.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.ki.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.ki.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,n){return this.ki.run(e,t,n)},e.prototype.boot=function(e,t){return this.ki.run(re.boot,e,t)},e.prototype.dispose=function(e){return this.ki.run(re.dispose,void 0,e)},e}(),Fe=function(){function e(e,t,n){var r=this;this.Di="",this.Ji="",this.Bi=!1,this.Li=!1,this.ji=!1,this.Vi=function(e){var t=!1,n=!0,s="",a=!1;if(r.qi&&r.qi.contentWindow&&(t=!0,n=e.source===r.qi.contentWindow),e.origin&&(a=(s=y(e.origin,2).toLowerCase())===r.Ji),!r.Bi&&(!r.Li||a&&n)||r.ot.ULS.he(593232850,i.H,o.Info,"Window: available["+t+"] valid["+n+"]; Origin: valid["+a+"] expected["+r.Ji+"] actual["+s+"]"),a&&(!r.ji||n)){var c;try{c=JSON.parse(e.data)}catch(e){return void r.ot.ULS.he(593232851,i.H,o.Info,"Failed to parse event data: "+te(e))}var u=c.MessageId;if(u)if(r.ot.ULS.he(593232854,i.H,o.Info,"Received message: "+u+", correlation: "+c.CorrelationId),u!==se.bt&&u!==se.qt||r.setTargetOrigin(e.origin),c.Values&&c.Values.ackExpected&&r.postMessage(ae.An,void 0,c.CorrelationId),r.zi)try{r.zi(c)}catch(e){r.ot.ULS.he(594556386,i.H,o.Error,"Message handler error: "+te(e))}else r.ot.ULS.he(591933923,i.H,o.Error,"No message handler");else(r.Bi||r.Li)&&r.ot.ULS.he(593232853,i.H,o.Info,"Missing message id")}},this.ot=t,this.setTargetOrigin(e),n&&this.setMessageHandler(n),window.addEventListener("message",this.Vi,!1)}return e.prototype.setTargetOrigin=function(e){var t=b(e).toLowerCase();this.Di&&this.Di!==t&&this.ot.ULS.he(593232847,i.H,o.Warning,"Updating origin: ["+F(this.Di)+"]->["+F(t)+"]"),this.Di=t,this.Ji=y(t,2),this.Bi=w(t),this.Li=g(t)},e.prototype.setTargetFrame=function(e,t){this.qi=e,this.ji=!!t},e.prototype.setMessageHandler=function(e){this.zi=e},e.prototype.removeMessageHandler=function(){this.zi=void 0},e.prototype.postMessage=function(e,t,n){if(this.qi&&this.qi.contentWindow){this.ot.ULS.he(593232849,i.H,o.Info,"Sending message: "+e);var r={MessageId:e,SendTime:G(),CorrelationId:n,Values:t};this.qi.contentWindow.postMessage(JSON.stringify(r),this.Di)}else this.ot.ULS.he(593232848,i.H,o.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.Vi,!1),this.zi=void 0},e}();!function(e){e.Gi="access_token",e.Ki="access_token_ttl",e.Xi="bundleSrc",e.Zi="bundleStaleness",e.$i="DocID",e.Qi="SiteID",e.Yi="WebID",e.eo="ETag",e.to="feature_status",e.no="fileExtension",e.io="fileGetUrl",e.oo="customFontCatalogUrl",e.so="fileName",e.ao="fileSize",e.co="forceSLR",e.uo="frameHeightPx",e.fo="frameWidthtPx",e.lo="highContrast",e.do="highDpi",e.ho="host_diagnostics",e.po="hostName",e.vo="huictrls",e.mo="owner_id",e.wo="sc",e.So="softBlockedBrowser",e.Io="templateUrl",e.bo="touchMode",e.yo="user_id",e._o="hfck",e.To="hfcv",e.Oo="timeZoneId",e.Eo="darkCssMedia",e.Co="caae"}(Ae||(Ae={}));function Ue(e,t){_(t,Ae.uo,String(e.offsetHeight)),_(t,Ae.fo,String(e.offsetWidth)),_(t,Ae.bo,String(f())),_(t,Ae.lo,String(l())),_(t,Ae.co,String(h())),_(t,Ae.Eo,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function We(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.he(591525084,i.H,o.Info,"Trust check error: "+te(t)),!1}}var Me,Ne=function(){function e(e,t){!function(e){if(void 0===e||void 0===e.appendChild)throw TypeError("Container")}(e),this.Ro=e,this.Po=t,this.Ao=t+"_Form",this.xo=We()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Ro},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Po},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.Ao},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.xo},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,n,r,s){this.ot=n,this.Fo=new Fe(e,n,this.zi);var a=s.useAdditionalDiv;this.Uo&&!a?(this.Uo.setAttribute("allow",r),this.ot.ULS.he(588793045,i.H,o.Info,"Wac frame reused")):(this.Uo=function(e,t,n,i,o,r){void 0===o&&(o="unset"),void 0===r&&(r="unset"),e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%",e.style.minHeight=o,e.style.minWidth=r;var s=e.ownerDocument,a=s.createElement("iframe");a.id=t,a.name=t,a.src="",a.title="Office on the web Frame",a.marginWidth="0",a.marginHeight="0",a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight=o,a.style.minWidth=r,a.style.display="block",a.style.position="absolute",a.style.backgroundColor="transparent",a.style.border="none",a.frameBorder="0",a.setAttribute("allowfullscreen","true"),a.setAttribute("allowTransparency","true"),a.setAttribute("allow",n);var c=i?s.createElement("div"):void 0;return c?(c.style.top="0",c.style.bottom="0",c.style.left="0",c.style.right="0",c.style.height="100%",c.style.width="100%",c.style.minHeight=o,c.style.minWidth=r,c.style.backgroundColor="#393a3d",c.style.backfaceVisibility="hidden",c.appendChild(a),e.appendChild(c)):e.appendChild(a),a}(this.Ro,this.Po,r,a,s.minHeight,s.minWidth),this.ot.ULS.he(588793046,i.H,o.Info,"Wac frame created")),this.Fo.setTargetFrame(this.Uo),a&&(this.Wo=this.Uo.parentElement),Ue(this.Uo,t),this.Mo=function(e,t,n,i,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=n,s.name=n,s.action=i,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Ro,this.Po,this.Ao,e,t),this.Mo.submit()},e.prototype.setMessageHandler=function(e){this.zi=e,this.Fo&&this.Fo.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.No=e},e.prototype.removeMessageHandler=function(){this.zi=void 0,this.Fo&&this.Fo.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.No?this.No(e,t):this.Fo&&this.Fo.postMessage(e,t)},e.prototype.dispose=function(e,t){var n=this;return new Promise((function(i){if(n.Mo&&(n.Ro.removeChild(n.Mo),n.Mo=void 0),n.Fo&&(n.Fo.dispose(),n.Fo=void 0,n.zi=void 0),n.No&&(n.No=void 0),n.ot=void 0,!n.Uo||!n.Wo&&e)i();else{var o=function(){n.Wo?(n.Wo.removeChild(n.Uo),n.Ro.removeChild(n.Wo)):n.Ro.removeChild(n.Uo),n.Uo=void 0,n.Wo=void 0,i()};t?o():(n.Uo.src="about:blank",window.setTimeout(o,0))}}))},e}(),He=function(){function e(e,t,n){var i=this;this.sessions=[],this.containers=[],this.Ho=function(e){i.Do.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var n=e.user;if(!n||null==n.id)throw new TypeError("UserInfo")}(e),this.Jo=e,this.Bo=t,this.Lo=n,this.Do=new fe,u()}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Bo.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return J()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Do.add(e)},e.prototype.removeEventListener=function(e){this.Do.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_"+this.Bo.name+"_"+this.containers.length,n=new Ne(e,t);return this.containers.push(n),n},e.prototype.createSession=function(e){var t=new xe(this.Jo,this.Bo,e,this,this.Ho,this.Lo);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,n=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(n).then((function(e){return t.Do.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();function ke(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(n){return e[n]=t.Diagnostics[n]}))}function De(e,t,n){t.ULS.he(596459999,i.H,n,"SessionTraces: "+JSON.stringify(e))}function Je(e,t){t.stop();var n=t.getVisibilityChangeEvents();null!=n&&n.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(n)),t.dispose()}function Be(e,t,n){try{var r=function(e,t){var n=me({},t);delete n.UserId,delete n.OwnerId,delete n.SiteId,delete n.WebId,delete n.Upn,delete n.TenantId,delete n.UiHostTabId,delete n.WdParams;var i=n,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};return i.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){o[e]&&(i.WdParams[e]=o[e])})),i.UiEmbedMode=A(e,"uiembed"),i.UiHostName=O(e,"uih")||"N/A",i.HostDomain=location?location.hostname:"",i}(t.applicationUrl,t.sessionInformation);r.Build=J(),r.Region=S(t.applicationUrl);var s=me({},t.rebootOverrideData);delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl,r.RebootOverride=s;var a=t.diagnostics.HostInitDiagnostics;a&&(e.ULS.he(596444238,i.H,o.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),r.SessionOrigin=a.entryPoint),n&&e.ULS.he(595937313,i.H,o.Info,JSON.stringify(n)),e.ULS.he(595632928,i.H,o.Info,function(){if(window&&window.navigator){var e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());var c=t.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||e.ULS.he(595894553,i.H,o.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(r.AccessTokenLength=c.AccessToken.length),r.AccessTokenExpiry=c.AccessTokenExpiry),r.JsApiVersion="v1",e.ULS.he(596444237,i.H,o.Info,JSON.stringify({session:r,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.he(558155802,i.H,o.Error,"Failed to log initialization info: "+te(t))}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Me||(Me={}));function Le(e){return e+"_layouts/RemoteTelemetry.ashx"}function je(e){return Le(qe(e))}function Ve(e,t,n,i,o,r){void 0===r&&(r=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var n=e.SessionInformation;n.WdParams||(n.WdParams={});if(n.WdParams.wd)return;t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(n.WdParams[t[0]]=t[1])}}));var i=e.RebootOverrideData;i&&i.previousSessionId&&(n.WdParams.wdprevioussession=i.previousSessionId)}(e,window.location.search);var s=o||new le("Excel",n),a=qe(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:ye(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:J(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:a,remoteTelemetryUrl:Le(a),wopiInfo:e.WopiInfo,forceSingleStepBoot:r,isCreateNew:e.WopiPrecheckInfo.IsNewFile||A(e.ApplicationUrl,"new"),featureManager:i||ne(e.FnIsFeatureEnabled,n),He:s,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new Te(n,!0)}}function qe(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}var ze=function(){function e(e,t,n,r,s){var a=this;this.jo=0,this.Vo=[];var c=t.getValue(X.Ue,!1);this.jo=z()+(s||t.getValue(X.Oe,3e5));var u=e?3e3:5e3;this.qo=window.setInterval((function(){c&&n.ULS.he(595724178,i.H,o.Info,"Boot_HeartBeat"),z()>a.jo&&(a.stop(),Ge(n),r&&r())}),t.getValue(X.Fe,u)),this.Vo.push(window.setTimeout(Ge,t.getValue(X.Ee,6e4),n,1)),this.Vo.push(window.setTimeout(Ge,t.getValue(X.Ce,18e4),n,2))}return e.prototype.stop=function(){this.jo=0,this.qo&&(window.clearInterval(this.qo),this.qo=void 0),this.Vo.forEach((function(e){window.clearTimeout(e)})),this.Vo=[]},e}();function Ge(e,t){e.ULS.he(594901218,i.H,o.Warning,"Boot_NotComplete_"+(t||"Final")),e.ULS.flush()}function Ke(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}var Xe,Ze=function(e,t,n,i,o){return e!==se.cn?Promise.reject("Wrong flow"):new Promise((function(e){Ke(t.overlayContent),n.container&&n.container.postMessage(ae.oi,void 0),e({completion:"success"})}))};function $e(e){if(!e)return"";var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}function Qe(e){return $e(e.hostKey)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Xe||(Xe={}));var Ye=function(e,t,n,r,s){return e!==se.Lt?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey;n.logger.ULS.he(574408915,i.H,o.Info,"getHostKeyValue "+r);var s=Qe(t);n.container&&s&&n.container.postMessage(ae.Bn,{hostKey:r,hostValue:s}),e({completion:"success"})}))};function et(e){!function e(t,n,i,o){void 0===o&&(o=Xe.none);var r=t+"="+n,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=";SameSite="+Xe[o];return document.cookie=r+s+u,!(!document.cookie||-1===document.cookie.indexOf(r))||o===Xe.none&&e(t,n,i,Xe.doNotSet)}(e.hostKey,e.hostValue,365)}var tt=function(e,t,n,r,s){return e!==se.dn?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey,s=t.hostValue;n.logger.ULS.he(574408914,i.H,o.Info,"storeHostKeyValue "+r+": "+s),et(t),e({completion:"success"})}))};function nt(e){return new RegExp("xlviewerinternal.aspx","i").test(e)}function it(e){return new RegExp("xlembed.aspx","i").test(e)}function ot(e){return new RegExp("xlpreview.aspx","i").test(e)}var rt,st,at,ct,ut,ft,lt,dt,ht,pt;function vt(e,t,n,r){ft=e,lt=t,dt=void 0,ht=n,pt=r,rt=!1,st=!1,at=0,St(),setTimeout((function(){ft.ULS.he(593589517,i.H,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function e(){if(at>=3)return void ft.ULS.he(595350870,i.H,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(St(),rt)setTimeout((function(){(!st||at>0)&&ft.ULS.he(595350872,i.H,o.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+st+" after first flush retry attempt: "+at)}),ut);else{if(at+=1,ft.ULS.he(595350871,i.H,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+at),ht.isFeatureEnabled(Q.Be)&&1===at)document.getElementById(lt).submit();setTimeout((function(){e()}),ct)}}()}),ct),ht.isFeatureEnabled(Q.Je)&&(window.localStorage?window.addEventListener("offline",It):ft.ULS.he(593589518,i.H,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),ft.ULS.he(594622165,i.H,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+ht.isFeatureEnabled(Q.Je))}function mt(e){"PageLoadSkeleton Presented"===e?rt=!0:"BootstapContext Recieved"===e&&(st=!0)}function wt(){if(ht.isFeatureEnabled(Q.Je))if(window.localStorage)for(var e=0;e<localStorage.length;e+=1)try{var t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){var n=localStorage.getItem(t);ft.ULS.he(593589520,i.H,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+n),localStorage.removeItem(t)}}catch(e){ft.ULS.he(593589521,i.H,o.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+te(e))}else ft.ULS.he(593589519,i.H,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function gt(e){return nt(e)||it(e)}function St(){ct=3750,ut=6e3;var e=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}}();if(void 0!==e)switch(void 0!==dt&&dt!==e&&ft.ULS.he(595350873,i.H,o.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+dt+" currentConnection: "+e+" First Flush: "+rt+" Second Flush:"+st),dt=e,e){case"4g":ct=3750,ut=6e3;break;case"3g":ct=5e3,ut=8e3;break;case"2g":ct=1e4,ut=24e3;break;case"slow-2g":ct=2e4,ut=4e4}}function It(){try{var e=G(),t="OfflineMode_"+pt+"_"+e,n={"Sessionid:":pt,OfflineTime:e};localStorage.setItem(t,JSON.stringify(n))}catch(e){ft.ULS.he(593589522,i.H,o.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+te(e))}}var bt,yt;function _t(e,t){bt=e;try{window.localStorage?(t.registerMessagePayloadHandler(se.yn,(function(e){!function(e){if(e&&e.hasOwnProperty("cacheItemKey")&&0===e.cacheItemKey.indexOf("XlHc_")&&e.hasOwnProperty("cacheItemValue"))try{window.localStorage.setItem(e.cacheItemKey,e.cacheItemValue),bt.ULS.he(574677249,i.H,o.Info,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: setting localstorage HostFrame cache item")}catch(e){bt.ULS.he(574677250,i.H,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: error while saving HostFrame to local storage. error: "+te(e))}else bt.ULS.he(574677251,i.H,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: HostFrame cache save message does not contain all expected values, skipping HostFrame cache save")}(e)})),t.registerMessagePayloadHandler(se._n,(function(e){!function(e){if(e&&e.hasOwnProperty("workbookList")&&e.hasOwnProperty("evictAllExceptListed"))try{var t=e.evictAllExceptListed,n=JSON.parse(e.workbookList);bt.ULS.he(574677252,i.H,o.Info,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: removing items from cache. workbookList length: "+n.length+", evictAllExceptListed: "+t),!0===t?function(e){for(var t=new Date,n=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).getTime(),r=0;r<localStorage.length;r+=1){var s=localStorage.key(r),a=!1;if(0===s.indexOf("XlHc_")){if(e.indexOf(s)<0)a=!0;else{var c=localStorage.getItem(s),u=void 0;try{u=JSON.parse(c)}catch(e){bt.ULS.he(574677255,i.H,o.Warning,"ExcelHostFrameCacheManager: evictAllItemsExcept: unable to check for stale HostFrame cache, error parsing HostFrame cache item, error: "+te(e))}if(u)n-u.LastModified>5184e6&&(a=!0);else a=!0}a&&(localStorage.removeItem(s),bt.ULS.he(574677256,i.H,o.Verbose,"ExcelHostFrameCacheManager: EvictAllItemsExcept: Removed HostFrame cache item"))}}}(n):function(e){for(var t=0;t<e.length;t+=1)localStorage.removeItem(e[t]),bt.ULS.he(574677257,i.H,o.Verbose,"ExcelHostFrameCacheManager: EvictSpecificItems: Removed HostFrame cache item")}(n)}catch(e){bt.ULS.he(574677253,i.H,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: error while evicting HostFrame from local storage. error: "+te(e))}else bt.ULS.he(574677254,i.H,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: HostFrame cache evict message does not contain all expected values")}(e)}))):bt.ULS.he(574677217,i.H,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){bt.ULS.he(574677218,i.H,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: error while initializing.")}}function Tt(e,t){var n={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?yt.forceSingleStepBoot:yt.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(n=function(e,t){var n=e.applicationUrl,r=nt(n),s=it(n),a=ot(n),c={isSingleStepBoot:!0,bootFlowType:yt.forceSingleStepBoot,ignoreWacFramePostMessages:!(r||s)};return r||s||a||t.ULS.he(553673219,i.H,o.Warning,"Unknown endpoint: "+R(n)),c}(e,t)),n.isSingleStepBoot){var r={singleStepBootIsRequired:!0,singleStepBootReason:n.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:n.ignoreWacFramePostMessages};t.ULS.he(596444182,i.H,r.irmEnabled?o.Warning:o.Info,JSON.stringify(r))}else t.ULS.he(596444183,i.H,o.Info,"Received input valid for two step flow");return n}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(yt||(yt={}));function Ot(e,t,n,r,s,a,c){var u=function(e,t,n){var i=e.ownerDocument.createElement("iframe");i.name=n||"WebApplicationFrame",i.id="WebApplicationFrame",i.src="",i.title="Office Online Frame",i.width="100%",i.height="100%",i.marginWidth="0",i.marginHeight="0",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.display="block",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.border="none",i.frameBorder="0",i.setAttribute("allowfullscreen","true"),i.setAttribute("allowTransparency","true");var o=b(t);return i.setAttribute("allow","microphone "+o+"; camera "+o+"; clipboard-read "+o+"; clipboard-write "+o+"; keyboard-map "+o+";"),e.appendChild(i),i}(e,t,c);return gt(t)&&vt(s,"office_form",r,a),function(e,t,n){try{bt||(bt=e);var r=t[Ae.$i]+"_"+n+"_"+t[Ae.po]+"_"+t[Ae.yo];if(r="XlHc_"+function(e){var t=0,n=e.length,i=0;if(n>0)for(;i<n;)t=(t<<5)-t+e.charCodeAt(i)|0,i+=1;return t}(r),t[Ae._o]=r,window.localStorage){var s=localStorage.getItem(r);null!==s&&(t[Ae.To]=s)}else bt.ULS.he(574677219,i.H,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){bt.ULS.he(574677248,i.H,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: error while setting host frame cache post data.")}}(s,n,""),function(e,t,n,i){Ue(e,i);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=n,r.target=e.name,r.method="POST",i){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=i[s],r.appendChild(a)}return t.appendChild(r),r.submit(),e}(u,e,t,n)}function Et(e,t,n){void 0===n&&(n=!1);var i=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&i.replace("unified=1","edit=1&new=1");var o={jsApi:"1",jsapiver:"v1"};if(n&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.HideEditUpsellDialog&&(o.hdeditdlg="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){var r=e.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),e.sessionInformation.UseDarkTheme&&(o.udt="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),e.sessionInformation.HideHeader&&(o.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),e.sessionInformation.HideChatInHeader&&(o.hch="1"),e.sessionInformation.HideMeInHeader&&(o.hmh="1"),e.sessionInformation.HideSearchInHeader&&(o.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),e.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===yt.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(b(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);var s=e.wopiPrecheckInfo.FileSize;return s&&s>=52428800&&s<=104857600&&(o.ilf="1"),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o=me(me({},e.applicationCustomSettings.additionalApplicationParameters),o)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o=me(me({},o),e.rebootOverrideData.queryOverrides)),function(e,t,n,i,o){var r=C(e);("teams"===r.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType||"owa"===r.uih)&&(r.hhdr="1");var s=e.indexOf("?"),a=-1===s?e.concat("?"):e.substring(0,s+1);t.UiLocale&&(r.ui=encodeURIComponent(t.UiLocale));t.DataLocale&&(r.rs=encodeURIComponent(t.DataLocale));t.HostSessionId&&(r.hid=encodeURIComponent(t.HostSessionId));t.DisableChat&&(r.dchat="1");t.SessionContext&&(r.sc=encodeURIComponent(t.SessionContext));n&&n.WopiSrc&&(r.wopisrc=encodeURIComponent(n.WopiSrc));t.CookieCompliant&&(r.mscc="1");i&&(i.entryPoint&&(r.wdorigin=encodeURI(i.entryPoint)),i.userClickTime&&(r.wdhostclicktime=i.userClickTime.toString()));r=me(me(me({},r),t.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var f=[];for(var u in c)c[u]&&f.push(u.concat("=",c[u]));return a.concat(f.join("&"))}(i,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function Ct(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}var Rt=function(){function e(e,t,n,r,s,a){var c=this;if(this.zo=!1,this.Go=function(e,t){c.Ko.officeFrameCreateTime=G(),c.Xo.frameCreateStartTime=c.Ko.officeFrameCreateTime;var n=c.Zo.applicationCustomSettings&&c.Zo.applicationCustomSettings.appFrameName;c.$o=Ot(c.Zo.container,e,t,c.Zo.featureManager,c.ot,c.Zo.sessionId,n),c.Qo.activate(c.$o)},this.Yo=function(e){c.Qo.registerMessagePayloadHandler(se.bt,c.er),c.Qo.registerMessagePayloadHandler(se.St,c.nr),c._e=window.setTimeout(c.ir,15e3),c.or=new ze(e,c.Zo.He,c.ot,(function(){L(c.Zo.remoteTelemetryUrl,"Excel","bootTimeout")}))},this.rr=function(e){var t=e&&e.state?e.state:"unknown";c.ot.ULS.he(595714271,i.H,o.Info,"WAC Boot App state:["+t+"]"),mt(t)},this.sr=function(e){var t=We(c.ot);c.ot.ULS.he(595653903,i.H,o.Info,"Top frame is trusted: "+t),c.ar(ae.kt,{isTopFrameTrusted:t})},this.cr=function(e){var t=Ke(e&&e.overlayContent);c.ot.ULS.he(587487432,i.H,o.Info,"Overlay content: "+t),c.ar(ae.oi,void 0)},this.er=function(e){if(c.ot.ULS.he(595986314,i.H,o.Info,"Received wac complete message"),c.ot.ULS.flush(),window.clearTimeout(c._e),c.or&&c.or.stop(),wt(),c.zo)c.ot.ULS.he(596444234,i.H,o.Info,"Received multiple wac complete or failure messages");else{c.zo=!0,c.ar(ae.Mn,{}),ke(c.Ko,e);var t=c.ur();c.lr(t),c.dr(c.Zo.diagnostics)}},this.hr=function(){c.ot.ULS.he(579342464,i.H,o.Info,"Received close tab message");try{window.close()}catch(e){c.ot.ULS.he(579213188,i.H,o.Warning,"Failed to close the browser tab")}},this.pr=function(){var e=function(e){if(window.performance&&window.performance.getEntriesByType("resource")){var t=window.performance.getEntriesByType("resource"),n={},r={unixTimestamp:Date.now(),highResTimestamp:window.performance.now()};return t.forEach((function(e){var t=e.name.split("?")[0];if(t.indexOf(".js")>0||t.indexOf(".css")>0){var i=t.substr(t.lastIndexOf("/"));n[i]={startTime:e.startTime,fetchStart:e.fetchStart,requestStart:e.requestStart,responseStart:e.responseStart,responseEnd:e.responseEnd,cacheHit:be(e)}}})),{coreResourceDownloadMap:n,referenceTimestampMarkers:r}}e.ULS.he(544494928,i.H,o.Info,"Browser does not support getEntriesByType in the Performance API.")}(c.ot);e&&(c.Zo.diagnostics.HostInitDiagnostics?c.Zo.diagnostics.HostInitDiagnostics.hostResourceDownloadHighResTime=e:c.Zo.diagnostics.HostInitDiagnostics={hostResourceDownloadHighResTime:e})},this.ur=function(){return{innerApplicationFrame:c.$o}},this.nr=function(e){if(c.ot.ULS.he(595986315,i.H,o.Error,"Received wac failed message"),c.ot.ULS.flush(),window.clearTimeout(c._e),c.or&&c.or.stop(),c.zo)c.ot.ULS.he(596444235,i.H,o.Info,"Received multiple wac complete or failure messages");else{c.zo=!0,c.ar(ae.Wn,{});var t={errorType:Me.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,c.Xo.error=t),c.vr(t)}},this.mr=function(e){var t=e.hostKey;c.ot.ULS.he(574433173,i.H,o.Info,"GetHostKeyValue "+t);var n=Qe(e);null!=n&&c.ar(ae.Bn,{hostKey:t,hostValue:n})},this.wr=function(e){var t=e.hostKey,n=e.hostValue;c.ot.ULS.he(574433174,i.H,o.Info,"storeHostKeyValue "+t+": "+n),et(e)},this.ir=function(){c.zo||c.ot.ULS.he(596444236,i.H,o.Warning,"Timeout. SessionTraces:"+JSON.stringify(c.Xo))},this.dr=function(e){c.ar(ae.Ln,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.ar=function(e,t){c.$o&&c.$o.contentWindow?c.Qo.sendPostMessage(c.$o,e,t):c.ot.ULS.he(595955718,i.H,o.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.Zo=e,this.gr=t,this.ot=n,this.Qo=r,this.lr=s,this.vr=a,this.Ko=e.diagnostics.AppInitDiagnostics,this.Xo=e.diagnostics.SessionTraces,this.Xo.wopiInitializeTime=G()}return e.prototype.Boot=function(){this.ot.ULS.he(596444241,i.H,o.Info,"Initializing WAC frame");var e=Et(this.Zo,this.gr,!0),t=function(e,t){var n={};if(e.wopiInfo&&(n[Ae.Gi]=e.wopiInfo.AccessToken,n[Ae.Ki]=Ct(e.wopiInfo)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(n[Ae.Xi]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var r=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.he(593503580,i.H,o.Info,"Content bundle staleness - "+r),n[Ae.Zi]=r}else t.ULS.he(593503581,i.H,o.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(n[Ae.io]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(n[Ae.oo]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){var s=ee(e.wopiPrecheckInfo.FileName);s&&(n[Ae.no]=s),n[Ae.so]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?n[Ae.ao]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(n[Ae.ao]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(n[Ae.yo]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(n[Ae.mo]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(n[Ae.wo]=e.sessionInformation.SessionContext),e.diagnostics.HostInitDiagnostics&&(n[Ae.ho]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),n[Ae.to]=ie(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(n[Ae.vo]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),n[Ae.do]=String(window.devicePixelRatio>1.24),n[Ae.So]=String(d()),n[Ae.po]=e.sessionInformation.HostName;var a=e.newFileTemplateSource;return a&&a.FileGetUrl&&(n[Ae.Io]=a.FileGetUrl),a&&a.DocUniqueId?n[Ae.$i]=a.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(n[Ae.$i]=e.wopiPrecheckInfo.DocUniqueId),a&&a.ETag?n[Ae.eo]=a.ETag:e.wopiPrecheckInfo.ETag&&(n[Ae.eo]=e.wopiPrecheckInfo.ETag),n[Ae.Oo]=(new Intl.DateTimeFormat).resolvedOptions().timeZone,e.sessionInformation.ContentAssembly&&(n[Ae.Co]="1"),n}(this.Zo,this.ot);if(this.Qo.registerMessagePayloadHandler(se.It,this.rr),this.Qo.registerMessagePayloadHandler(se.Tt,this.hr),this.Qo.registerMessagePayloadHandler(se.kt,this.sr),this.Qo.registerMessagePayloadHandler(se.cn,this.cr),this.Qo.registerMessagePayloadHandler(se.Lt,this.mr),this.Qo.registerMessagePayloadHandler(se.dn,this.wr),this.gr.ignoreWacFramePostMessages||this.Yo(w(e)),this.Go(e,t),this.gr.ignoreWacFramePostMessages){var n=this.ur();this.lr(n)}return this.ot.ULS.he(595661019,i.H,o.Info,"Created Wac Frame"),this.$o},e}(),Pt=!1,At=!1;function xt(){Pt=!1}function Ft(e,t,n,r,s,a,c){if(t.ULS.he(595714433,i.H,o.Info,"Starting disposing the application. unloadApp:"+e+"; disposed:"+Pt+"; unloading:"+At),Pt||At&&e)t.ULS.he(595714908,i.H,o.Info,"Application is already disposed or unloading");else{var u,f={logger:t,postMessenger:n,innerApplicationFrame:r,onDisposed:s,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:G(),appUnloadTimedOut:!1};if(e&&r)return At=!0,f.forceAppUnload=!0,(u=f).forceAppUnloadStartTime=G(),u.logger.ULS.he(595855490,i.H,o.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(se.hn,(function(e){return function(e,t){e.forceAppUnloadEndTime=G(),e.appUnloadedMessageValues=t,e.logger.ULS.he(595855491,i.H,o.Info,"AppUnloaded received from app"),Ut(e)}(u,e)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame,ae.ai,{}),void window.setTimeout((function(){return function(e){!At&&Pt||(e.appUnloadTimedOut=!0,e.logger.ULS.he(595855492,i.H,o.Info,"ApplicationUnload timed out, forcing dispose"),Ut(e))}(u)}),u.unloadTimeoutInMs);Ut(f)}}function Ut(e){if(!Pt)try{Pt=!0,At=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:G(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var n=e.appUnloadedMessageValues,r=Number(n.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-e.forceAppUnloadStartTime);var s=Number(n.appMessageSent);!isNaN(s)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-s);var a=Number(n.appUnloadStart),c=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),n.serverTimings){var u=n.serverTimings;for(var f in u)t["st-"+f.toString()]=u[f]}}e.logger.ULS.he(595855436,i.H,o.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.he(595714434,i.H,o.Error,"Error disposing: "+te(t))}}var Wt,Mt=function(){function e(e,t,n,r,s,a,c){var u=this;this.Sr=!1,this.Ir=!1,this.br=!1,this.yr=null,this._r=!0,this.Tr=!1,this.Or=!1,this.Er=function(){u.ot.ULS.he(596444231,i.H,o.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(u.Cr,5e3),u.Qo.registerMessagePayloadHandler(se.gt,u.Rr),u.Qo.registerMessagePayloadHandler(se.an,u.Pr);var e=new Rt(u.Zo,u.gr,u.ot,u.Qo,u.lr,u.vr);u.$o=e.Boot()},this.Ar=function(){var e={ParallelizeStartSession:u._r,WacFrameIsLoaded:u.Sr,WacAcceptsStartSessionComplete:u.Tr};u.ot.ULS.he(596444232,i.H,o.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!u._r||u.Sr&&!u.Tr?u.Sr&&u.xr():u.Fr()},this.Ur=function(){u.ot.ULS.he(596444233,i.H,o.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),u.Zo.wopiInfo=u.Wr;var e=new Rt(u.Zo,u.gr,u.ot,u.Qo,u.lr,u.vr);u.$o=e.Boot()},this.Mr=function(e){u.Sr?(u.ot.ULS.he(595968481,i.H,o.Warning,"Fail called and wacframe is able to accept postmessages"),u.Nr(e)):(u.ot.ULS.he(595968482,i.H,o.Warning,"Fail was called on the session prior to WacReady."),u.yr=e)},this.Nr=function(e){u.ot.ULS.he(596444189,i.H,o.Warning,"Fail called, sending the failure postmessage to IFrame"),u.ar(ae.ii,e)},this.Hr=function(){u.ot.ULS.he(596444190,i.H,o.Warning,"Fail called during single step boot, calling host failure callback..."),u.vr({errorType:Me.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.Cr=function(){u.Sr||(u.ot.ULS.he(596444191,i.H,o.Warning,"Timeout Wac Ready"),u.vr({errorType:Me.TimeoutWacReady,errorObject:void 0}))},this.kr=function(){u.br||(u.Xo.timeoutCompleteOrFail=G(),u.ot.ULS.he(596444192,i.H,o.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(u.Xo)))},this.Dr=function(e,t,n){u.Or||(u.ot.ULS.he(596444193,i.H,o.Info,"SessionCompletion timed out with no ack."),u.Jr(e,t,n+1))},this.Rr=function(e){if(u.Xo.readyMessageReceiveTime=G(),u.ar(ae.xn,{}),u.Sr)u.ot.ULS.he(596444194,i.H,o.Info,"Received multiple ready messages - frame is already loaded.");else{u.Sr=!0,u.Tr=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:u.Tr,ParallelizeStartSession:u._r,StartSessionResponseAvailable:!!u.Br,WopiInfoAvailable:!!u.Wr};u.ot.ULS.he(596444195,i.H,o.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),u.br&&(u.yr?u.Nr(u.yr):u.ar(ae.ri,{})),u._r&&u.Tr?u.Br&&u.Lr():u.Wr&&u.xr(),ke(u.Ko,e)}},this.Pr=function(e){u.Or=!0,u.Xo.sessionCompleteAckReceivedTime=G()},this.ar=function(e,t){u.Qo.sendPostMessage(u.$o,e,t)},this.jr=function(e,t){u.Jr(e,t,1)},this.Jr=function(e,t,n){if(n>3)u.ot.ULS.he(596444224,i.H,o.Error,"Attempted to call complete, but received no ack from the frame. Time: "+G());else{u.ot.ULS.he(596444225,i.H,o.Info,"Sending completion message to frame. Attempt number: "+n+", Time: "+G());var r=G();1===n&&(u.Br&&u.Br.Diagnostics&&(u.Br.Diagnostics.completeMessageCreateTime=r),u.Xo.completeMessageCreateTime=r),t.Diagnostics.completeMessageSendTime=r,u.Xo.completeMessageSendTime=r,u.ar(e,t),window.setTimeout((function(){return u.Dr(e,t,n)}),1e3)}},this.Fr=function(){u.ot.ULS.he(596444226,i.H,o.Info,"Making parallelized startSession request.");var e=u.Vr(u.Wr),t={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(u.Wr.AccessToken)+"&access_token_ttl="+encodeURIComponent(Ct(u.Wr));u.Xo.startSessionStartTime=G(),function(e,t,n,i){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),n)o.setRequestHeader(r,n[r]);o.send(t)}(e,n,t,u.qr)},this.qr=function(e){if(u.Xo.startSessionCompleteTime=G(),u.Xo.startSessionResponseStatus=e.status,u.Br={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:u.Xo.wopiPendingInitializeTime,wopiPendingCompleteTime:u.Xo.wopiPendingCompleteTime,startSessionStartTime:u.Xo.startSessionStartTime,startSessionCompleteTime:u.Xo.startSessionCompleteTime,readyMessageReceiveTime:u.Xo.readyMessageReceiveTime}},u.ot.ULS.he(596444227,i.H,o.Info,"StartSession request completed with status code: "+u.Br.StartSessionResponse.RequestStatus+", Time: "+G()),u.Sr&&u.Tr)u.Lr();else{var t={WacFrameIsLoaded:u.Sr,InitializeCompleted:u.Ir};u.ot.ULS.he(596444228,i.H,o.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},this.xr=function(){if(!u.Ir){u.Ir=!0,u.ot.ULS.he(596444229,i.H,o.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:u.Wr.WopiSrc,AccessToken:u.Wr.AccessToken,AccessTokenTtl:Ct(u.Wr)},Diagnostics:{wopiPendingInitializeTime:u.Xo.wopiPendingInitializeTime,wopiPendingCompleteTime:u.Xo.wopiPendingCompleteTime,readyMessageReceiveTime:u.Xo.readyMessageReceiveTime}};u.jr(ae.Hn,e)}},this.Lr=function(){200===u.Br.StartSessionResponse.RequestStatus?u.Ir||(u.Ir=!0,u.jr(ae.Nn,u.Br)):u.xr()},this.Vr=function(e){var t=u.Zo.applicationBasePath+"wordeditorstartsession.ashx",n=Et(u.Zo,u.gr,!1);return t=E(t+="?"+n.substring(n.indexOf("?")+1),"WOPISrc",encodeURIComponent(e.WopiSrc)),t=E(t,"build",encodeURIComponent(J())),t=E(t,"WacUserType",encodeURIComponent("WOPI")),u.Zo.wopiPrecheckInfo.FileGetUrl&&(t=E(t,"fileGetUrlPresent","1")),t},this.zr=function(e){if(u.Zo.isCreateNew){if(!e||!e.NewFilePath)return void u.ot.ULS.he(596444230,i.H,o.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.Zo=e,this.gr=t,this.Ko=e.diagnostics.AppInitDiagnostics,this.ot=n,this.Qo=r,this.lr=a,this.vr=c,this.Xo=e.diagnostics.SessionTraces,this.Xo.wopiPendingInitializeTime=G(),this.Gr=s,xt(),window.setTimeout(this.kr,5e3)}return e.prototype.Complete=function(e,t){if(this.br)this.ot.ULS.he(596444184,i.H,o.Warning,"Complete called after Complete/Fail already called");else{this.ot.ULS.he(596444185,i.H,o.Info,"Complete called."),this.br=!0,this.Wr=e,this.Xo.wopiPendingCompleteTime=G();try{this.gr.isSingleStepBoot?this.Ur():this.Ar(),this.Sr&&this.ar(ae.ri,{}),this.zr(t)}catch(e){this.ot.ULS.he(596444186,i.H,o.Error,"Unexpected script error: "+te(e)),L(this.Zo.remoteTelemetryUrl,"Excel","bootException")}finally{this.ot.ULS.flush()}}},e.prototype.Fail=function(e){this.br?this.ot.ULS.he(596444187,i.H,o.Warning,"Fail called after Complete/Fail already called"):(this.ot.ULS.he(596444188,i.H,o.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.br=!0,this.gr.isSingleStepBoot?this.Hr():this.Mr(e),this.ot.ULS.flush())},e.prototype.Dispose=function(e,t,n){var i=this;Ft(e||!1,this.ot,this.Qo,this.$o,(function(){delete i.$o,t&&t(),i.Gr(),i.Qo.dispose()}),void 0,n)},e.prototype.Boot=function(){this.gr.isSingleStepBoot||this.Er(),this.ot.ULS.flush()},e}(),Nt=((Wt={})[re.blurFocus]=ae.Un,Wt[re.continueAccessibilityLoop]=ae.kn,Wt[re.grabFocus]=ae.Dn,Wt[re.moveToFolder]=ae.Gt,Wt[re.popState]=ae.Vn,Wt[re.rename]=ae.qn,Wt[re.sendAccessToken]=ae.zn,Wt[re.sendAuthToken]=ae.Gn,Wt[re.sendCustomAuthConfig]=ae.Kn,Wt[re.sendEmbeddedViewUrl]=ae.Zn,Wt[re.sendSessionInfo]=ae.$n,Wt[re.sendUserAccessAndPermissions]=ae.Qn,Wt[re.sendWopiInfo]=ae.Yn,Wt[re.sendDavUrl]=ae.ei,Wt[re.completeSharedFilePicker]=ae.rn,Wt[re.switchMode]=ae.si,Wt[re.signalShared]=ae.di,Wt),Ht=function(){function e(e,t){var n=this;if(this.Kr=!1,this.Xr={},this.Di="",this.Ji="",this.ji=!1,this.Bi=!1,this.Li=!1,this.Zr=[],this.$r=!0,this.Qr=function(e,t,r){if(e){var s={MessageId:ae.An,CorrelationId:r,SendTime:G()};n.ot.ULS.he(595732176,i.H,o.Info,"Sending Ack back"),e.postMessage(JSON.stringify(s),t)}else n.ot.ULS.he(595736136,i.H,o.Info,"Missing target to send Ack back")},this.Yr=function(e){var t=!1,r=!0,s="",a=!1;if(n.$o&&n.$o.contentWindow&&(t=!0,r=e.source===n.$o.contentWindow),e.origin&&(a=(s=y(e.origin,2).toLowerCase())===n.Ji),!n.Bi&&(!n.Li||a&&r)||n.ot.ULS.he(595730526,i.H,o.Info,"Window is available: "+t+", window is valid: "+r+", origin is valid: "+a+", expected origin: "+n.Ji+", actual origin: "+s),a&&(!n.ji||r)){var c;try{c=JSON.parse(e.data)}catch(e){return void n.ot.ULS.he(596464282,i.H,o.Info,"Failed to parse event data: "+te(e)+".")}var u=c.MessageId;if(u){n.ot.ULS.he(595714715,i.H,o.Info,"Received messageId: "+u+", correlation: "+c.CorrelationId),u!==se.bt&&u!==se.qt||n.ts(e.origin),c.Values&&c.Values.ackExpected&&n.Qr(e.source,e.origin,c.CorrelationId);var f=n.Xr[u];if(!f)return n.ot.ULS.he(596464289,i.H,o.Info,"No handler found for message id: "+u),void(n.$r&&u===se.Jt&&(n.Zr.push(c),n.ot.ULS.he(543207888,i.H,o.Info,"Kept for later process: "+u)));n.ot.ULS.he(596464288,i.H,o.Info,"Processing message: "+u);try{f(c.Values||{})}catch(e){n.ot.ULS.he(593773704,i.H,o.Error,"Handler error: "+te(e))}n.$r&&u===se.bt&&n.ns()}else(n.Bi||n.Li)&&n.ot.ULS.he(595730520,i.H,o.Info,"Could not find message id")}},this.ns=function(){n.$r=!1,n.Zr.forEach((function(e){var t=e.MessageId,r=n.Xr[t];if(r){n.ot.ULS.he(543207890,i.H,o.Info,"Processing message after boot complete: "+t);try{r(e.Values||{})}catch(e){n.ot.ULS.he(543207891,i.H,o.Error,"Handler error: "+te(e))}}else n.ot.ULS.he(543207889,i.H,o.Info,"No handler found after boot complete: "+t)})),n.Zr=[]},this.os=function(e,t,n){e.postMessage(t,n)},this.ts=function(e){var t=e.toLowerCase();n.Di&&n.Di!==t&&n.ot.ULS.he(596128131,i.H,o.Warning,"Updating origin: ["+F(n.Di)+"]->["+F(t)+"]"),n.Di=t,n.Ji=y(t,2),n.Bi=w(t),n.Li=g(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Bi=w(e),this.Li=g(e),this.ot=t,this.ts(e)}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Xr[e])throw new Error("Duplicate registration!");this.Xr[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Xr[e]},e.prototype.sendPostMessage=function(e,t,n){if(e&&e.contentWindow){this.ot.ULS.he(596464334,i.H,o.Info,"Sending message: "+t);var r={MessageId:t,SendTime:G(),Values:n};this.os(e.contentWindow,JSON.stringify(r),this.Di)}else this.ot.ULS.he(595948308,i.H,o.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.$o=e,this.ji=!!t,this.Kr||(window.addEventListener("message",this.Yr,!1),this.Kr=!0)},e.prototype.postMessageForCommand=function(e,t,n){var r=Nt[t];r?(this.ot.ULS.he(595702598,i.H,o.Info,"Sending message "+r+" for command "+t),this.sendPostMessage(e,r,n)):this.ot.ULS.he(595702599,i.H,o.Warning,"No mapping for command "+t)},e.prototype.dispose=function(){this.Xr={},this.Kr&&(window.removeEventListener("message",this.Yr,!1),this.Kr=!1)},e}(),kt=function(){function e(){var e=this;if(this.ss=[],this.Xr=[],this.as=function(){var t={visibility:document.visibilityState,time:G(),initialState:!1};e.ss.push(t);for(var n=0,i=e.Xr;n<i.length;n++){var o=i[n];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:G(),initialState:!0};this.ss.push(t)}document.addEventListener("visibilitychange",this.as)}return e.prototype.registerEventHandler=function(e){this.Xr.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.Xr.indexOf(e);this.Xr.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.as)},e.prototype.getVisibilityChangeEvents=function(){return this.ss},e.prototype.dispose=function(){this.stop(),this.Xr=[],this.ss=[]},e}();var Dt=[];function Jt(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var t=0,n=window.performance.getEntriesByType("resource");t<n.length;t++){var r=n[t],s=R(r.name);if("about:blank"!==r.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file"))if("excel-boot.min.js"===s)a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.he(574662801,i.H,o.Info,a);else if(-1!==Dt.indexOf(s)){var a;a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.he(595736532,i.H,o.Info,a)}}try{var c=window.performance.getEntriesByType("navigation"),u=void 0;if(c.length>0)u=c[0].type||"UndefinedType";else u="none";e.ULS.he(555872898,i.H,o.Info,"Navigation type is: "+u)}catch(t){e.ULS.he(556011586,i.H,o.Info,"ExcelPreloader.tryObserveResourceTiming: Exception thrown when trying to read navigation type. Exception: "+JSON.stringify(t))}window.performance.clearResourceTimings()}catch(t){e.ULS.he(595732049,i.H,o.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}}),{once:!0})}var Bt;function Lt(e,t){Bt=e;try{t.registerMessagePayloadHandler(se.Tn,(function(e){!function(e){if(!e||!e.hasOwnProperty("fileUrl")||!e.hasOwnProperty("fileType"))return void Bt.ULS.he(572383453,i.H,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: Message is missing parameter(s). values=null? "+!e+",\n        fileUrl=null? "+(e&&!e.hasOwnProperty("fileUrl"))+", fileType=null? "+(e&&!e.hasOwnProperty("fileType")));try{var t=function(){var e=new qt,t=new XMLHttpRequest;return t.timeout=3e4,t.withCredentials=!0,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e.IsSucceeded=!0,e.HostCorrelationId=function(e){var t,n=null;try{var r=(new window.DOMParser).parseFromString(e,"text/xml"),s=new URL(null!==(t=r.documentElement.textContent)&&void 0!==t?t:"");n=s.searchParams.get("correlationId")}catch(e){Bt.ULS.he(572383454,i.H,o.Warning,"ExcelFileBundleRegenerationRequester.readSpoCorrelationFromResponse: "+te(e))}return n}(t.responseText)):e.FailureReason="XhrHttp"+t.status,jt(e))},t.onerror=function(t){e.FailureReason="XhrError",jt(e)},t}(),n=function(e){var t=new URL(e.fileUrl).origin,n=new URL(t);return n.pathname="_api/SP.Utilities.WOPIHostUtility.GenerateFileBundle",n.searchParams.set("fileUrl",e.fileUrl),n.searchParams.set("fileType",e.fileType),n}(e);t.open("GET",n.toString(),!0),t.send()}catch(e){Bt.ULS.he(572381152,i.H,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: "+te(e))}}(e)}))}catch(e){Bt.ULS.he(572383452,i.H,o.Warning,"ExcelFileBundleRegenerationRequester.initRegenerateFileBundleMessageHandler: "+te(e))}}function jt(e){Bt.ULS.he(572383455,i.H,o.Warning,"ExcelFileBundleRegenerationRequester.logResult: "+JSON.stringify(e))}var Vt,qt=function(){this.IsSucceeded=!1,this.HostCorrelationId=null,this.FailureReason=null},zt=function(){function e(e,t){var n=this;this.us=function(e,t){return window.setInterval((function(){n.Prefetch({BootstrapperUrl:e}),t.ULS.he(595895774,i.H,o.Info,"Prefetching "+R(e))}),36e5)},this.fs=e,this.ls=t}return e.prototype.GetVersion=function(){return J()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var n=e.BootstrapperUrl;".js"!==n.toString().slice(-3)&&(n+=".js"),t.href=n;var i=document.getElementsByTagName("head")[0];null!=i&&void 0!==i&&i.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,n,r,s,a){var c,f,l,d,h,p=!1;try{L(je(e.ApplicationUrl),"Excel","init");var v,m=G();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var n=e.SessionInformation;if(void 0===n||void 0===n.HostName||void 0===n.HostSessionId||void 0===n.UserId)throw new TypeError("SessionInformation");var i=e.ApplicationUrl;if(void 0===i||"string"!=typeof i)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=I(e.ApplicationUrl,O(e.ApplicationUrl,"region")),e.ApplicationUrl=function(e,t){if(!e)return e;var n=e,i=n.indexOf("?"),o=t.toLowerCase()+"=",r=n.toLowerCase().indexOf(o,i);if(r>=0){var s=n.indexOf("&",r);return"&"===(n=n.substring(0,r)+(-1===s?"":n.substring(s+1))).slice(-1)&&(n=n.slice(0,-1)),n}return e}(e.ApplicationUrl,"region"),function(e){var t,n=e.RebootOverrideData;if(n)if(n.queryOverrides||(n.queryOverrides={}),t=n.mode)"view"===(t=t.toLowerCase())?n.queryOverrides.wdforcedmode="View":"edit"===t&&(n.queryOverrides.wdforcedmode="Edit");else{var i=n.reason;i&&"saveas"===(i=i.toLowerCase())&&(n.queryOverrides.wdforcedmode="Edit")}}(e),n?l=n:(l=(c=ve())[0],d=c[1]),f=t||Y({remoteUlsEndpoint:qe(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:l}),h=Ve(e,l,f,s,a,this.ls.forceSingleStepBoot),a||(h.He.addSettingsChangeListener(f.settingsChangeHandler),h.He.initializePeriodicFetch(h.applicationBasePath,l)),h.diagnostics.HostInitDiagnostics&&(h.diagnostics.HostInitDiagnostics.hostInitializeCallTime=m),Be(f,h,d),p=!0;var w=e.BootstrapperUrl;w&&(v=this.us(w,f));var g=function(){h.He.dispose(),h.pageStateObserver.dispose(),window.clearInterval(v)},S=b(e.ApplicationUrl),y=r||new Ht(S,f),_=new kt,T=Tt(h,f),E=function(e,t,n,r,s,a,c){return function(u){var f=e.diagnostics;Je(f,r),De(f.SessionTraces,n,o.Info);var l=Kt(f);n.ULS.he(596448985,i.H,o.Info,JSON.stringify(l)),L(e.remoteTelemetryUrl,"Excel","bootSuccess");var d=c(e.sessionId,n,t,s,u);try{a(d,l)}catch(e){n.ULS.he(595719171,i.H,o.Error,"Exception thrown from host's success callback: "+te(e))}Se("excel",n),Gt(n)}}(h,y,f,_,g,e.FnOnInitializeSuccess,this.fs),C=function(e,t,n,r){return function(s){var a=e.diagnostics;Je(a,n),De(a.SessionTraces,t,o.Warning);var c=Kt(a);void 0!==s&&"Js Boot Failed"!==s.errorObject.errorType&&t.ULS.he(575931487,i.H,o.Error,"Core JS failure recieved "+JSON.stringify(s)),t.ULS.he(596448986,i.H,o.Error,JSON.stringify({error:s,appInitDiagnostics:c})),L(e.remoteTelemetryUrl,"Excel","bootFailure");try{r(s,c)}catch(e){t.ULS.he(595719172,i.H,o.Error,"Exception thrown from host's failure callback: "+te(e))}Se("excel",t),Gt(t)}}(h,f,_,e.FnOnInitializeFailure);u(),e.FnOnAppModeSwitched&&y.registerMessagePayloadHandler(se.zt,e.FnOnAppModeSwitched),_t(f,y),Lt(f,y);var R=Math.random()<.5;if(!R){if(w){var A=document.createElement("link");A.rel="preconnect",A.href=P(b(w)),A.crossOrigin="anonymous",document.head.appendChild(A)}this.ls.preloader=void 0,Jt(f)}if(f.ULS.he(541717920,i.H,o.Info,"ExcelBoot: preloading enabled - "+R),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched,w&&this.ls.preloader&&this.ls.preloader.shouldPreload(h.applicationUrl))try{var x=w;Jt(f),h.featureManager.isFeatureEnabled(Q.Le)&&(f.ULS.he(595645891,i.H,o.Info,"HTTP2 preload enabled"),x=P(w));var F=h.sessionInformation.UiLocale;F||(F=decodeURIComponent(O(h.applicationUrl,"ui"))),this.ls.preloader.preload(x,F,f,h.featureManager)}catch(e){f.ULS.he(595943884,i.H,o.Error,te(e))}var U=new Mt(h,T,f,y,g,E,C);return U.Boot(),U}catch(t){return f&&(f.ULS.he(596459925,i.H,o.Error,Me.AppInitError+": "+te(t)),p||Be(f,h||Ve(e,l,f,s,a,this.ls.forceSingleStepBoot),d),f.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&L(je(e.ApplicationUrl),"Excel","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Me.AppInitError,errorObject:t})))}},e}();function Gt(e){e.ULS.he(590914655,i.H,o.Info,"Time spent logging: "+e.getTimeSpentLogging())}function Kt(e){return me(me(me({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(Vt||(Vt={}));var Xt=function(){function e(e,t,n,r,s){var a=this;this.Xr={},this.ds=function(){a.Qo.registerMessagePayloadHandler(se.Yt,a.hs),a.Qo.registerMessagePayloadHandler(se.jt,a.ps),a.Qo.registerMessagePayloadHandler(se.Vt,a.vs),a.Qo.registerMessagePayloadHandler(se.Jt,a.ms),a.Qo.registerMessagePayloadHandler(se.un,a.ws),a.Qo.registerMessagePayloadHandler(se.Bt,a.gs),a.Qo.registerMessagePayloadHandler(se.Gt,a.Ss),a.Qo.registerMessagePayloadHandler(se.rn,a.Is)},this.bs=function(e,t){var n=a.Xr[e];if(n)try{n(t||{})}catch(e){a.ot.ULS.he(593773706,i.H,o.Error,"Handler error: "+te(e))}},this.hs=function(e){e.previousSessionId=a.ys,a.bs(Vt.DocumentReboot,e)},this.ps=function(e){a.bs(Vt.WopiInfoFromUrl,e)},this.vs=function(e){a.bs(Vt.DavUrlFromIds,e)},this.ms=function(e){Promise?a._s.isResourceTrustedForMessage(e).then((function(t){t?a.bs(Vt.GetAuthToken,e):a.Qo.sendPostMessage(a.$o,ae.Gn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){a.Qo.sendPostMessage(a.$o,ae.Gn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):a.Qo.sendPostMessage(a.$o,ae.Gn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.ws=function(e){a.bs(Vt.FileShare,e)},this.gs=function(e){a.bs(Vt.GetCustomAuthConfig,e)},this.Ss=function(e){a.bs(Vt.MoveToFolder,e)},this.Is=function(e){a.bs(Vt.SharedFilePicker,e)},this.ys=e,this.ot=t,this.$o=s.innerApplicationFrame,this.Qo=n,this.Ts=r,this._s=new Ce(t),this.ds(),xt()}return e.prototype.GetApplicationType=function(){return"Excel"},e.prototype.GetVersion=function(){return J()},e.prototype.GetSessionId=function(){return this.ys},e.prototype.RegisterEventHandler=function(e,t){switch(e){case Vt.Unloaded:case Vt.Disposed:case Vt.DocumentReboot:case Vt.WopiInfoFromUrl:case Vt.DavUrlFromIds:case Vt.GetAuthToken:case Vt.GetCustomAuthConfig:case Vt.MoveToFolder:case Vt.SharedFilePicker:case Vt.SetOverlayContent:case Vt.FileShare:if(this.Xr[e])throw new Error("Duplicate registration");this.Xr[e]=t;break;default:this.Qo.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case Vt.Unloaded:case Vt.Disposed:case Vt.DocumentReboot:case Vt.FileShare:case Vt.WopiInfoFromUrl:case Vt.DavUrlFromIds:case Vt.GetAuthToken:case Vt.GetCustomAuthConfig:case Vt.MoveToFolder:case Vt.SharedFilePicker:case Vt.SetOverlayContent:if(this.Xr[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Xr[e];break;default:this.Qo.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Qo.postMessageForCommand(this.$o,e,t)},e.prototype.Dispose=function(e,t){var n=this;Ft(e||!1,this.ot,this.Qo,this.$o,(function(){delete n.$o,n.Ts(),n.Qo.dispose(),n.bs(Vt.Unloaded,{})}),(function(){try{n.bs(Vt.Disposed,{}),n.Xr={}}catch(e){n.ot.ULS.he(589108815,i.H,o.Error,"onFrameRemoved error: "+te(e))}}),t)},e}();function Zt(e,t,n,r,s){var a={};if(s)a=s;else try{a=JSON.parse( "{\"ewa.js\": {\"UrlHash\": \"h45D37BC017E7286E\", \"SriHash\": \"RdN7wBfnKG7rtHn1kBscMoC3x7vSTTjgUCFqRi25rzo=\"}, \"aacorlib.min.js\": {\"UrlHash\": \"h3F0015967CFDC00B\", \"SriHash\": \"PwAVlnz9wAsQ7VSVgLz81uGrWq8FffVYVeiR6iN/0lU=\"}, \"ewa.strings.wac.js\": {\"UrlHash\": \"h6D013C40ED31A619\", \"SriHash\": \"bQE8QO0xphnYjwkWRdxRaUJuQ21PL79u1XbeDn8EHDY=\"}, \"ewrdefault.css\": {\"UrlHash\": \"h0BDEE54D00BA4BA0\", \"SriHash\": \"C97lTQC6S6D3qjqjO5K+ePJhrhbTn9xQj/5A5OuPTFw=\"}, \"excelframe.css\": {\"UrlHash\": \"hDD5B8BC9A9DBDA1C\", \"SriHash\": \"3VuLyanb2hzxKVWqqBQ4LgnWW1+oDPiubHIUNPsjBbs=\"}, \"gridrenderer.min.js\": {\"UrlHash\": \"h93DFD33E2FCC854E\", \"SriHash\": \"k9/TPi/MhU4ux+woHHQjca7yzpdz1yTjsrBNd705hg4=\"}}")}catch(e){r&&r.ULS.he(589178847,i.H,o.Info,"GetExcelResources failed to parse hash dictionary")}for(var c=P(b(e)+"/x/s/"),u=function(e){var t=e?e.toLowerCase().split("-")[0]:"en";return H[t]}(null!=t?t:"en-US"),f=[],l=0,d=function(e){var t=[["App_Scripts/Ewa.js",!1],["App_Scripts/Aacorlib.min.js",!1],["App_Scripts/gridRenderer.min.js",!1]];e&&(t=t.concat([["App_Scripts/"+e+"/Ewa.Strings.Wac.js",!0],["Resources/"+e+"/EwrDefault.css",!0],["Resources/"+e+"/excelframe.css",!0]]));return t}(u);l<d.length;l++){var h=d[l],p=h[0],v=h[1],m=p.substring(p.lastIndexOf("/")+1);if(Dt.push(m),!v||"1033"===u){var w=m.toLowerCase();if(console.log("lowerCaseFile"),a&&a[w]){var g=a[w].UrlHash,S=a[w].SriHash;if(g&&S){var I=c+g+"__layouts/"+p;f.push([I,"sha256-"+S]),r&&r.ULS.he(589178849,i.H,o.Info,"GetExcelResources adding hashed url for "+m)}}}}return f}var $t=function(e,t,n,r,s){return e!==se.Yt?Promise.reject("Wrong flow"):new Promise((function(e){n.pendingReboot=!0;var r=void 0;if(t.queryOverrides)try{r=JSON.parse(t.queryOverrides)}catch(e){n.logger.ULS.he(592217694,i.H,o.Error,"Failed to parse queryOverrides: "+r)}n.raiseEvent(ce.Reboot,me(me({},t),{previousSessionId:n.sessionId,queryOverrides:r})),e({completion:"success"})}))};function Qt(e){return function(e,t){var n={};t&&Object.keys(t).forEach((function(e){n[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");n[t[0].toLowerCase()]=t[1]}})),n}(window.location.search.substring(1),e)}function Yt(e,t,n){var i=me(me(me({},C(e.appUrl)),function(e){var t={};_(t,"jsapi","1"),_(t,"jsapiver","v2"),_(t,"corrid",e.sessionId),_(t,"usid",e.sessionId),_(t,"newsession","1"),_(t,"sftc","1"),e.hostSessionId&&_(t,"hid",encodeURIComponent(e.hostSessionId));var n=e.host;n.uiHostName&&_(t,"uih",n.uiHostName),n.uiHostIntegrationType&&_(t,"uihit",encodeURIComponent(n.uiHostIntegrationType)),n.metaUiHostVersion&&_(t,"muv",encodeURIComponent(n.metaUiHostVersion));var i=n.capabilities;i&&(i.accessibilityLoop&&_(t,"accloop","1"),i.rebootDoc&&_(t,"sdr",i.rebootDoc.toString()),i.createNewDoc&&_(t,"scnd","1"),i.authToken&&_(t,"sat","1"),i.customAuthConfig&&_(t,"cac","1"),i.refreshAccessToken&&_(t,"rat","1"),i.atMentions&&_(t,"sams","1"),i.moveToFolder&&_(t,"mtf","1"),i.noBrowserModalDialogs&&_(t,"nbmd","1"),i.commonFilePicker&&_(t,"sfp","1"));var o=e.ui;o.language&&_(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&_(t,"uiembed","1"),o.hideHeader&&_(t,"hhdr","1"),o.highContrast&&_(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&_(t,"hodflp","1"),o.hideAppLauncherInHeader&&_(t,"halh","1"),o.hideChatInHeader&&_(t,"hch","1"),o.hideMeInHeader&&_(t,"hmh","1"),o.hideSearchInHeader&&_(t,"hsh","1"),o.hideWorkflowInHeader&&_(t,"hwfh","1"),o.hideSettingsInHeader&&_(t,"hsth","1"),o.showAppIconInHeader&&_(t,"sih","1"),o.useNeutralColorInHeader&&_(t,"unh","1"),o.openLinksInNewWindow&&_(t,"onw","1"),o.useDarkTheme&&_(t,"udt","1");var r=e.wopi;r&&r.source&&_(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&_(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&_(t,"readonly","1"),s.disableChat&&_(t,"dchat","1"),s.cookieCompliant&&_(t,"mscc","1"),s.isNewFile&&(_(t,"new","1"),s.isFromHostTemplate&&_(t,"wdtpl","fromhost"))),e.user.isLicensed&&_(t,"islicenseduser","1"),e.actNavId&&_(t,"actnavid",e.actNavId),e.sessionContext&&_(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)_(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&_(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&_(t,"preseededwacsessionid",encodeURIComponent(u.id)));var f=e.throttling;f&&(f.protection&&_(t,"ctp",f.protection),f.request&&_(t,"rct",f.request));var l=e.hostInitDiagnostics;l&&(l.entryPoint&&_(t,"wdorigin",encodeURI(l.entryPoint)),l.userClickTime&&_(t,"wdhostclicktime",l.userClickTime.toString()));var d=e.rebootOverride;return d&&d.previousSessionId&&_(t,"wdprevioussession",d.previousSessionId),T(t,"region"),t}(e)),n),o=e.rebootOverride;return o&&o.queryOverrides&&(i=me(me({},i),o.queryOverrides)),function(e,t,n){var i=[];for(var o in n)n[o]&&i.push(o+"="+n[o]);return e+t+(i.length>0?"?"+i.join("&"):"")}(e.appBasePath,t,i)}function en(e,t){var n=function(e){var t={};_(t,"highdpi",String(window.devicePixelRatio>1.24)),_(t,"softblockedbrowser",String(d())),_(t,"hostname",e.hostName),_(t,"feature_status",ie(e.featureManager,e.wdParams));var n=e.wopi;n&&(_(t,"access_token",n.accessToken),_(t,"access_token_ttl",n.expiry.toString()));var r=e.customFontCatalogUrl;r&&_(t,"customfontcatalogurl",r);var s=e.contentBundle;if(s&&s.url){_(t,"bundlesrc",s.url);var a=s.staleness,c=null!=a;c&&_(t,Ae.Zi,a.toString()),e.logger.ULS.he(577783775,i.H,o.Info,"Content bundle staleness: "+(c?a:"N/A"))}var u=e.file,f=u.name;if(f){_(t,"filename",f);var l=ee(f);l&&_(t,"fileextension",l)}u.getUrl&&_(t,"filegeturl",u.getUrl),u.size&&_(t,"filesize",u.size.toString()),u.eTag&&_(t,"etag",u.eTag),u.cTag&&_(t,"revid",u.cTag),u.uniqueId&&_(t,"docid",u.uniqueId);var h=e.newFileTemplate;h&&(h.getUrl&&_(t,"templateurl",h.getUrl),h.size&&_(t,"filesize",h.size.toString()),h.eTag&&_(t,"etag",h.eTag),h.uniqueId&&_(t,"docid",h.uniqueId)),e.user.id&&_(t,"user_id",e.user.id),e.ownerId&&_(t,"owner_id",e.ownerId),e.sessionContext&&_(t,"sc",e.sessionContext);var p=e.ui;return p.controls&&_(t,"huictrls",JSON.stringify(p.controls)),p.contentAssembly&&_(t,"caae","1"),t}(e);return Object.keys(t).forEach((function(e){t[e]?n[e]=t[e]:delete n[e]})),n}var tn=function(e,t,n,r,s){return e!==re.boot?Promise.reject("Wrong flow"):new Promise((function(e){var a,c=G();if(n.state=N.Booting,n.pendingReboot=!1,function(e,t){if(!e)throw new TypeError("SessionBootParams");var n=e.appUrl,i=e.appBaseUrl;if(!n&&!i)throw new TypeError("Either appUrl or appBaseUrl should exist");if(n&&"string"!=typeof n)throw new TypeError("AppUrl");if(i&&"string"!=typeof i)throw new TypeError("AppBaseUrl");var o=e.file;if(!o||!o.name)throw new TypeError("FileInfo");var r,s=e.container;if(!s||!(s instanceof Ne)&&!s.appendChild)throw new TypeError("Container");if(!t&&(!((r=e.wopi)&&r.source&&r.accessToken)||!r.expiry&&0!==r.expiry))throw new TypeError("WopiInfo")}(t,n.skipWopiValidation),n.intent=t.intent,n.file=t.file,n.customFontCatalogUrl=t.customFontCatalogUrl,n.wopi=t.wopi,n.contentBundle=t.contentBundle,n.newFileTemplate=t.newFileTemplate,n.ownerId=t.ownerId,n.sessionContext=t.sessionContext,n.actNavId=t.actNavId,n.preseededSession=t.preseededSession,n.throttling=t.throttling,n.hostInitDiagnostics=me(me({},t.diagnostics),{hostInitializeCallTime:c}),n.wdParams=Qt(t.wdParams),n.rebootOverride=t.rebootOverride,n.bootParams=t.bootParams||{},t.appUrl){var u=t.appUrl;n.appUrl=u;var f=n.bootParams;if(A(u,"new")&&(f.isNewFile=!0),!f.dataLanguage)(l=x(u,"rs"))&&(f.dataLanguage=l);var l,d=n.ui;if(A(u,"uiembed")&&(d.uiEmbed=!0),!d.language)(l=x(u,"ui"))&&(d.language=l);if(!n.hostInitDiagnostics.entryPoint){var h=x(u,"wdorigin");h&&(n.hostInitDiagnostics.entryPoint=h)}if(!n.host.uiHostName){var p=x(u,"uih");p&&(n.host.uiHostName=p)}}else n.appUrl="";n.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():b(t.appUrl).toLowerCase(),n.appBaseUrl=I(n.appBaseUrl,O(n.appUrl,"region")),r.initializeAppContext(n,e),n.appBasePath=r.buildAppBasePath(n),n.remoteTelemetryUrl=r.buildRemoteTelemetryUrl(n),L(n.remoteTelemetryUrl,n.appInfo.name,"init");var v=!1,m=n.preseededSession;n.appInfo.usePreseededSessionId&&m&&m.id&&(n.sessionId=m.id,v=!0);var g,S,y=!1,_=t.hostGeneratedSessionId;if(!v&&_&&(n.sessionId=_,y=!0),t.rebootOverride&&(v||y||(a=ve(),n.sessionId=a[0],g=a[1]),n.He.addSettingsChangeListener(n.logger.settingsChangeHandler),n.pageStateObserver=new Te(n.logger,!0),n.authTokenTrustValidator=new Ce(n.logger)),n.logger.ULS.he(38580693,i.H,o.Info,"User session id: "+n.sessionId+", is preseeded: "+v+", is host generated: "+y),n.logger.configure({remoteUlsEndpoint:(S=n.appBasePath,S+"RemoteUls.ashx"),sessionId:n.sessionId}),n.He.initializePeriodicFetch(n.appBasePath,n.sessionId),g&&n.logger.ULS.he(590966790,i.H,o.Info,JSON.stringify(g)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.he(558155803,i.H,o.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.he(596444237,i.H,o.Info,JSON.stringify({session:Ie(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.he(558155804,i.H,o.Error,"Failed to log init info: "+te(t))}}(n),n.appInitDiagnostics={officeSessionId:n.sessionId,officeBootstrapperVersion:J(),hostName:n.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){n.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!n.container){var T=t.container;n.container=T instanceof Ne?T:n.application.createContainer(T)}n.container.setMessageHandler(n.onMessage);var E=!!r.ignoreCompletionMessage&&r.ignoreCompletionMessage(n),C=function(e,t){var s,a;n.successTime=G(),E||(n.container.postMessage(ae.Mn,void 0),s=n.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach((function(e){s[e]=a[e]}))),r.onSuccess&&r.onSuccess(n),n.logger.ULS.he(596448985,i.H,o.Info,JSON.stringify(n.diagnostics)),L(n.remoteTelemetryUrl,n.application.name,"bootSuccess"),n.logger.ULS.flush(),n.container.postMessage(ae.Ln,{HostInitializeDiagnostics:n.hostInitDiagnostics,ClientDiagnostics:n.clientDiagnostics}),n.state=N.Booted,F({completion:"success"}),Se(n.appInfo.name,n.logger)},R=function(e,t){n.failureTime=G(),r.onFailure&&r.onFailure(n,t.Error),n.logger.ULS.he(596448986,i.H,o.Error,JSON.stringify({error:t.Error,diagnostics:n.diagnostics})),L(n.remoteTelemetryUrl,n.application.name,"bootFailure"),n.logger.ULS.flush(),n.state=N.Failed,F({completion:"failure"}),Se(n.appInfo.name,n.logger)},F=function(t){E||(n.bootHeartBeat&&n.bootHeartBeat.stop(),n.removeActionHandler(se.bt,C),n.removeActionHandler(se.St,R)),e(t)};s&&s.subscribe((function(){F({completion:"cancelled"})})),E||(n.addActionHandler(se.bt,C),n.addActionHandler(se.St,R));var U=r.buildBootRequestParams(n),W=Yt(n,U.appPageName,U.queryParamsOverrides),M=en(n,U.postDataOverrides);if(n.bootstrapperUrl&&n.preloader&&n.preloader.shouldPreload(W))try{r.beforePreload&&r.beforePreload(n);var H=n.bootstrapperUrl;n.featureManager.isFeatureEnabled(Q.Le)&&(n.logger.ULS.he(590966791,i.H,o.Info,"HTTP2 preload enabled"),H=P(H)),n.preloader.preload(H,n.ui.language,n.logger,n.featureManager)}catch(e){n.logger.ULS.he(590966792,i.H,o.Error,te(e))}r.beforeContainerBoot&&r.beforeContainerBoot(n,W);var k=r.buildPermissionsPolicy?r.buildPermissionsPolicy(n):"microphone "+n.appBaseUrl+"; camera "+n.appBaseUrl+"; clipboard-read "+n.appBaseUrl+"; clipboard-write "+n.appBaseUrl+"; keyboard-map "+n.appBaseUrl;n.appInitDiagnostics.officeFrameCreateTime=G(),n.container.boot(W,M,n.logger,k,{useAdditionalDiv:n.useAdditionalDiv,minHeight:n.minHeight,minWidth:n.minWidth}),E?C(se.bt,{Diagnostics:{}}):n.bootHeartBeat=new ze(w(n.appBaseUrl),n.He,n.logger,(function(){n.timeoutTime=G(),r.onTimeout&&r.onTimeout(n),L(n.remoteTelemetryUrl,n.application.name,"bootTimeout"),s?s.cancel():F({completion:"cancelled"})}),s?s.Ii:r.overrideBootTimeout?r.overrideBootTimeout(n):void 0)})).catch((function(e){throw n.failureTime=G(),r.onException&&r.onException(n,e),n.remoteTelemetryUrl&&L(n.remoteTelemetryUrl,n.application.name,"bootException"),e}))},nn=function(e,t,n,r,s){return e!==se.Tt?Promise.reject("Wrong flow"):new Promise((function(e){try{window.close()}catch(e){n.logger.ULS.he(579213189,i.H,o.Warning,"Failed to close the browser tab")}e({completion:"success"})}))},on=function(e,t,n){return new Promise((function(t){n.logger.ULS.he(590111070,i.H,o.Error,"Unsupported flow: "+e),t({completion:"failure"})}))},rn=function(e,t,n,r,s){return e!==re.dispose?Promise.reject("Wrong flow"):new Promise((function(e){var t=n.host.requireExplicitUnload,r={disposeStartTime:G(),forceAppUnload:t};n.state=N.Disposing;var a=function(){n.state=N.Disposed,e({completion:"success"})},c=function(e){n.dispose(),r.disposeEndTime=G(),function(e,t,n){if(n){var r=Number(n.hostMessageReceived);t.appUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-t.appUnloadStartTime);var s=Number(n.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);var a=Number(n.appUnloadStart),c=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),n.serverTimings){var u=n.serverTimings;for(var f in u)t["st-"+f.toString()]=u[f]}}e.logger.ULS.he(592524822,i.H,o.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(n,r,e),n.container?n.container.dispose(n.pendingReboot,t).then(a):a()};if(t){r.appUnloadStartTime=G();n.addActionHandler(se.hn,(function(e,t){r.appUnloadEndTime=G(),c(t)})),(s||new he(5e3)).subscribe((function(){n.state===N.Disposing&&(r.appUnloadTimedOut=!0,c())})),n.container&&n.container.postMessage(ae.ai,void 0)}else c()}))};var sn=function(e,t,n,r,s){return e!==se.kt?Promise.reject("Wrong flow"):new Promise((function(e){var t=!!n.container&&n.container.isTopFrameTrusted;n.logger.ULS.he(592445957,i.H,o.Info,"Top frame is trusted: "+t),n.container&&n.container.postMessage(ae.kt,{isTopFrameTrusted:t}),e({completion:"success"})}))},an=function(e,t,n,i,o){return e!==se.Jt?Promise.reject("Wrong flow"):new Promise((function(e){n.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(i){i?cn(n,t,e):(n.container.postMessage(ae.Gn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(i){n.container.postMessage(ae.Gn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:i})}))}))},cn=function(e,t,n){var i=function(t,n){e.container.postMessage(ae.Gn,n);var i={completion:!n.AuthToken||n.Error?"failure":"success"};n.Error&&(i.error=n.Error),o(i)},o=function(t){e.removeActionHandler(re.sendAuthToken,i),n(t)};e.addActionHandler(re.sendAuthToken,i),e.raiseEvent(ce.GetAuthToken,t)},un=function(e,t,n,r,s){return e!==se.It?Promise.reject("Wrong flow"):new Promise((function(e){var s=t&&t.state?t.state:"Unknown";n.logger.ULS.he(592839750,i.H,o.Info,"Boot state: ["+s+"]"),r&&r.beforeComplete&&r.beforeComplete(s),e({completion:"success"})}))},fn=function(e,t,n,i,o){return e!==re.rename?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,n){var i={completion:n.NewName===t.NewName?"success":"failure"};s(i)},r=function(e,t){s({completion:"failure"})},s=function(t){n.removeActionHandler(se.Wt,i),n.removeActionHandler(se.Mt,r),e(t)};n.addActionHandler(se.Wt,i),n.addActionHandler(se.Mt,r),(o||new he(5e3)).subscribe((function(){s({completion:"cancelled"})})),n.container&&n.container.postMessage(ae.qn,t)}))},ln=function(e,t,n,i,o){return e!==re.switchMode?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,t){r({completion:"success"})},r=function(t){n.removeActionHandler(se.zt,i),e(t)};n.addActionHandler(se.zt,i),(o||new he(5e3)).subscribe((function(){r({completion:"cancelled"})})),n.container&&n.container.postMessage(ae.si,t)}))};function dn(e){}function hn(e){Jt(e.logger)}function pn(e){return e.appBaseUrl+"/x/"}function vn(e){return e.appBasePath+"_layouts/"+"RemoteTelemetry.ashx"}function mn(e){var t=e.appUrl,n=nt(t),r=it(t),s=ot(t);return n||r||s||e.logger.ULS.he(553673218,i.H,o.Warning,"Unknown endpoint: "+R(t)),!(n||r)}function wn(e){var t=e.appUrl,n=nt(t),i=it(t),o=ot(t),r=n?"_layouts/xlviewerinternal.aspx":i?"_layouts/xlembed.aspx":o?"_layouts/xlpreview.aspx":function(e){var t=e.toLowerCase().indexOf("/x/");if(t<0)return"";var n=e.indexOf("?");return n<0?e.substring(t+"/x/".length):n<t?"":e.substring(t+"/x/".length,n)}(t),s={},a={};_(s,"wdredirectionreason","Force_SingleStepBoot");var c=e.host.capabilities;c&&c.excelExternalLinks&&_(s,"xlel","1");var u=e.viewMode;u&&(u.hideToolbar&&_(s,"hvt","1"),u.hideEditUpsellDialog&&_(s,"hdeditdlg","1"));var f=e.bootParams;f&&f.isNewFile?(T(s,"unified"),_(s,"edit","1"),_(s,"new","1")):_(s,"instantedit","1"),_(a,Ae.ho,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics,ClientDiagnostics:e.clientDiagnostics})),_(a,Ae.Oo,(new Intl.DateTimeFormat).resolvedOptions().timeZone);var l=e.rebootOverride;if(l){var d=l.mode;d&&("view"===(d=d.toLowerCase())?_(s,"wdforcedmode","View"):"edit"===d&&_(s,"wdforcedmode","Edit"))}var h=e.file.size;return h&&h>=52428800&&h<=104857600&&_(s,"ilf","1"),{appPageName:r,queryParamsOverrides:s,postDataOverrides:a}}function gn(e,t){gt(t)&&vt(e.logger,e.container.formId,e.featureManager,e.sessionId)}var Sn,In=function(){var e,t;return[(e={},e[oe.appReboot]=$t,e[oe.boot]=tn,e[oe.closeTab]=nn,e[oe.createNew]=on,e[oe.dispose]=rn,e[oe.frameTrust]=sn,e[oe.getAuthToken]=an,e[oe.getHostKeyValue]=Ye,e[oe.handleBootState]=un,e[oe.rename]=fn,e[oe.setOverlayContent]=Ze,e[oe.storeHostKeyValue]=tt,e[oe.switchMode]=ln,e[oe.updateBootComplete]=on,e),(t={},t[oe.boot]={initializeAppContext:dn,beforePreload:hn,buildAppBasePath:pn,buildRemoteTelemetryUrl:vn,ignoreCompletionMessage:mn,buildBootRequestParams:wn,beforeContainerBoot:gn,onSuccess:wt},t[oe.handleBootState]={beforeComplete:mt},t)]};!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Sn||(Sn={})),n.d(t,"Application",(function(){return bn})),n.d(t,"createApplication",(function(){return yn})),n.d(t,"DocRebootSupportMode",(function(){return Sn})),n.d(t,"CommandIds",(function(){return re})),n.d(t,"EventIds",(function(){return ce})),n.d(t,"createCancellationToken",(function(){return pe}));var bn=new zt((function(e,t,n,i,o){return new Xt(e,t,n,i,o)}),{forceSingleStepBoot:!1,preloader:U(nt,Zt)}),yn=function(e){var t={name:"Excel",preloader:U(nt,Zt)};return new He(e,t,In)}}});

